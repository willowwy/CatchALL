1 @@ testCode/CVE-2016-6305_CWE-020_63658103d4441924f8dbfc517b99bb54758a98b9_rec_layer_s3.c_1.1_OLD.c @@ ssl3_read_bytes @@ 1136 @@ ['peek'] @@ {s, recvd_type, rr, rbuf}
int ssl3_read_bytes(SSL *s, int type, int *recvd_type, unsigned char *buf,
int len, int peek) location: 964 cross_layer: 1 file: rec_layer_s3.c
int al , i , j , ret ; location: 966 cross_layer: 1 file: rec_layer_s3.c
unsigned int n , curr_rec , num_recs , read_bytes ; location: 967 cross_layer: 1 file: rec_layer_s3.c
SSL3_RECORD * rr ; location: 968 cross_layer: 1 file: rec_layer_s3.c
SSL3_BUFFER * rbuf ; location: 969 cross_layer: 1 file: rec_layer_s3.c
rbuf = & s -> rlayer . rbuf; location: 972 cross_layer: 1 file: rec_layer_s3.c
if ( ! SSL3_BUFFER_is_initialised ( rbuf ) )  location: 974 cross_layer: 1 file: rec_layer_s3.c
if ( ! ssl3_setup_read_buffer ( s ) )  location: 976 cross_layer: 1 file: rec_layer_s3.c
if ( ( type && ( type != SSL3_RT_APPLICATION_DATA ) && ( type != SSL3_RT_HANDSHAKE ) ) || ( peek && ( type != SSL3_RT_APPLICATION_DATA ) ) )  location: 980 cross_layer: 1 file: rec_layer_s3.c
if ( ( type == SSL3_RT_HANDSHAKE ) && ( s -> rlayer . handshake_fragment_len > 0 ) )  location: 988 cross_layer: 1 file: rec_layer_s3.c
if ( ! ossl_statem_get_in_handshake ( s ) && SSL_in_init ( s ) )  location: 1017 cross_layer: 1 file: rec_layer_s3.c
i = s -> handshake_func ( s ); location: 1019 cross_layer: 1 file: rec_layer_s3.c
if ( i < 0 )  location: 1020 cross_layer: 1 file: rec_layer_s3.c
if ( i == 0 )  location: 1022 cross_layer: 1 file: rec_layer_s3.c
s -> rwstate = SSL_NOTHING; location: 1028 cross_layer: 1 file: rec_layer_s3.c
rr = s -> rlayer . rrec; location: 1037 cross_layer: 1 file: rec_layer_s3.c
num_recs = RECORD_LAYER_get_numrpipes ( & s -> rlayer ); location: 1038 cross_layer: 1 file: rec_layer_s3.c
if ( num_recs == 0 )  location: 1042 cross_layer: 1 file: rec_layer_s3.c
ret = ssl3_get_record ( s ); location: 1043 cross_layer: 1 file: rec_layer_s3.c
if ( ret <= 0 )  location: 1044 cross_layer: 1 file: rec_layer_s3.c
num_recs = RECORD_LAYER_get_numrpipes ( & s -> rlayer ); location: 1046 cross_layer: 1 file: rec_layer_s3.c
if ( num_recs == 0 )  location: 1047 cross_layer: 1 file: rec_layer_s3.c
for (curr_rec = 0;
curr_rec < num_recs && SSL3_RECORD_is_read(&rr[curr_rec]);
curr_rec++) ;
if (curr_rec == num_recs) location: 1058 cross_layer: 1 file: rec_layer_s3.c
num_recs = 0; location: 1060 cross_layer: 1 file: rec_layer_s3.c
curr_rec = 0; location: 1061 cross_layer: 1 file: rec_layer_s3.c
while ( num_recs == 0 )  location: 1063 cross_layer: 1 file: rec_layer_s3.c
rr = & rr [ curr_rec ]; location: 1064 cross_layer: 1 file: rec_layer_s3.c
if ( SSL3_RECORD_get_type ( rr ) != SSL3_RT_ALERT && SSL3_RECORD_get_length ( rr ) != 0 )  location: 1070 cross_layer: 1 file: rec_layer_s3.c
s -> rlayer . alert_count = 0; location: 1072 cross_layer: 1 file: rec_layer_s3.c
if ( s -> s3 -> change_cipher_spec && ( SSL3_RECORD_get_type ( rr ) != SSL3_RT_HANDSHAKE ) )  location: 1076 cross_layer: 1 file: rec_layer_s3.c
if ( s -> shutdown & SSL_RECEIVED_SHUTDOWN )  location: 1088 cross_layer: 1 file: rec_layer_s3.c
s -> rwstate = SSL_NOTHING; location: 1090 cross_layer: 1 file: rec_layer_s3.c
if ( type == SSL3_RECORD_get_type ( rr ) || ( SSL3_RECORD_get_type ( rr ) == SSL3_RT_CHANGE_CIPHER_SPEC && type == SSL3_RT_HANDSHAKE && recvd_type != NULL ) )  location: 1094 cross_layer: 1 file: rec_layer_s3.c
if ( SSL_in_init ( s ) && ( type == SSL3_RT_APPLICATION_DATA ) && ( s -> enc_read_ctx == NULL ) )  location: 1106 cross_layer: 1 file: rec_layer_s3.c
if ( type == SSL3_RT_HANDSHAKE && SSL3_RECORD_get_type ( rr ) == SSL3_RT_CHANGE_CIPHER_SPEC && s -> rlayer . handshake_fragment_len > 0 )  location: 1113 cross_layer: 1 file: rec_layer_s3.c
if ( len <= 0 )  location: 1124 cross_layer: 1 file: rec_layer_s3.c
if ( ! peek )  location: 1136 cross_layer: 1 file: rec_layer_s3.c
if ( SSL3_RECORD_get_length ( rr ) == 0 || ( peek && n == SSL3_RECORD_get_length ( rr ) ) )  location: 1145 cross_layer: 1 file: rec_layer_s3.c
if ( ! peek && curr_rec == num_recs && ( s -> mode & SSL_MODE_RELEASE_BUFFERS ) && SSL3_BUFFER_get_left ( rbuf ) == 0 )  location: 1157 cross_layer: 1 file: rec_layer_s3.c
------------------------------
