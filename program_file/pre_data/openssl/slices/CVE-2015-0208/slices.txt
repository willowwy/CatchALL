1 @@ testCode/CVE-2015-0208_NVD-CWE-Other_4b22cce3812052fe64fc3f6d58d8cc884e3cb834_rsa_ameth.c_1.1_OLD.c @@ rsa_item_verify @@ 701 @@ ['sigalg', 'pkey', 'ctx'] @@ {ctx, sigalg, pkey}
static int rsa_item_verify(EVP_MD_CTX *ctx, const ASN1_ITEM *it, void *asn,
X509_ALGOR *sigalg, ASN1_BIT_STRING *sig,
EVP_PKEY *pkey) location: 694 cross_layer: 1 file: rsa_ameth.c
if ( OBJ_obj2nid ( sigalg -> algorithm ) != NID_rsassaPss )  location: 697 cross_layer: 1 file: rsa_ameth.c
if ( rsa_pss_to_ctx ( ctx , NULL , sigalg , pkey ) )  location: 701 cross_layer: 1 file: rsa_ameth.c
static int rsa_pss_to_ctx(EVP_MD_CTX *ctx, EVP_PKEY_CTX *pkctx,
X509_ALGOR *sigalg, EVP_PKEY *pkey) location: 586 cross_layer: 2 file: rsa_ameth.c
if ( OBJ_obj2nid ( sigalg -> algorithm ) != NID_rsassaPss )  location: 594 cross_layer: 2 file: rsa_ameth.c
pss = rsa_pss_decode ( sigalg , & maskHash ); location: 599 cross_layer: 2 file: rsa_ameth.c
static RSA_PSS_PARAMS *rsa_pss_decode(const X509_ALGOR *alg,
X509_ALGOR **pmaskHash) location: 284 cross_layer: 3 file: rsa_ameth.c
* pmaskHash = NULL; location: 290 cross_layer: 3 file: rsa_ameth.c
if ( ! alg -> parameter || alg -> parameter -> type != V_ASN1_SEQUENCE )  location: 292 cross_layer: 3 file: rsa_ameth.c
p = alg -> parameter -> value . sequence -> data; location: 294 cross_layer: 3 file: rsa_ameth.c
plen = alg -> parameter -> value . sequence -> length; location: 295 cross_layer: 3 file: rsa_ameth.c
pss = d2i_RSA_PSS_PARAMS ( NULL , & p , plen ); location: 296 cross_layer: 3 file: rsa_ameth.c
if ( ! pss )  location: 298 cross_layer: 3 file: rsa_ameth.c
* pmaskHash = rsa_mgf1_decode ( pss -> maskGenAlgorithm ); location: 301 cross_layer: 3 file: rsa_ameth.c
static X509_ALGOR *rsa_mgf1_decode(X509_ALGOR *alg) location: 267 cross_layer: 4 file: rsa_ameth.c
if ( alg == NULL )  location: 271 cross_layer: 4 file: rsa_ameth.c
if ( OBJ_obj2nid ( alg -> algorithm ) != NID_mgf1 )  location: 273 cross_layer: 4 file: rsa_ameth.c
if ( alg -> parameter -> type != V_ASN1_SEQUENCE )  location: 275 cross_layer: 4 file: rsa_ameth.c
p = alg -> parameter -> value . sequence -> data; location: 278 cross_layer: 4 file: rsa_ameth.c
plen = alg -> parameter -> value . sequence -> length; location: 279 cross_layer: 4 file: rsa_ameth.c
return d2i_X509_ALGOR ( NULL , & p , plen ) ; location: 280 cross_layer: 4 file: rsa_ameth.c
return pss ; location: 303 cross_layer: 3 file: rsa_ameth.c
if ( pss == NULL )  location: 601 cross_layer: 2 file: rsa_ameth.c
mgf1md = rsa_mgf1_to_md ( pss -> maskGenAlgorithm , maskHash ); location: 605 cross_layer: 2 file: rsa_ameth.c
static const EVP_MD *rsa_mgf1_to_md(X509_ALGOR *alg, X509_ALGOR *maskHash) location: 504 cross_layer: 3 file: rsa_ameth.c
if ( ! alg )  location: 507 cross_layer: 3 file: rsa_ameth.c
if ( OBJ_obj2nid ( alg -> algorithm ) != NID_mgf1 )  location: 510 cross_layer: 3 file: rsa_ameth.c
if ( ! maskHash )  location: 514 cross_layer: 3 file: rsa_ameth.c
md = EVP_get_digestbyobj ( maskHash -> algorithm ); location: 518 cross_layer: 3 file: rsa_ameth.c
if ( md == NULL )  location: 519 cross_layer: 3 file: rsa_ameth.c
return md ; location: 523 cross_layer: 3 file: rsa_ameth.c
if ( ! mgf1md )  location: 606 cross_layer: 2 file: rsa_ameth.c
md = rsa_algor_to_md ( pss -> hashAlgorithm ); location: 608 cross_layer: 2 file: rsa_ameth.c
static const EVP_MD *rsa_algor_to_md(X509_ALGOR *alg) location: 492 cross_layer: 3 file: rsa_ameth.c
if ( ! alg )  location: 495 cross_layer: 3 file: rsa_ameth.c
md = EVP_get_digestbyobj ( alg -> algorithm ); location: 497 cross_layer: 3 file: rsa_ameth.c
if ( md == NULL )  location: 498 cross_layer: 3 file: rsa_ameth.c
return md ; location: 500 cross_layer: 3 file: rsa_ameth.c
if ( ! md )  location: 609 cross_layer: 2 file: rsa_ameth.c
if ( pss -> saltLength )  location: 612 cross_layer: 2 file: rsa_ameth.c
saltlen = ASN1_INTEGER_get ( pss -> saltLength ); location: 613 cross_layer: 2 file: rsa_ameth.c
if ( saltlen < 0 )  location: 619 cross_layer: 2 file: rsa_ameth.c
if ( pss -> trailerField && ASN1_INTEGER_get ( pss -> trailerField ) != 1 )  location: 630 cross_layer: 2 file: rsa_ameth.c
if ( pkey )  location: 637 cross_layer: 2 file: rsa_ameth.c
if ( ! EVP_DigestVerifyInit ( ctx , & pkctx , md , NULL , pkey ) )  location: 638 cross_layer: 2 file: rsa_ameth.c
if ( EVP_PKEY_CTX_get_signature_md ( pkctx , & checkmd ) <= 0 )  location: 642 cross_layer: 2 file: rsa_ameth.c
if ( EVP_MD_type ( md ) != EVP_MD_type ( checkmd ) )  location: 644 cross_layer: 2 file: rsa_ameth.c
if ( EVP_PKEY_CTX_set_rsa_padding ( pkctx , RSA_PKCS1_PSS_PADDING ) <= 0 )  location: 650 cross_layer: 2 file: rsa_ameth.c
if ( EVP_PKEY_CTX_set_rsa_pss_saltlen ( pkctx , saltlen ) <= 0 )  location: 653 cross_layer: 2 file: rsa_ameth.c
if ( EVP_PKEY_CTX_set_rsa_mgf1_md ( pkctx , mgf1md ) <= 0 )  location: 656 cross_layer: 2 file: rsa_ameth.c
RSA_PSS_PARAMS_free ( pss ); location: 662 cross_layer: 2 file: rsa_ameth.c
------------------------------
