1 @@ testCode/CVE-2016-6302_CWE-020_e97763c92c655dcf4af2860b3abd2bc4c8a267f9_t1_lib.c_1.1_OLD.c @@ tls_decrypt_ticket @@ 2973 @@ ['eticklen'] @@ {}
static int tls_decrypt_ticket(SSL *s, const unsigned char *etick,
int eticklen, const unsigned char *sess_id,
int sesslen, SSL_SESSION **psess) location: 2962 cross_layer: 1 file: t1_lib.c
if ( eticklen < 48 )  location: 2973 cross_layer: 1 file: t1_lib.c
eticklen -= mlen; location: 3021 cross_layer: 1 file: t1_lib.c
if ( HMAC_Update ( hctx , etick , eticklen ) <= 0 || HMAC_Final ( hctx , tick_hmac , NULL ) <= 0 )  location: 3023 cross_layer: 1 file: t1_lib.c
if ( CRYPTO_memcmp ( tick_hmac , etick + eticklen , mlen ) )  location: 3028 cross_layer: 1 file: t1_lib.c
eticklen -= 16 + EVP_CIPHER_CTX_iv_length ( ctx ); location: 3035 cross_layer: 1 file: t1_lib.c
sdec = OPENSSL_malloc ( eticklen ); location: 3036 cross_layer: 1 file: t1_lib.c
if ( sdec == NULL || EVP_DecryptUpdate ( ctx , sdec , & slen , p , eticklen ) <= 0 )  location: 3037 cross_layer: 1 file: t1_lib.c
OPENSSL_free ( sdec ); location: 3039 cross_layer: 1 file: t1_lib.c
if ( EVP_DecryptFinal ( ctx , sdec + slen , & mlen ) <= 0 )  location: 3042 cross_layer: 1 file: t1_lib.c
OPENSSL_free ( sdec ); location: 3044 cross_layer: 1 file: t1_lib.c
p = sdec; location: 3050 cross_layer: 1 file: t1_lib.c
sess = d2i_SSL_SESSION ( NULL , & p , slen ); location: 3052 cross_layer: 1 file: t1_lib.c
OPENSSL_free ( sdec ); location: 3053 cross_layer: 1 file: t1_lib.c
if ( sess )  location: 3054 cross_layer: 1 file: t1_lib.c
memcpy ( sess -> session_id , sess_id , sesslen ); location: 3062 cross_layer: 1 file: t1_lib.c
sess -> session_id_length = sesslen; location: 3063 cross_layer: 1 file: t1_lib.c
* psess = sess; location: 3064 cross_layer: 1 file: t1_lib.c
r = tls_decrypt_ticket ( s , etick , size , PACKET_data ( session_id ) , PACKET_remaining ( session_id ) , ret ); location: 2909 cross_layer: 2 file: t1_lib.c
switch ( r )  location: 2911 cross_layer: 2 file: t1_lib.c
retv = r; location: 2917 cross_layer: 2 file: t1_lib.c
return retv ; location: 2940 cross_layer: 2 file: t1_lib.c
------------------------------
