1 @@ testCode/CVE-2016-6303_CWE-787_55d83bf7c10c7b205fffa23fa7c3977491e56c07_mdc2dgst.c_1.1_OLD.c @@ MDC2_Update @@ 45 @@ ['i', 'len'] @@ {c}
int MDC2_Update(MDC2_CTX *c, const unsigned char *in, size_t len) location: 39 cross_layer: 1 file: mdc2dgst.c
size_t i , j ; location: 41 cross_layer: 1 file: mdc2dgst.c
i = c -> num; location: 43 cross_layer: 1 file: mdc2dgst.c
if ( i != 0 )  location: 44 cross_layer: 1 file: mdc2dgst.c
if ( i + len < MDC2_BLOCK )  location: 45 cross_layer: 1 file: mdc2dgst.c
memcpy ( & ( c -> data [ i ] ) , in , len ); location: 47 cross_layer: 1 file: mdc2dgst.c
c -> num += ( int ) len; location: 48 cross_layer: 1 file: mdc2dgst.c
j = MDC2_BLOCK - i; location: 52 cross_layer: 1 file: mdc2dgst.c
memcpy ( & ( c -> data [ i ] ) , in , j ); location: 53 cross_layer: 1 file: mdc2dgst.c
len -= j; location: 54 cross_layer: 1 file: mdc2dgst.c
in += j; location: 55 cross_layer: 1 file: mdc2dgst.c
c -> num = 0; location: 56 cross_layer: 1 file: mdc2dgst.c
mdc2_body ( c , & ( c -> data [ 0 ] ) , MDC2_BLOCK ); location: 57 cross_layer: 1 file: mdc2dgst.c
static void mdc2_body(MDC2_CTX *c, const unsigned char *in, size_t len) location: 71 cross_layer: 2 file: mdc2dgst.c
for (i = 0; i < len; i += 8) location: 80 cross_layer: 2 file: mdc2dgst.c
c2l ( in , tin0 ); location: 81 cross_layer: 2 file: mdc2dgst.c
c2l ( in , tin1 ); location: 83 cross_layer: 2 file: mdc2dgst.c
c -> h [ 0 ] = ( c -> h [ 0 ] & 0x9f ) | 0x40; location: 85 cross_layer: 2 file: mdc2dgst.c
c -> hh [ 0 ] = ( c -> hh [ 0 ] & 0x9f ) | 0x20; location: 86 cross_layer: 2 file: mdc2dgst.c
DES_set_odd_parity ( & c -> h ); location: 88 cross_layer: 2 file: mdc2dgst.c
DES_set_key_unchecked ( & c -> h , & k ); location: 89 cross_layer: 2 file: mdc2dgst.c
DES_set_odd_parity ( & c -> hh ); location: 92 cross_layer: 2 file: mdc2dgst.c
DES_set_key_unchecked ( & c -> hh , & k ); location: 93 cross_layer: 2 file: mdc2dgst.c
p = c -> h; location: 101 cross_layer: 2 file: mdc2dgst.c
l2c ( tin0 , p ); location: 102 cross_layer: 2 file: mdc2dgst.c
l2c ( ttin1 , p ); location: 103 cross_layer: 2 file: mdc2dgst.c
p = c -> hh; location: 104 cross_layer: 2 file: mdc2dgst.c
l2c ( ttin0 , p ); location: 105 cross_layer: 2 file: mdc2dgst.c
l2c ( tin1 , p ); location: 106 cross_layer: 2 file: mdc2dgst.c
i = len & ~ ( ( size_t ) MDC2_BLOCK - 1 ); location: 60 cross_layer: 1 file: mdc2dgst.c
if ( i > 0 )  location: 61 cross_layer: 1 file: mdc2dgst.c
mdc2_body ( c , in , i ); location: 62 cross_layer: 1 file: mdc2dgst.c
static void mdc2_body(MDC2_CTX *c, const unsigned char *in, size_t len) location: 71 cross_layer: 2 file: mdc2dgst.c
c2l ( in , tin0 ); location: 81 cross_layer: 2 file: mdc2dgst.c
c2l ( in , tin1 ); location: 83 cross_layer: 2 file: mdc2dgst.c
c -> h [ 0 ] = ( c -> h [ 0 ] & 0x9f ) | 0x40; location: 85 cross_layer: 2 file: mdc2dgst.c
c -> hh [ 0 ] = ( c -> hh [ 0 ] & 0x9f ) | 0x20; location: 86 cross_layer: 2 file: mdc2dgst.c
DES_set_odd_parity ( & c -> h ); location: 88 cross_layer: 2 file: mdc2dgst.c
DES_set_key_unchecked ( & c -> h , & k ); location: 89 cross_layer: 2 file: mdc2dgst.c
DES_set_odd_parity ( & c -> hh ); location: 92 cross_layer: 2 file: mdc2dgst.c
DES_set_key_unchecked ( & c -> hh , & k ); location: 93 cross_layer: 2 file: mdc2dgst.c
p = c -> h; location: 101 cross_layer: 2 file: mdc2dgst.c
l2c ( tin0 , p ); location: 102 cross_layer: 2 file: mdc2dgst.c
l2c ( ttin1 , p ); location: 103 cross_layer: 2 file: mdc2dgst.c
p = c -> hh; location: 104 cross_layer: 2 file: mdc2dgst.c
l2c ( ttin0 , p ); location: 105 cross_layer: 2 file: mdc2dgst.c
l2c ( tin1 , p ); location: 106 cross_layer: 2 file: mdc2dgst.c
j = len - i; location: 63 cross_layer: 1 file: mdc2dgst.c
if ( j > 0 )  location: 64 cross_layer: 1 file: mdc2dgst.c
memcpy ( & ( c -> data [ 0 ] ) , & ( in [ i ] ) , j ); location: 65 cross_layer: 1 file: mdc2dgst.c
c -> num = ( int ) j; location: 66 cross_layer: 1 file: mdc2dgst.c
MDC2_Update ( & c , text , strlen ( text ) ); location: 139 cross_layer: 2 file: mdc2dgst.c
MDC2_Final ( & ( md [ 0 ] ) , & c ); location: 140 cross_layer: 2 file: mdc2dgst.c
int MDC2_Final(unsigned char *md, MDC2_CTX *c) location: 110 cross_layer: 3 file: mdc2dgst.c
i = c -> num; location: 115 cross_layer: 3 file: mdc2dgst.c
j = c -> pad_type; location: 116 cross_layer: 3 file: mdc2dgst.c
if ( ( i > 0 ) || ( j == 2 ) )  location: 117 cross_layer: 3 file: mdc2dgst.c
if ( j == 2 )  location: 118 cross_layer: 3 file: mdc2dgst.c
c -> data [ i ++ ] = 0x80; location: 119 cross_layer: 3 file: mdc2dgst.c
memset ( & ( c -> data [ i ] ) , 0 , MDC2_BLOCK - i ); location: 120 cross_layer: 3 file: mdc2dgst.c
mdc2_body ( c , c -> data , MDC2_BLOCK ); location: 121 cross_layer: 3 file: mdc2dgst.c
memcpy ( md , ( char * ) c -> h , MDC2_BLOCK ); location: 123 cross_layer: 3 file: mdc2dgst.c
memcpy ( & ( md [ MDC2_BLOCK ] ) , ( char * ) c -> hh , MDC2_BLOCK ); location: 124 cross_layer: 3 file: mdc2dgst.c
------------------------------
