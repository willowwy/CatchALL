1 @@ testCode/CVE-2016-6304_CWE-401_2c0d295e26306e15a92eb23a84a1802005c1c137_t1_lib.c_OLD.c @@ ssl_parse_clienthello_tlsext @@ 1306 @@ ['s->tlsext_ocsp_ids'] @@ {s, p, limit, data, sdata, sdata, sdata, sdata, sdata, id}
# endif                         /* !OPENSSL_NO_EC */ location: 983 cross_layer: 1 file: t1_lib.c
unsigned short type ; location: 987 cross_layer: 1 file: t1_lib.c
unsigned short size ; location: 988 cross_layer: 1 file: t1_lib.c
unsigned short len ; location: 989 cross_layer: 1 file: t1_lib.c
unsigned char * data = * p ; location: 990 cross_layer: 1 file: t1_lib.c
int sigalg_seen = 0 ; location: 992 cross_layer: 1 file: t1_lib.c
s -> servername_done = 0; location: 994 cross_layer: 1 file: t1_lib.c
s -> tlsext_status_type = - 1; location: 995 cross_layer: 1 file: t1_lib.c
s -> s3 -> next_proto_neg_seen = 0; location: 997 cross_layer: 1 file: t1_lib.c
s -> tlsext_heartbeat &= ~ ( SSL_TLSEXT_HB_ENABLED | SSL_TLSEXT_HB_DONT_SEND_REQUESTS ); location: 1001 cross_layer: 1 file: t1_lib.c
if ( s -> srp_ctx . login != NULL )  location: 1011 cross_layer: 1 file: t1_lib.c
s -> srp_ctx . login = NULL; location: 1013 cross_layer: 1 file: t1_lib.c
s -> srtp_profile = NULL; location: 1017 cross_layer: 1 file: t1_lib.c
if ( data == limit )  location: 1019 cross_layer: 1 file: t1_lib.c
if ( limit - data < 2 )  location: 1022 cross_layer: 1 file: t1_lib.c
if ( limit - data != len )  location: 1027 cross_layer: 1 file: t1_lib.c
while ( limit - data >= 4 )  location: 1030 cross_layer: 1 file: t1_lib.c
if ( limit - data < size )  location: 1034 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_server_name )  location: 1066 cross_layer: 1 file: t1_lib.c
unsigned char * sdata ; location: 1067 cross_layer: 1 file: t1_lib.c
int servname_type ; location: 1068 cross_layer: 1 file: t1_lib.c
int dsize ; location: 1069 cross_layer: 1 file: t1_lib.c
if ( size < 2 )  location: 1071 cross_layer: 1 file: t1_lib.c
size -= 2; location: 1074 cross_layer: 1 file: t1_lib.c
if ( dsize > size )  location: 1075 cross_layer: 1 file: t1_lib.c
sdata = data; location: 1078 cross_layer: 1 file: t1_lib.c
while ( dsize > 3 )  location: 1079 cross_layer: 1 file: t1_lib.c
servname_type = * ( sdata ++ ); location: 1080 cross_layer: 1 file: t1_lib.c
dsize -= 3; location: 1082 cross_layer: 1 file: t1_lib.c
if ( len > dsize )  location: 1084 cross_layer: 1 file: t1_lib.c
if ( s -> servername_done == 0 )  location: 1087 cross_layer: 1 file: t1_lib.c
switch ( servname_type )  location: 1088 cross_layer: 1 file: t1_lib.c
if ( ! s -> hit )  location: 1090 cross_layer: 1 file: t1_lib.c
if ( s -> session -> tlsext_hostname )  location: 1091 cross_layer: 1 file: t1_lib.c
if ( len > TLSEXT_MAXLEN_host_name )  location: 1094 cross_layer: 1 file: t1_lib.c
if ( ( s -> session -> tlsext_hostname = OPENSSL_malloc ( len + 1 ) ) == NULL )  location: 1098 cross_layer: 1 file: t1_lib.c
memcpy ( s -> session -> tlsext_hostname , sdata , len ); location: 1103 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_hostname [ len ] = '\0'; location: 1104 cross_layer: 1 file: t1_lib.c
if ( strlen ( s -> session -> tlsext_hostname ) != len )  location: 1105 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_hostname = NULL; location: 1107 cross_layer: 1 file: t1_lib.c
s -> servername_done = 1; location: 1111 cross_layer: 1 file: t1_lib.c
s -> servername_done = s -> session -> tlsext_hostname && strlen ( s -> session -> tlsext_hostname ) == len && strncmp ( s -> session -> tlsext_hostname , ( char * ) sdata , len ) == 0; location: 1114 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_srp )  location: 1132 cross_layer: 1 file: t1_lib.c
if ( size == 0 || ( ( len = data [ 0 ] ) ) != ( size - 1 ) )  location: 1133 cross_layer: 1 file: t1_lib.c
if ( s -> srp_ctx . login != NULL )  location: 1135 cross_layer: 1 file: t1_lib.c
if ( ( s -> srp_ctx . login = OPENSSL_malloc ( len + 1 ) ) == NULL )  location: 1137 cross_layer: 1 file: t1_lib.c
memcpy ( s -> srp_ctx . login , & data [ 1 ] , len ); location: 1139 cross_layer: 1 file: t1_lib.c
s -> srp_ctx . login [ len ] = '\0'; location: 1140 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_ec_point_formats )  location: 1148 cross_layer: 1 file: t1_lib.c
unsigned char * sdata = data ; location: 1149 cross_layer: 1 file: t1_lib.c
int ecpointformatlist_length = * ( sdata ++ ) ; location: 1150 cross_layer: 1 file: t1_lib.c
if ( ecpointformatlist_length != size - 1 )  location: 1152 cross_layer: 1 file: t1_lib.c
if ( ! s -> hit )  location: 1154 cross_layer: 1 file: t1_lib.c
if ( s -> session -> tlsext_ecpointformatlist )  location: 1155 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ecpointformatlist = NULL; location: 1157 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ecpointformatlist_length = 0; location: 1159 cross_layer: 1 file: t1_lib.c
if ( ( s -> session -> tlsext_ecpointformatlist = OPENSSL_malloc ( ecpointformatlist_length ) ) == NULL )  location: 1160 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ecpointformatlist_length = ecpointformatlist_length; location: 1165 cross_layer: 1 file: t1_lib.c
memcpy ( s -> session -> tlsext_ecpointformatlist , sdata , ecpointformatlist_length ); location: 1167 cross_layer: 1 file: t1_lib.c
fprintf ( stderr , "ssl_parse_clienthello_tlsext s->session->tlsext_ecpointformatlist (length=%i) " , s -> session -> tlsext_ecpointformatlist_length ); location: 1171 cross_layer: 1 file: t1_lib.c
sdata = s -> session -> tlsext_ecpointformatlist; location: 1174 cross_layer: 1 file: t1_lib.c
for (i = 0; i < s->session->tlsext_ecpointformatlist_length; i++) location: 1175 cross_layer: 1 file: t1_lib.c
fprintf ( stderr , "%i " , * ( sdata ++ ) ); location: 1176 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_elliptic_curves )  location: 1179 cross_layer: 1 file: t1_lib.c
unsigned char * sdata = data ; location: 1180 cross_layer: 1 file: t1_lib.c
int ellipticcurvelist_length = ( * ( sdata ++ ) << 8 ) ; location: 1181 cross_layer: 1 file: t1_lib.c
ellipticcurvelist_length += ( * ( sdata ++ ) ); location: 1182 cross_layer: 1 file: t1_lib.c
if ( ellipticcurvelist_length != size - 2 || ellipticcurvelist_length < 1 || ellipticcurvelist_length & 1 )  location: 1184 cross_layer: 1 file: t1_lib.c
if ( ! s -> hit )  location: 1190 cross_layer: 1 file: t1_lib.c
if ( s -> session -> tlsext_ellipticcurvelist )  location: 1191 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ellipticcurvelist_length = 0; location: 1194 cross_layer: 1 file: t1_lib.c
if ( ( s -> session -> tlsext_ellipticcurvelist = OPENSSL_malloc ( ellipticcurvelist_length ) ) == NULL )  location: 1195 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ellipticcurvelist_length = ellipticcurvelist_length; location: 1200 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_opaque_prf_input && s -> version != DTLS1_VERSION )  location: 1217 cross_layer: 1 file: t1_lib.c
unsigned char * sdata = data ; location: 1219 cross_layer: 1 file: t1_lib.c
if ( size < 2 )  location: 1221 cross_layer: 1 file: t1_lib.c
if ( s -> s3 -> client_opaque_prf_input_len != size - 2 )  location: 1226 cross_layer: 1 file: t1_lib.c
if ( s -> s3 -> client_opaque_prf_input_len == 0 )  location: 1237 cross_layer: 1 file: t1_lib.c
s -> s3 -> client_opaque_prf_input = OPENSSL_malloc ( 1 ); location: 1238 cross_layer: 1 file: t1_lib.c
s -> s3 -> client_opaque_prf_input = BUF_memdup ( sdata , s -> s3 -> client_opaque_prf_input_len ); location: 1240 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_session_ticket )  location: 1248 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_renegotiate )  location: 1256 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_signature_algorithms )  location: 1260 cross_layer: 1 file: t1_lib.c
if ( sigalg_seen || size < 2 )  location: 1262 cross_layer: 1 file: t1_lib.c
size -= 2; location: 1266 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_status_request && s -> version != DTLS1_VERSION )  location: 1271 cross_layer: 1 file: t1_lib.c
if ( size < 5 )  location: 1274 cross_layer: 1 file: t1_lib.c
s -> tlsext_status_type = * data ++; location: 1277 cross_layer: 1 file: t1_lib.c
size --; location: 1278 cross_layer: 1 file: t1_lib.c
if ( s -> tlsext_status_type == TLSEXT_STATUSTYPE_ocsp )  location: 1279 cross_layer: 1 file: t1_lib.c
const unsigned char * sdata ; location: 1280 cross_layer: 1 file: t1_lib.c
int dsize ; location: 1281 cross_layer: 1 file: t1_lib.c
size -= 2; location: 1284 cross_layer: 1 file: t1_lib.c
if ( dsize > size )  location: 1285 cross_layer: 1 file: t1_lib.c
while ( dsize > 0 )  location: 1287 cross_layer: 1 file: t1_lib.c
OCSP_RESPID * id ; location: 1288 cross_layer: 1 file: t1_lib.c
int idsize ; location: 1289 cross_layer: 1 file: t1_lib.c
if ( dsize < 4 )  location: 1290 cross_layer: 1 file: t1_lib.c
dsize -= 2 + idsize; location: 1293 cross_layer: 1 file: t1_lib.c
if ( dsize < 0 )  location: 1295 cross_layer: 1 file: t1_lib.c
sdata = data; location: 1297 cross_layer: 1 file: t1_lib.c
data += idsize; location: 1298 cross_layer: 1 file: t1_lib.c
id = d2i_OCSP_RESPID ( NULL , & sdata , idsize ); location: 1299 cross_layer: 1 file: t1_lib.c
if ( ! id )  location: 1300 cross_layer: 1 file: t1_lib.c
if ( data != sdata )  location: 1302 cross_layer: 1 file: t1_lib.c
if ( ! s -> tlsext_ocsp_ids && ! ( s -> tlsext_ocsp_ids = sk_OCSP_RESPID_new_null ( ) ) )  location: 1306 cross_layer: 1 file: t1_lib.c
OCSP_RESPID_free ( id ); location: 1309 cross_layer: 1 file: t1_lib.c
if ( ! sk_OCSP_RESPID_push ( s -> tlsext_ocsp_ids , id ) )  location: 1313 cross_layer: 1 file: t1_lib.c
OCSP_RESPID_free ( id ); location: 1314 cross_layer: 1 file: t1_lib.c
n2s ( data , dsize ); location: 1323 cross_layer: 1 file: t1_lib.c
sdata = data; location: 1327 cross_layer: 1 file: t1_lib.c
if ( s -> tlsext_ocsp_exts )  location: 1329 cross_layer: 1 file: t1_lib.c
sk_X509_EXTENSION_pop_free ( s -> tlsext_ocsp_exts , X509_EXTENSION_free ); location: 1330 cross_layer: 1 file: t1_lib.c
s -> tlsext_ocsp_exts = d2i_X509_EXTENSIONS ( NULL , & sdata , dsize ); location: 1334 cross_layer: 1 file: t1_lib.c
if ( ! s -> tlsext_ocsp_exts || ( data + dsize != sdata ) )  location: 1336 cross_layer: 1 file: t1_lib.c
s -> tlsext_status_type = - 1; location: 1344 cross_layer: 1 file: t1_lib.c
s -> tlsext_heartbeat |= SSL_TLSEXT_HB_ENABLED; location: 1350 cross_layer: 1 file: t1_lib.c
s -> tlsext_heartbeat |= SSL_TLSEXT_HB_ENABLED; location: 1353 cross_layer: 1 file: t1_lib.c
s -> tlsext_heartbeat |= SSL_TLSEXT_HB_DONT_SEND_REQUESTS; location: 1354 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_next_proto_neg && s -> s3 -> tmp . finish_md_len == 0 )  location: 1363 cross_layer: 1 file: t1_lib.c
s -> s3 -> next_proto_neg_seen = 1; location: 1382 cross_layer: 1 file: t1_lib.c
if ( SSL_IS_DTLS ( s ) && SSL_get_srtp_profiles ( s ) && type == TLSEXT_TYPE_use_srtp )  location: 1388 cross_layer: 1 file: t1_lib.c
if ( ssl_parse_clienthello_use_srtp_ext ( s , data , size , al ) )  location: 1390 cross_layer: 1 file: t1_lib.c
data += size; location: 1395 cross_layer: 1 file: t1_lib.c
if ( data != limit )  location: 1399 cross_layer: 1 file: t1_lib.c
* p = data; location: 1402 cross_layer: 1 file: t1_lib.c
if ( ! renegotiate_seen && s -> renegotiate && ! ( s -> options & SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION ) )  location: 1408 cross_layer: 1 file: t1_lib.c
------------------------------
2 @@ testCode/CVE-2016-6304_CWE-401_2c0d295e26306e15a92eb23a84a1802005c1c137_t1_lib.c_OLD.c @@ ssl_parse_clienthello_tlsext @@ 1309 @@ ['id'] @@ {s, p, limit, data, sdata, sdata, sdata, sdata, sdata, id}
# endif                         /* !OPENSSL_NO_EC */ location: 983 cross_layer: 1 file: t1_lib.c
unsigned short type ; location: 987 cross_layer: 1 file: t1_lib.c
unsigned short size ; location: 988 cross_layer: 1 file: t1_lib.c
unsigned short len ; location: 989 cross_layer: 1 file: t1_lib.c
unsigned char * data = * p ; location: 990 cross_layer: 1 file: t1_lib.c
int sigalg_seen = 0 ; location: 992 cross_layer: 1 file: t1_lib.c
s -> servername_done = 0; location: 994 cross_layer: 1 file: t1_lib.c
s -> tlsext_status_type = - 1; location: 995 cross_layer: 1 file: t1_lib.c
s -> s3 -> next_proto_neg_seen = 0; location: 997 cross_layer: 1 file: t1_lib.c
s -> tlsext_heartbeat &= ~ ( SSL_TLSEXT_HB_ENABLED | SSL_TLSEXT_HB_DONT_SEND_REQUESTS ); location: 1001 cross_layer: 1 file: t1_lib.c
if ( s -> srp_ctx . login != NULL )  location: 1011 cross_layer: 1 file: t1_lib.c
s -> srp_ctx . login = NULL; location: 1013 cross_layer: 1 file: t1_lib.c
s -> srtp_profile = NULL; location: 1017 cross_layer: 1 file: t1_lib.c
if ( data == limit )  location: 1019 cross_layer: 1 file: t1_lib.c
if ( limit - data < 2 )  location: 1022 cross_layer: 1 file: t1_lib.c
if ( limit - data != len )  location: 1027 cross_layer: 1 file: t1_lib.c
while ( limit - data >= 4 )  location: 1030 cross_layer: 1 file: t1_lib.c
if ( limit - data < size )  location: 1034 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_server_name )  location: 1066 cross_layer: 1 file: t1_lib.c
unsigned char * sdata ; location: 1067 cross_layer: 1 file: t1_lib.c
int servname_type ; location: 1068 cross_layer: 1 file: t1_lib.c
int dsize ; location: 1069 cross_layer: 1 file: t1_lib.c
if ( size < 2 )  location: 1071 cross_layer: 1 file: t1_lib.c
size -= 2; location: 1074 cross_layer: 1 file: t1_lib.c
if ( dsize > size )  location: 1075 cross_layer: 1 file: t1_lib.c
sdata = data; location: 1078 cross_layer: 1 file: t1_lib.c
while ( dsize > 3 )  location: 1079 cross_layer: 1 file: t1_lib.c
servname_type = * ( sdata ++ ); location: 1080 cross_layer: 1 file: t1_lib.c
dsize -= 3; location: 1082 cross_layer: 1 file: t1_lib.c
if ( len > dsize )  location: 1084 cross_layer: 1 file: t1_lib.c
if ( s -> servername_done == 0 )  location: 1087 cross_layer: 1 file: t1_lib.c
switch ( servname_type )  location: 1088 cross_layer: 1 file: t1_lib.c
if ( ! s -> hit )  location: 1090 cross_layer: 1 file: t1_lib.c
if ( s -> session -> tlsext_hostname )  location: 1091 cross_layer: 1 file: t1_lib.c
if ( len > TLSEXT_MAXLEN_host_name )  location: 1094 cross_layer: 1 file: t1_lib.c
if ( ( s -> session -> tlsext_hostname = OPENSSL_malloc ( len + 1 ) ) == NULL )  location: 1098 cross_layer: 1 file: t1_lib.c
memcpy ( s -> session -> tlsext_hostname , sdata , len ); location: 1103 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_hostname [ len ] = '\0'; location: 1104 cross_layer: 1 file: t1_lib.c
if ( strlen ( s -> session -> tlsext_hostname ) != len )  location: 1105 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_hostname = NULL; location: 1107 cross_layer: 1 file: t1_lib.c
s -> servername_done = 1; location: 1111 cross_layer: 1 file: t1_lib.c
s -> servername_done = s -> session -> tlsext_hostname && strlen ( s -> session -> tlsext_hostname ) == len && strncmp ( s -> session -> tlsext_hostname , ( char * ) sdata , len ) == 0; location: 1114 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_srp )  location: 1132 cross_layer: 1 file: t1_lib.c
if ( size == 0 || ( ( len = data [ 0 ] ) ) != ( size - 1 ) )  location: 1133 cross_layer: 1 file: t1_lib.c
if ( s -> srp_ctx . login != NULL )  location: 1135 cross_layer: 1 file: t1_lib.c
if ( ( s -> srp_ctx . login = OPENSSL_malloc ( len + 1 ) ) == NULL )  location: 1137 cross_layer: 1 file: t1_lib.c
memcpy ( s -> srp_ctx . login , & data [ 1 ] , len ); location: 1139 cross_layer: 1 file: t1_lib.c
s -> srp_ctx . login [ len ] = '\0'; location: 1140 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_ec_point_formats )  location: 1148 cross_layer: 1 file: t1_lib.c
unsigned char * sdata = data ; location: 1149 cross_layer: 1 file: t1_lib.c
int ecpointformatlist_length = * ( sdata ++ ) ; location: 1150 cross_layer: 1 file: t1_lib.c
if ( ecpointformatlist_length != size - 1 )  location: 1152 cross_layer: 1 file: t1_lib.c
if ( ! s -> hit )  location: 1154 cross_layer: 1 file: t1_lib.c
if ( s -> session -> tlsext_ecpointformatlist )  location: 1155 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ecpointformatlist = NULL; location: 1157 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ecpointformatlist_length = 0; location: 1159 cross_layer: 1 file: t1_lib.c
if ( ( s -> session -> tlsext_ecpointformatlist = OPENSSL_malloc ( ecpointformatlist_length ) ) == NULL )  location: 1160 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ecpointformatlist_length = ecpointformatlist_length; location: 1165 cross_layer: 1 file: t1_lib.c
memcpy ( s -> session -> tlsext_ecpointformatlist , sdata , ecpointformatlist_length ); location: 1167 cross_layer: 1 file: t1_lib.c
fprintf ( stderr , "ssl_parse_clienthello_tlsext s->session->tlsext_ecpointformatlist (length=%i) " , s -> session -> tlsext_ecpointformatlist_length ); location: 1171 cross_layer: 1 file: t1_lib.c
sdata = s -> session -> tlsext_ecpointformatlist; location: 1174 cross_layer: 1 file: t1_lib.c
for (i = 0; i < s->session->tlsext_ecpointformatlist_length; i++) location: 1175 cross_layer: 1 file: t1_lib.c
fprintf ( stderr , "%i " , * ( sdata ++ ) ); location: 1176 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_elliptic_curves )  location: 1179 cross_layer: 1 file: t1_lib.c
unsigned char * sdata = data ; location: 1180 cross_layer: 1 file: t1_lib.c
int ellipticcurvelist_length = ( * ( sdata ++ ) << 8 ) ; location: 1181 cross_layer: 1 file: t1_lib.c
ellipticcurvelist_length += ( * ( sdata ++ ) ); location: 1182 cross_layer: 1 file: t1_lib.c
if ( ellipticcurvelist_length != size - 2 || ellipticcurvelist_length < 1 || ellipticcurvelist_length & 1 )  location: 1184 cross_layer: 1 file: t1_lib.c
if ( ! s -> hit )  location: 1190 cross_layer: 1 file: t1_lib.c
if ( s -> session -> tlsext_ellipticcurvelist )  location: 1191 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ellipticcurvelist_length = 0; location: 1194 cross_layer: 1 file: t1_lib.c
if ( ( s -> session -> tlsext_ellipticcurvelist = OPENSSL_malloc ( ellipticcurvelist_length ) ) == NULL )  location: 1195 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ellipticcurvelist_length = ellipticcurvelist_length; location: 1200 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_opaque_prf_input && s -> version != DTLS1_VERSION )  location: 1217 cross_layer: 1 file: t1_lib.c
unsigned char * sdata = data ; location: 1219 cross_layer: 1 file: t1_lib.c
if ( size < 2 )  location: 1221 cross_layer: 1 file: t1_lib.c
if ( s -> s3 -> client_opaque_prf_input_len != size - 2 )  location: 1226 cross_layer: 1 file: t1_lib.c
if ( s -> s3 -> client_opaque_prf_input_len == 0 )  location: 1237 cross_layer: 1 file: t1_lib.c
s -> s3 -> client_opaque_prf_input = OPENSSL_malloc ( 1 ); location: 1238 cross_layer: 1 file: t1_lib.c
s -> s3 -> client_opaque_prf_input = BUF_memdup ( sdata , s -> s3 -> client_opaque_prf_input_len ); location: 1240 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_session_ticket )  location: 1248 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_renegotiate )  location: 1256 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_signature_algorithms )  location: 1260 cross_layer: 1 file: t1_lib.c
if ( sigalg_seen || size < 2 )  location: 1262 cross_layer: 1 file: t1_lib.c
size -= 2; location: 1266 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_status_request && s -> version != DTLS1_VERSION )  location: 1271 cross_layer: 1 file: t1_lib.c
if ( size < 5 )  location: 1274 cross_layer: 1 file: t1_lib.c
s -> tlsext_status_type = * data ++; location: 1277 cross_layer: 1 file: t1_lib.c
size --; location: 1278 cross_layer: 1 file: t1_lib.c
if ( s -> tlsext_status_type == TLSEXT_STATUSTYPE_ocsp )  location: 1279 cross_layer: 1 file: t1_lib.c
const unsigned char * sdata ; location: 1280 cross_layer: 1 file: t1_lib.c
int dsize ; location: 1281 cross_layer: 1 file: t1_lib.c
size -= 2; location: 1284 cross_layer: 1 file: t1_lib.c
if ( dsize > size )  location: 1285 cross_layer: 1 file: t1_lib.c
while ( dsize > 0 )  location: 1287 cross_layer: 1 file: t1_lib.c
OCSP_RESPID * id ; location: 1288 cross_layer: 1 file: t1_lib.c
int idsize ; location: 1289 cross_layer: 1 file: t1_lib.c
if ( dsize < 4 )  location: 1290 cross_layer: 1 file: t1_lib.c
dsize -= 2 + idsize; location: 1293 cross_layer: 1 file: t1_lib.c
if ( dsize < 0 )  location: 1295 cross_layer: 1 file: t1_lib.c
sdata = data; location: 1297 cross_layer: 1 file: t1_lib.c
data += idsize; location: 1298 cross_layer: 1 file: t1_lib.c
id = d2i_OCSP_RESPID ( NULL , & sdata , idsize ); location: 1299 cross_layer: 1 file: t1_lib.c
if ( ! id )  location: 1300 cross_layer: 1 file: t1_lib.c
if ( data != sdata )  location: 1302 cross_layer: 1 file: t1_lib.c
if ( ! s -> tlsext_ocsp_ids && ! ( s -> tlsext_ocsp_ids = sk_OCSP_RESPID_new_null ( ) ) )  location: 1306 cross_layer: 1 file: t1_lib.c
OCSP_RESPID_free ( id ); location: 1309 cross_layer: 1 file: t1_lib.c
if ( ! sk_OCSP_RESPID_push ( s -> tlsext_ocsp_ids , id ) )  location: 1313 cross_layer: 1 file: t1_lib.c
OCSP_RESPID_free ( id ); location: 1314 cross_layer: 1 file: t1_lib.c
------------------------------
3 @@ testCode/CVE-2016-6304_CWE-401_2c0d295e26306e15a92eb23a84a1802005c1c137_t1_lib.c_OLD.c @@ ssl_parse_clienthello_tlsext @@ 1310 @@ ['*al'] @@ {s, p, limit, al, data, sdata, sdata, sdata, sdata, sdata, id}
# endif                         /* !OPENSSL_NO_EC */ location: 983 cross_layer: 1 file: t1_lib.c
unsigned short type ; location: 987 cross_layer: 1 file: t1_lib.c
unsigned short size ; location: 988 cross_layer: 1 file: t1_lib.c
unsigned short len ; location: 989 cross_layer: 1 file: t1_lib.c
unsigned char * data = * p ; location: 990 cross_layer: 1 file: t1_lib.c
int sigalg_seen = 0 ; location: 992 cross_layer: 1 file: t1_lib.c
s -> servername_done = 0; location: 994 cross_layer: 1 file: t1_lib.c
s -> tlsext_status_type = - 1; location: 995 cross_layer: 1 file: t1_lib.c
s -> s3 -> next_proto_neg_seen = 0; location: 997 cross_layer: 1 file: t1_lib.c
s -> tlsext_heartbeat &= ~ ( SSL_TLSEXT_HB_ENABLED | SSL_TLSEXT_HB_DONT_SEND_REQUESTS ); location: 1001 cross_layer: 1 file: t1_lib.c
if ( s -> srp_ctx . login != NULL )  location: 1011 cross_layer: 1 file: t1_lib.c
s -> srp_ctx . login = NULL; location: 1013 cross_layer: 1 file: t1_lib.c
s -> srtp_profile = NULL; location: 1017 cross_layer: 1 file: t1_lib.c
if ( data == limit )  location: 1019 cross_layer: 1 file: t1_lib.c
if ( limit - data < 2 )  location: 1022 cross_layer: 1 file: t1_lib.c
if ( limit - data != len )  location: 1027 cross_layer: 1 file: t1_lib.c
while ( limit - data >= 4 )  location: 1030 cross_layer: 1 file: t1_lib.c
if ( limit - data < size )  location: 1034 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_server_name )  location: 1066 cross_layer: 1 file: t1_lib.c
unsigned char * sdata ; location: 1067 cross_layer: 1 file: t1_lib.c
int servname_type ; location: 1068 cross_layer: 1 file: t1_lib.c
int dsize ; location: 1069 cross_layer: 1 file: t1_lib.c
if ( size < 2 )  location: 1071 cross_layer: 1 file: t1_lib.c
size -= 2; location: 1074 cross_layer: 1 file: t1_lib.c
if ( dsize > size )  location: 1075 cross_layer: 1 file: t1_lib.c
sdata = data; location: 1078 cross_layer: 1 file: t1_lib.c
while ( dsize > 3 )  location: 1079 cross_layer: 1 file: t1_lib.c
servname_type = * ( sdata ++ ); location: 1080 cross_layer: 1 file: t1_lib.c
dsize -= 3; location: 1082 cross_layer: 1 file: t1_lib.c
if ( len > dsize )  location: 1084 cross_layer: 1 file: t1_lib.c
if ( s -> servername_done == 0 )  location: 1087 cross_layer: 1 file: t1_lib.c
switch ( servname_type )  location: 1088 cross_layer: 1 file: t1_lib.c
if ( ! s -> hit )  location: 1090 cross_layer: 1 file: t1_lib.c
if ( s -> session -> tlsext_hostname )  location: 1091 cross_layer: 1 file: t1_lib.c
if ( len > TLSEXT_MAXLEN_host_name )  location: 1094 cross_layer: 1 file: t1_lib.c
if ( ( s -> session -> tlsext_hostname = OPENSSL_malloc ( len + 1 ) ) == NULL )  location: 1098 cross_layer: 1 file: t1_lib.c
memcpy ( s -> session -> tlsext_hostname , sdata , len ); location: 1103 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_hostname [ len ] = '\0'; location: 1104 cross_layer: 1 file: t1_lib.c
if ( strlen ( s -> session -> tlsext_hostname ) != len )  location: 1105 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_hostname = NULL; location: 1107 cross_layer: 1 file: t1_lib.c
s -> servername_done = 1; location: 1111 cross_layer: 1 file: t1_lib.c
s -> servername_done = s -> session -> tlsext_hostname && strlen ( s -> session -> tlsext_hostname ) == len && strncmp ( s -> session -> tlsext_hostname , ( char * ) sdata , len ) == 0; location: 1114 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_srp )  location: 1132 cross_layer: 1 file: t1_lib.c
if ( size == 0 || ( ( len = data [ 0 ] ) ) != ( size - 1 ) )  location: 1133 cross_layer: 1 file: t1_lib.c
if ( s -> srp_ctx . login != NULL )  location: 1135 cross_layer: 1 file: t1_lib.c
if ( ( s -> srp_ctx . login = OPENSSL_malloc ( len + 1 ) ) == NULL )  location: 1137 cross_layer: 1 file: t1_lib.c
memcpy ( s -> srp_ctx . login , & data [ 1 ] , len ); location: 1139 cross_layer: 1 file: t1_lib.c
s -> srp_ctx . login [ len ] = '\0'; location: 1140 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_ec_point_formats )  location: 1148 cross_layer: 1 file: t1_lib.c
unsigned char * sdata = data ; location: 1149 cross_layer: 1 file: t1_lib.c
int ecpointformatlist_length = * ( sdata ++ ) ; location: 1150 cross_layer: 1 file: t1_lib.c
if ( ecpointformatlist_length != size - 1 )  location: 1152 cross_layer: 1 file: t1_lib.c
if ( ! s -> hit )  location: 1154 cross_layer: 1 file: t1_lib.c
if ( s -> session -> tlsext_ecpointformatlist )  location: 1155 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ecpointformatlist = NULL; location: 1157 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ecpointformatlist_length = 0; location: 1159 cross_layer: 1 file: t1_lib.c
if ( ( s -> session -> tlsext_ecpointformatlist = OPENSSL_malloc ( ecpointformatlist_length ) ) == NULL )  location: 1160 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ecpointformatlist_length = ecpointformatlist_length; location: 1165 cross_layer: 1 file: t1_lib.c
memcpy ( s -> session -> tlsext_ecpointformatlist , sdata , ecpointformatlist_length ); location: 1167 cross_layer: 1 file: t1_lib.c
fprintf ( stderr , "ssl_parse_clienthello_tlsext s->session->tlsext_ecpointformatlist (length=%i) " , s -> session -> tlsext_ecpointformatlist_length ); location: 1171 cross_layer: 1 file: t1_lib.c
sdata = s -> session -> tlsext_ecpointformatlist; location: 1174 cross_layer: 1 file: t1_lib.c
for (i = 0; i < s->session->tlsext_ecpointformatlist_length; i++) location: 1175 cross_layer: 1 file: t1_lib.c
fprintf ( stderr , "%i " , * ( sdata ++ ) ); location: 1176 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_elliptic_curves )  location: 1179 cross_layer: 1 file: t1_lib.c
unsigned char * sdata = data ; location: 1180 cross_layer: 1 file: t1_lib.c
int ellipticcurvelist_length = ( * ( sdata ++ ) << 8 ) ; location: 1181 cross_layer: 1 file: t1_lib.c
ellipticcurvelist_length += ( * ( sdata ++ ) ); location: 1182 cross_layer: 1 file: t1_lib.c
if ( ellipticcurvelist_length != size - 2 || ellipticcurvelist_length < 1 || ellipticcurvelist_length & 1 )  location: 1184 cross_layer: 1 file: t1_lib.c
if ( ! s -> hit )  location: 1190 cross_layer: 1 file: t1_lib.c
if ( s -> session -> tlsext_ellipticcurvelist )  location: 1191 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ellipticcurvelist_length = 0; location: 1194 cross_layer: 1 file: t1_lib.c
if ( ( s -> session -> tlsext_ellipticcurvelist = OPENSSL_malloc ( ellipticcurvelist_length ) ) == NULL )  location: 1195 cross_layer: 1 file: t1_lib.c
s -> session -> tlsext_ellipticcurvelist_length = ellipticcurvelist_length; location: 1200 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_opaque_prf_input && s -> version != DTLS1_VERSION )  location: 1217 cross_layer: 1 file: t1_lib.c
unsigned char * sdata = data ; location: 1219 cross_layer: 1 file: t1_lib.c
if ( size < 2 )  location: 1221 cross_layer: 1 file: t1_lib.c
if ( s -> s3 -> client_opaque_prf_input_len != size - 2 )  location: 1226 cross_layer: 1 file: t1_lib.c
if ( s -> s3 -> client_opaque_prf_input_len == 0 )  location: 1237 cross_layer: 1 file: t1_lib.c
s -> s3 -> client_opaque_prf_input = OPENSSL_malloc ( 1 ); location: 1238 cross_layer: 1 file: t1_lib.c
s -> s3 -> client_opaque_prf_input = BUF_memdup ( sdata , s -> s3 -> client_opaque_prf_input_len ); location: 1240 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_session_ticket )  location: 1248 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_renegotiate )  location: 1256 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_signature_algorithms )  location: 1260 cross_layer: 1 file: t1_lib.c
if ( sigalg_seen || size < 2 )  location: 1262 cross_layer: 1 file: t1_lib.c
size -= 2; location: 1266 cross_layer: 1 file: t1_lib.c
if ( type == TLSEXT_TYPE_status_request && s -> version != DTLS1_VERSION )  location: 1271 cross_layer: 1 file: t1_lib.c
if ( size < 5 )  location: 1274 cross_layer: 1 file: t1_lib.c
s -> tlsext_status_type = * data ++; location: 1277 cross_layer: 1 file: t1_lib.c
size --; location: 1278 cross_layer: 1 file: t1_lib.c
if ( s -> tlsext_status_type == TLSEXT_STATUSTYPE_ocsp )  location: 1279 cross_layer: 1 file: t1_lib.c
const unsigned char * sdata ; location: 1280 cross_layer: 1 file: t1_lib.c
int dsize ; location: 1281 cross_layer: 1 file: t1_lib.c
size -= 2; location: 1284 cross_layer: 1 file: t1_lib.c
if ( dsize > size )  location: 1285 cross_layer: 1 file: t1_lib.c
while ( dsize > 0 )  location: 1287 cross_layer: 1 file: t1_lib.c
OCSP_RESPID * id ; location: 1288 cross_layer: 1 file: t1_lib.c
int idsize ; location: 1289 cross_layer: 1 file: t1_lib.c
if ( dsize < 4 )  location: 1290 cross_layer: 1 file: t1_lib.c
dsize -= 2 + idsize; location: 1293 cross_layer: 1 file: t1_lib.c
if ( dsize < 0 )  location: 1295 cross_layer: 1 file: t1_lib.c
sdata = data; location: 1297 cross_layer: 1 file: t1_lib.c
data += idsize; location: 1298 cross_layer: 1 file: t1_lib.c
id = d2i_OCSP_RESPID ( NULL , & sdata , idsize ); location: 1299 cross_layer: 1 file: t1_lib.c
if ( ! id )  location: 1300 cross_layer: 1 file: t1_lib.c
if ( data != sdata )  location: 1302 cross_layer: 1 file: t1_lib.c
if ( ! s -> tlsext_ocsp_ids && ! ( s -> tlsext_ocsp_ids = sk_OCSP_RESPID_new_null ( ) ) )  location: 1306 cross_layer: 1 file: t1_lib.c
* al = SSL_AD_INTERNAL_ERROR; location: 1310 cross_layer: 1 file: t1_lib.c
* al = SSL_AD_INTERNAL_ERROR; location: 1315 cross_layer: 1 file: t1_lib.c
------------------------------
