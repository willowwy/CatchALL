1 @@ testCode/CVE-2016-6308_CWE-399_df6b5e29ffea2d5a3e08de92fb765fdb21c7a21e_statem_dtls.c_2.1_OLD.c @@ dtls1_retrieve_buffered_fragment @@ 507 @@ ['t', 'o', 'i', 'h', 'g', 'n'] @@ {s}
static unsigned long dtls1_max_handshake_message_len(const SSL *s) location: 501 cross_layer: 1 file: statem_dtls.c
unsigned long max_len = DTLS1_HM_HEADER_LENGTH + SSL3_RT_MAX_ENCRYPTED_LENGTH ; location: 503 cross_layer: 1 file: statem_dtls.c
if ( max_len < ( unsigned long ) s -> max_cert_list )  location: 505 cross_layer: 1 file: statem_dtls.c
return max_len ; location: 507 cross_layer: 1 file: statem_dtls.c
if ( ( msg_hdr -> frag_off + frag_len ) > msg_hdr -> msg_len || msg_hdr -> msg_len > dtls1_max_handshake_message_len ( s ) )  location: 519 cross_layer: 2 file: statem_dtls.c
* len = dtls1_reassemble_fragment ( s , & msg_hdr , & ok ); location: 789 cross_layer: 3 file: statem_dtls.c
ok = dtls_get_reassembled_message ( s , & tmplen ); location: 338 cross_layer: 4 file: statem_dtls.c
if ( tmplen <= 0 && ! ok )  location: 342 cross_layer: 4 file: statem_dtls.c
------------------------------
2 @@ testCode/CVE-2016-6308_CWE-399_df6b5e29ffea2d5a3e08de92fb765fdb21c7a21e_statem_dtls.c_2.1_OLD.c @@ dtls1_retrieve_buffered_fragment @@ 507 @@ ['t', 'o', 'i', 'h', 'g', 'n'] @@ {s}
static unsigned long dtls1_max_handshake_message_len(const SSL *s) location: 501 cross_layer: 1 file: statem_dtls.c
unsigned long max_len = DTLS1_HM_HEADER_LENGTH + SSL3_RT_MAX_ENCRYPTED_LENGTH ; location: 503 cross_layer: 1 file: statem_dtls.c
if ( max_len < ( unsigned long ) s -> max_cert_list )  location: 505 cross_layer: 1 file: statem_dtls.c
return max_len ; location: 507 cross_layer: 1 file: statem_dtls.c
if ( ( msg_hdr -> frag_off + frag_len ) > msg_hdr -> msg_len || msg_hdr -> msg_len > dtls1_max_handshake_message_len ( s ) )  location: 519 cross_layer: 2 file: statem_dtls.c
return dtls1_reassemble_fragment ( s , msg_hdr , ok ) ; location: 663 cross_layer: 3 file: statem_dtls.c
* len = dtls1_process_out_of_seq_message ( s , & msg_hdr , & ok ); location: 784 cross_layer: 4 file: statem_dtls.c
* len = dtls1_reassemble_fragment ( s , & msg_hdr , & ok ); location: 789 cross_layer: 4 file: statem_dtls.c
static int
dtls1_reassemble_fragment(SSL *s, const struct hm_header_st *msg_hdr, int *ok) location: 511 cross_layer: 5 file: statem_dtls.c
unsigned long frag_len = msg_hdr -> frag_len ; location: 517 cross_layer: 5 file: statem_dtls.c
if ( ( msg_hdr -> frag_off + frag_len ) > msg_hdr -> msg_len || msg_hdr -> msg_len > dtls1_max_handshake_message_len ( s ) )  location: 519 cross_layer: 5 file: statem_dtls.c
if ( frag_len == 0 )  location: 523 cross_layer: 5 file: statem_dtls.c
seq64be [ 6 ] = ( unsigned char ) ( msg_hdr -> seq >> 8 ); location: 528 cross_layer: 5 file: statem_dtls.c
seq64be [ 7 ] = ( unsigned char ) msg_hdr -> seq; location: 529 cross_layer: 5 file: statem_dtls.c
item = pqueue_find ( s -> d1 -> buffered_messages , seq64be ); location: 530 cross_layer: 5 file: statem_dtls.c
if ( item == NULL )  location: 532 cross_layer: 5 file: statem_dtls.c
frag = dtls1_hm_fragment_new ( msg_hdr -> msg_len , 1 ); location: 533 cross_layer: 5 file: statem_dtls.c
if ( frag == NULL )  location: 534 cross_layer: 5 file: statem_dtls.c
memcpy ( & ( frag -> msg_header ) , msg_hdr , sizeof ( * msg_hdr ) ); location: 536 cross_layer: 5 file: statem_dtls.c
frag -> msg_header . frag_len = frag -> msg_header . msg_len; location: 537 cross_layer: 5 file: statem_dtls.c
frag -> msg_header . frag_off = 0; location: 538 cross_layer: 5 file: statem_dtls.c
frag = ( hm_fragment * ) item -> data; location: 540 cross_layer: 5 file: statem_dtls.c
if ( frag -> msg_header . msg_len != msg_hdr -> msg_len )  location: 541 cross_layer: 5 file: statem_dtls.c
if ( frag -> reassembly == NULL )  location: 553 cross_layer: 5 file: statem_dtls.c
while ( frag_len )  location: 556 cross_layer: 5 file: statem_dtls.c
i = s -> method -> ssl_read_bytes ( s , SSL3_RT_HANDSHAKE , NULL , devnull , frag_len > sizeof ( devnull ) ? sizeof ( devnull ) : frag_len , 0 ); location: 557 cross_layer: 5 file: statem_dtls.c
if ( i <= 0 )  location: 562 cross_layer: 5 file: statem_dtls.c
frag_len -= i; location: 564 cross_layer: 5 file: statem_dtls.c
i = s -> method -> ssl_read_bytes ( s , SSL3_RT_HANDSHAKE , NULL , frag -> fragment + msg_hdr -> frag_off , frag_len , 0 ); location: 570 cross_layer: 5 file: statem_dtls.c
if ( ( unsigned long ) i != frag_len )  location: 573 cross_layer: 5 file: statem_dtls.c
if ( i <= 0 )  location: 575 cross_layer: 5 file: statem_dtls.c
RSMBLY_BITMASK_MARK ( frag -> reassembly , ( long ) msg_hdr -> frag_off , ( long ) ( msg_hdr -> frag_off + frag_len ) ); location: 578 cross_layer: 5 file: statem_dtls.c
RSMBLY_BITMASK_IS_COMPLETE ( frag -> reassembly , ( long ) msg_hdr -> msg_len , is_complete ); location: 581 cross_layer: 5 file: statem_dtls.c
OPENSSL_free ( frag -> reassembly ); location: 585 cross_layer: 5 file: statem_dtls.c
frag -> reassembly = NULL; location: 586 cross_layer: 5 file: statem_dtls.c
if ( item == NULL )  location: 589 cross_layer: 5 file: statem_dtls.c
item = pitem_new ( seq64be , frag ); location: 590 cross_layer: 5 file: statem_dtls.c
if ( item == NULL )  location: 591 cross_layer: 5 file: statem_dtls.c
item = pqueue_insert ( s -> d1 -> buffered_messages , item ); location: 596 cross_layer: 5 file: statem_dtls.c
OPENSSL_assert ( item != NULL ); location: 603 cross_layer: 5 file: statem_dtls.c
if ( item == NULL )  location: 609 cross_layer: 5 file: statem_dtls.c
dtls1_hm_fragment_free ( frag ); location: 610 cross_layer: 5 file: statem_dtls.c
* ok = 0; location: 611 cross_layer: 5 file: statem_dtls.c
return i ; location: 612 cross_layer: 5 file: statem_dtls.c
------------------------------
3 @@ testCode/CVE-2016-6308_CWE-399_df6b5e29ffea2d5a3e08de92fb765fdb21c7a21e_statem_dtls.c_2.1_OLD.c @@ dtls1_retrieve_buffered_fragment @@ 507 @@ ['t', 'o', 'i', 'h', 'g', 'n'] @@ {s}
static unsigned long dtls1_max_handshake_message_len(const SSL *s) location: 501 cross_layer: 1 file: statem_dtls.c
unsigned long max_len = DTLS1_HM_HEADER_LENGTH + SSL3_RT_MAX_ENCRYPTED_LENGTH ; location: 503 cross_layer: 1 file: statem_dtls.c
if ( max_len < ( unsigned long ) s -> max_cert_list )  location: 505 cross_layer: 1 file: statem_dtls.c
return max_len ; location: 507 cross_layer: 1 file: statem_dtls.c
if ( frag_len > dtls1_max_handshake_message_len ( s ) )  location: 665 cross_layer: 2 file: statem_dtls.c
* len = dtls1_process_out_of_seq_message ( s , & msg_hdr , & ok ); location: 784 cross_layer: 3 file: statem_dtls.c
* len = dtls1_reassemble_fragment ( s , & msg_hdr , & ok ); location: 789 cross_layer: 3 file: statem_dtls.c
static int
dtls1_reassemble_fragment(SSL *s, const struct hm_header_st *msg_hdr, int *ok) location: 511 cross_layer: 4 file: statem_dtls.c
unsigned long frag_len = msg_hdr -> frag_len ; location: 517 cross_layer: 4 file: statem_dtls.c
if ( ( msg_hdr -> frag_off + frag_len ) > msg_hdr -> msg_len || msg_hdr -> msg_len > dtls1_max_handshake_message_len ( s ) )  location: 519 cross_layer: 4 file: statem_dtls.c
if ( frag_len == 0 )  location: 523 cross_layer: 4 file: statem_dtls.c
seq64be [ 6 ] = ( unsigned char ) ( msg_hdr -> seq >> 8 ); location: 528 cross_layer: 4 file: statem_dtls.c
seq64be [ 7 ] = ( unsigned char ) msg_hdr -> seq; location: 529 cross_layer: 4 file: statem_dtls.c
item = pqueue_find ( s -> d1 -> buffered_messages , seq64be ); location: 530 cross_layer: 4 file: statem_dtls.c
if ( item == NULL )  location: 532 cross_layer: 4 file: statem_dtls.c
frag = dtls1_hm_fragment_new ( msg_hdr -> msg_len , 1 ); location: 533 cross_layer: 4 file: statem_dtls.c
if ( frag == NULL )  location: 534 cross_layer: 4 file: statem_dtls.c
memcpy ( & ( frag -> msg_header ) , msg_hdr , sizeof ( * msg_hdr ) ); location: 536 cross_layer: 4 file: statem_dtls.c
frag -> msg_header . frag_len = frag -> msg_header . msg_len; location: 537 cross_layer: 4 file: statem_dtls.c
frag -> msg_header . frag_off = 0; location: 538 cross_layer: 4 file: statem_dtls.c
frag = ( hm_fragment * ) item -> data; location: 540 cross_layer: 4 file: statem_dtls.c
if ( frag -> msg_header . msg_len != msg_hdr -> msg_len )  location: 541 cross_layer: 4 file: statem_dtls.c
if ( frag -> reassembly == NULL )  location: 553 cross_layer: 4 file: statem_dtls.c
while ( frag_len )  location: 556 cross_layer: 4 file: statem_dtls.c
i = s -> method -> ssl_read_bytes ( s , SSL3_RT_HANDSHAKE , NULL , devnull , frag_len > sizeof ( devnull ) ? sizeof ( devnull ) : frag_len , 0 ); location: 557 cross_layer: 4 file: statem_dtls.c
if ( i <= 0 )  location: 562 cross_layer: 4 file: statem_dtls.c
frag_len -= i; location: 564 cross_layer: 4 file: statem_dtls.c
i = s -> method -> ssl_read_bytes ( s , SSL3_RT_HANDSHAKE , NULL , frag -> fragment + msg_hdr -> frag_off , frag_len , 0 ); location: 570 cross_layer: 4 file: statem_dtls.c
if ( ( unsigned long ) i != frag_len )  location: 573 cross_layer: 4 file: statem_dtls.c
if ( i <= 0 )  location: 575 cross_layer: 4 file: statem_dtls.c
RSMBLY_BITMASK_MARK ( frag -> reassembly , ( long ) msg_hdr -> frag_off , ( long ) ( msg_hdr -> frag_off + frag_len ) ); location: 578 cross_layer: 4 file: statem_dtls.c
RSMBLY_BITMASK_IS_COMPLETE ( frag -> reassembly , ( long ) msg_hdr -> msg_len , is_complete ); location: 581 cross_layer: 4 file: statem_dtls.c
OPENSSL_free ( frag -> reassembly ); location: 585 cross_layer: 4 file: statem_dtls.c
frag -> reassembly = NULL; location: 586 cross_layer: 4 file: statem_dtls.c
if ( item == NULL )  location: 589 cross_layer: 4 file: statem_dtls.c
item = pitem_new ( seq64be , frag ); location: 590 cross_layer: 4 file: statem_dtls.c
if ( item == NULL )  location: 591 cross_layer: 4 file: statem_dtls.c
item = pqueue_insert ( s -> d1 -> buffered_messages , item ); location: 596 cross_layer: 4 file: statem_dtls.c
OPENSSL_assert ( item != NULL ); location: 603 cross_layer: 4 file: statem_dtls.c
if ( item == NULL )  location: 609 cross_layer: 4 file: statem_dtls.c
dtls1_hm_fragment_free ( frag ); location: 610 cross_layer: 4 file: statem_dtls.c
* ok = 0; location: 611 cross_layer: 4 file: statem_dtls.c
return i ; location: 612 cross_layer: 4 file: statem_dtls.c
ok = dtls_get_reassembled_message ( s , & tmplen ); location: 338 cross_layer: 4 file: statem_dtls.c
if ( tmplen <= 0 && ! ok )  location: 342 cross_layer: 4 file: statem_dtls.c
------------------------------
4 @@ testCode/CVE-2016-6308_CWE-399_df6b5e29ffea2d5a3e08de92fb765fdb21c7a21e_statem_dtls.c_2.1_OLD.c @@ dtls1_retrieve_buffered_fragment @@ 506 @@ ['s->max_cert_list'] @@ {s}
static unsigned long dtls1_max_handshake_message_len(const SSL *s) location: 501 cross_layer: 1 file: statem_dtls.c
unsigned long max_len = DTLS1_HM_HEADER_LENGTH + SSL3_RT_MAX_ENCRYPTED_LENGTH ; location: 503 cross_layer: 1 file: statem_dtls.c
if ( max_len < ( unsigned long ) s -> max_cert_list )  location: 505 cross_layer: 1 file: statem_dtls.c
return s -> max_cert_list ; location: 506 cross_layer: 1 file: statem_dtls.c
if ( ( msg_hdr -> frag_off + frag_len ) > msg_hdr -> msg_len || msg_hdr -> msg_len > dtls1_max_handshake_message_len ( s ) )  location: 519 cross_layer: 2 file: statem_dtls.c
* len = dtls1_reassemble_fragment ( s , & msg_hdr , & ok ); location: 789 cross_layer: 3 file: statem_dtls.c
ok = dtls_get_reassembled_message ( s , & tmplen ); location: 338 cross_layer: 4 file: statem_dtls.c
if ( tmplen <= 0 && ! ok )  location: 342 cross_layer: 4 file: statem_dtls.c
------------------------------
5 @@ testCode/CVE-2016-6308_CWE-399_df6b5e29ffea2d5a3e08de92fb765fdb21c7a21e_statem_dtls.c_2.1_OLD.c @@ dtls1_retrieve_buffered_fragment @@ 506 @@ ['s->max_cert_list'] @@ {s}
static unsigned long dtls1_max_handshake_message_len(const SSL *s) location: 501 cross_layer: 1 file: statem_dtls.c
unsigned long max_len = DTLS1_HM_HEADER_LENGTH + SSL3_RT_MAX_ENCRYPTED_LENGTH ; location: 503 cross_layer: 1 file: statem_dtls.c
if ( max_len < ( unsigned long ) s -> max_cert_list )  location: 505 cross_layer: 1 file: statem_dtls.c
return s -> max_cert_list ; location: 506 cross_layer: 1 file: statem_dtls.c
if ( ( msg_hdr -> frag_off + frag_len ) > msg_hdr -> msg_len || msg_hdr -> msg_len > dtls1_max_handshake_message_len ( s ) )  location: 519 cross_layer: 2 file: statem_dtls.c
return dtls1_reassemble_fragment ( s , msg_hdr , ok ) ; location: 663 cross_layer: 3 file: statem_dtls.c
* len = dtls1_process_out_of_seq_message ( s , & msg_hdr , & ok ); location: 784 cross_layer: 4 file: statem_dtls.c
* len = dtls1_reassemble_fragment ( s , & msg_hdr , & ok ); location: 789 cross_layer: 4 file: statem_dtls.c
static int
dtls1_reassemble_fragment(SSL *s, const struct hm_header_st *msg_hdr, int *ok) location: 511 cross_layer: 5 file: statem_dtls.c
unsigned long frag_len = msg_hdr -> frag_len ; location: 517 cross_layer: 5 file: statem_dtls.c
if ( ( msg_hdr -> frag_off + frag_len ) > msg_hdr -> msg_len || msg_hdr -> msg_len > dtls1_max_handshake_message_len ( s ) )  location: 519 cross_layer: 5 file: statem_dtls.c
if ( frag_len == 0 )  location: 523 cross_layer: 5 file: statem_dtls.c
seq64be [ 6 ] = ( unsigned char ) ( msg_hdr -> seq >> 8 ); location: 528 cross_layer: 5 file: statem_dtls.c
seq64be [ 7 ] = ( unsigned char ) msg_hdr -> seq; location: 529 cross_layer: 5 file: statem_dtls.c
item = pqueue_find ( s -> d1 -> buffered_messages , seq64be ); location: 530 cross_layer: 5 file: statem_dtls.c
if ( item == NULL )  location: 532 cross_layer: 5 file: statem_dtls.c
frag = dtls1_hm_fragment_new ( msg_hdr -> msg_len , 1 ); location: 533 cross_layer: 5 file: statem_dtls.c
if ( frag == NULL )  location: 534 cross_layer: 5 file: statem_dtls.c
memcpy ( & ( frag -> msg_header ) , msg_hdr , sizeof ( * msg_hdr ) ); location: 536 cross_layer: 5 file: statem_dtls.c
frag -> msg_header . frag_len = frag -> msg_header . msg_len; location: 537 cross_layer: 5 file: statem_dtls.c
frag -> msg_header . frag_off = 0; location: 538 cross_layer: 5 file: statem_dtls.c
frag = ( hm_fragment * ) item -> data; location: 540 cross_layer: 5 file: statem_dtls.c
if ( frag -> msg_header . msg_len != msg_hdr -> msg_len )  location: 541 cross_layer: 5 file: statem_dtls.c
if ( frag -> reassembly == NULL )  location: 553 cross_layer: 5 file: statem_dtls.c
while ( frag_len )  location: 556 cross_layer: 5 file: statem_dtls.c
i = s -> method -> ssl_read_bytes ( s , SSL3_RT_HANDSHAKE , NULL , devnull , frag_len > sizeof ( devnull ) ? sizeof ( devnull ) : frag_len , 0 ); location: 557 cross_layer: 5 file: statem_dtls.c
if ( i <= 0 )  location: 562 cross_layer: 5 file: statem_dtls.c
frag_len -= i; location: 564 cross_layer: 5 file: statem_dtls.c
i = s -> method -> ssl_read_bytes ( s , SSL3_RT_HANDSHAKE , NULL , frag -> fragment + msg_hdr -> frag_off , frag_len , 0 ); location: 570 cross_layer: 5 file: statem_dtls.c
if ( ( unsigned long ) i != frag_len )  location: 573 cross_layer: 5 file: statem_dtls.c
if ( i <= 0 )  location: 575 cross_layer: 5 file: statem_dtls.c
RSMBLY_BITMASK_MARK ( frag -> reassembly , ( long ) msg_hdr -> frag_off , ( long ) ( msg_hdr -> frag_off + frag_len ) ); location: 578 cross_layer: 5 file: statem_dtls.c
RSMBLY_BITMASK_IS_COMPLETE ( frag -> reassembly , ( long ) msg_hdr -> msg_len , is_complete ); location: 581 cross_layer: 5 file: statem_dtls.c
OPENSSL_free ( frag -> reassembly ); location: 585 cross_layer: 5 file: statem_dtls.c
frag -> reassembly = NULL; location: 586 cross_layer: 5 file: statem_dtls.c
if ( item == NULL )  location: 589 cross_layer: 5 file: statem_dtls.c
item = pitem_new ( seq64be , frag ); location: 590 cross_layer: 5 file: statem_dtls.c
if ( item == NULL )  location: 591 cross_layer: 5 file: statem_dtls.c
item = pqueue_insert ( s -> d1 -> buffered_messages , item ); location: 596 cross_layer: 5 file: statem_dtls.c
OPENSSL_assert ( item != NULL ); location: 603 cross_layer: 5 file: statem_dtls.c
if ( item == NULL )  location: 609 cross_layer: 5 file: statem_dtls.c
dtls1_hm_fragment_free ( frag ); location: 610 cross_layer: 5 file: statem_dtls.c
* ok = 0; location: 611 cross_layer: 5 file: statem_dtls.c
return i ; location: 612 cross_layer: 5 file: statem_dtls.c
------------------------------
6 @@ testCode/CVE-2016-6308_CWE-399_df6b5e29ffea2d5a3e08de92fb765fdb21c7a21e_statem_dtls.c_2.1_OLD.c @@ dtls1_retrieve_buffered_fragment @@ 506 @@ ['s->max_cert_list'] @@ {s}
static unsigned long dtls1_max_handshake_message_len(const SSL *s) location: 501 cross_layer: 1 file: statem_dtls.c
unsigned long max_len = DTLS1_HM_HEADER_LENGTH + SSL3_RT_MAX_ENCRYPTED_LENGTH ; location: 503 cross_layer: 1 file: statem_dtls.c
if ( max_len < ( unsigned long ) s -> max_cert_list )  location: 505 cross_layer: 1 file: statem_dtls.c
return s -> max_cert_list ; location: 506 cross_layer: 1 file: statem_dtls.c
if ( frag_len > dtls1_max_handshake_message_len ( s ) )  location: 665 cross_layer: 2 file: statem_dtls.c
* len = dtls1_process_out_of_seq_message ( s , & msg_hdr , & ok ); location: 784 cross_layer: 3 file: statem_dtls.c
* len = dtls1_reassemble_fragment ( s , & msg_hdr , & ok ); location: 789 cross_layer: 3 file: statem_dtls.c
static int
dtls1_reassemble_fragment(SSL *s, const struct hm_header_st *msg_hdr, int *ok) location: 511 cross_layer: 4 file: statem_dtls.c
unsigned long frag_len = msg_hdr -> frag_len ; location: 517 cross_layer: 4 file: statem_dtls.c
if ( ( msg_hdr -> frag_off + frag_len ) > msg_hdr -> msg_len || msg_hdr -> msg_len > dtls1_max_handshake_message_len ( s ) )  location: 519 cross_layer: 4 file: statem_dtls.c
if ( frag_len == 0 )  location: 523 cross_layer: 4 file: statem_dtls.c
seq64be [ 6 ] = ( unsigned char ) ( msg_hdr -> seq >> 8 ); location: 528 cross_layer: 4 file: statem_dtls.c
seq64be [ 7 ] = ( unsigned char ) msg_hdr -> seq; location: 529 cross_layer: 4 file: statem_dtls.c
item = pqueue_find ( s -> d1 -> buffered_messages , seq64be ); location: 530 cross_layer: 4 file: statem_dtls.c
if ( item == NULL )  location: 532 cross_layer: 4 file: statem_dtls.c
frag = dtls1_hm_fragment_new ( msg_hdr -> msg_len , 1 ); location: 533 cross_layer: 4 file: statem_dtls.c
if ( frag == NULL )  location: 534 cross_layer: 4 file: statem_dtls.c
memcpy ( & ( frag -> msg_header ) , msg_hdr , sizeof ( * msg_hdr ) ); location: 536 cross_layer: 4 file: statem_dtls.c
frag -> msg_header . frag_len = frag -> msg_header . msg_len; location: 537 cross_layer: 4 file: statem_dtls.c
frag -> msg_header . frag_off = 0; location: 538 cross_layer: 4 file: statem_dtls.c
frag = ( hm_fragment * ) item -> data; location: 540 cross_layer: 4 file: statem_dtls.c
if ( frag -> msg_header . msg_len != msg_hdr -> msg_len )  location: 541 cross_layer: 4 file: statem_dtls.c
if ( frag -> reassembly == NULL )  location: 553 cross_layer: 4 file: statem_dtls.c
while ( frag_len )  location: 556 cross_layer: 4 file: statem_dtls.c
i = s -> method -> ssl_read_bytes ( s , SSL3_RT_HANDSHAKE , NULL , devnull , frag_len > sizeof ( devnull ) ? sizeof ( devnull ) : frag_len , 0 ); location: 557 cross_layer: 4 file: statem_dtls.c
if ( i <= 0 )  location: 562 cross_layer: 4 file: statem_dtls.c
frag_len -= i; location: 564 cross_layer: 4 file: statem_dtls.c
i = s -> method -> ssl_read_bytes ( s , SSL3_RT_HANDSHAKE , NULL , frag -> fragment + msg_hdr -> frag_off , frag_len , 0 ); location: 570 cross_layer: 4 file: statem_dtls.c
if ( ( unsigned long ) i != frag_len )  location: 573 cross_layer: 4 file: statem_dtls.c
if ( i <= 0 )  location: 575 cross_layer: 4 file: statem_dtls.c
RSMBLY_BITMASK_MARK ( frag -> reassembly , ( long ) msg_hdr -> frag_off , ( long ) ( msg_hdr -> frag_off + frag_len ) ); location: 578 cross_layer: 4 file: statem_dtls.c
RSMBLY_BITMASK_IS_COMPLETE ( frag -> reassembly , ( long ) msg_hdr -> msg_len , is_complete ); location: 581 cross_layer: 4 file: statem_dtls.c
OPENSSL_free ( frag -> reassembly ); location: 585 cross_layer: 4 file: statem_dtls.c
frag -> reassembly = NULL; location: 586 cross_layer: 4 file: statem_dtls.c
if ( item == NULL )  location: 589 cross_layer: 4 file: statem_dtls.c
item = pitem_new ( seq64be , frag ); location: 590 cross_layer: 4 file: statem_dtls.c
if ( item == NULL )  location: 591 cross_layer: 4 file: statem_dtls.c
item = pqueue_insert ( s -> d1 -> buffered_messages , item ); location: 596 cross_layer: 4 file: statem_dtls.c
OPENSSL_assert ( item != NULL ); location: 603 cross_layer: 4 file: statem_dtls.c
if ( item == NULL )  location: 609 cross_layer: 4 file: statem_dtls.c
dtls1_hm_fragment_free ( frag ); location: 610 cross_layer: 4 file: statem_dtls.c
* ok = 0; location: 611 cross_layer: 4 file: statem_dtls.c
return i ; location: 612 cross_layer: 4 file: statem_dtls.c
ok = dtls_get_reassembled_message ( s , & tmplen ); location: 338 cross_layer: 4 file: statem_dtls.c
if ( tmplen <= 0 && ! ok )  location: 342 cross_layer: 4 file: statem_dtls.c
------------------------------
