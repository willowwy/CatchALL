1 @@ testCode/CVE-2015-0289_NVD-CWE-Other_c0334c2c92dd1bc3ad8138ba6e74006c3631b0f9_pk7_doit.c_2.1_OLD.c @@ PKCS7_dataFinal @@ 826 @@ ['btmp'] @@ {p7, bio, btmp, mdc , ctx_tmp}
int PKCS7_dataFinal(PKCS7 *p7, BIO *bio) location: 699 cross_layer: 1 file: pk7_doit.c
int i , j ; location: 702 cross_layer: 1 file: pk7_doit.c
BIO * btmp ; location: 703 cross_layer: 1 file: pk7_doit.c
EVP_MD_CTX * mdc , ctx_tmp ; location: 705 cross_layer: 1 file: pk7_doit.c
STACK_OF ( PKCS7_SIGNER_INFO ) * si_sk = NULL; location: 707 cross_layer: 1 file: pk7_doit.c
i = OBJ_obj2nid ( p7 -> type ); location: 711 cross_layer: 1 file: pk7_doit.c
p7 -> state = PKCS7_S_HEADER; location: 712 cross_layer: 1 file: pk7_doit.c
switch ( i )  location: 714 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . data; location: 716 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . signed_and_enveloped -> signer_info; location: 720 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . signed_and_enveloped -> enc_data -> enc_data; location: 721 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 722 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 723 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 724 cross_layer: 1 file: pk7_doit.c
p7 -> d . signed_and_enveloped -> enc_data -> enc_data = os; location: 728 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . enveloped -> enc_data -> enc_data; location: 733 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 734 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 735 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 736 cross_layer: 1 file: pk7_doit.c
p7 -> d . enveloped -> enc_data -> enc_data = os; location: 740 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . sign -> signer_info; location: 744 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . sign -> contents ); location: 745 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . sign -> contents ) && p7 -> detached )  location: 747 cross_layer: 1 file: pk7_doit.c
p7 -> d . sign -> contents -> d . data = NULL; location: 749 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . digest -> contents ); location: 754 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . digest -> contents ) && p7 -> detached )  location: 756 cross_layer: 1 file: pk7_doit.c
p7 -> d . digest -> contents -> d . data = NULL; location: 758 cross_layer: 1 file: pk7_doit.c
if ( si_sk != NULL )  location: 767 cross_layer: 1 file: pk7_doit.c
for (i = 0; i < sk_PKCS7_SIGNER_INFO_num(si_sk); i++) location: 768 cross_layer: 1 file: pk7_doit.c
if ( i == NID_pkcs7_digest )  location: 812 cross_layer: 1 file: pk7_doit.c
unsigned char md_data [ EVP_MAX_MD_SIZE ] ; location: 813 cross_layer: 1 file: pk7_doit.c
unsigned int md_len ; location: 814 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_find_digest ( & mdc , bio , OBJ_obj2nid ( p7 -> d . digest -> md -> algorithm ) ) )  location: 815 cross_layer: 1 file: pk7_doit.c
if ( ! EVP_DigestFinal_ex ( mdc , md_data , & md_len ) )  location: 818 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_is_detached ( p7 ) && ! ( os -> flags & ASN1_STRING_FLAG_NDEF ) )  location: 823 cross_layer: 1 file: pk7_doit.c
btmp = BIO_find_type ( bio , BIO_TYPE_MEM ); location: 826 cross_layer: 1 file: pk7_doit.c
if ( btmp == NULL )  location: 827 cross_layer: 1 file: pk7_doit.c
contlen = BIO_get_mem_data ( btmp , & cont ); location: 831 cross_layer: 1 file: pk7_doit.c
BIO_set_flags ( btmp , BIO_FLAGS_MEM_RDONLY ); location: 836 cross_layer: 1 file: pk7_doit.c
BIO_set_mem_eof_return ( btmp , 0 ); location: 837 cross_layer: 1 file: pk7_doit.c
ASN1_STRING_set0 ( os , ( unsigned char * ) cont , contlen ); location: 838 cross_layer: 1 file: pk7_doit.c
------------------------------
2 @@ testCode/CVE-2015-0289_NVD-CWE-Other_c0334c2c92dd1bc3ad8138ba6e74006c3631b0f9_pk7_doit.c_2.1_OLD.c @@ PKCS7_dataFinal @@ 831 @@ ['contlen'] @@ {p7, bio, btmp, si, mdc , ctx_tmp}
int PKCS7_dataFinal(PKCS7 *p7, BIO *bio) location: 699 cross_layer: 1 file: pk7_doit.c
int i , j ; location: 702 cross_layer: 1 file: pk7_doit.c
BIO * btmp ; location: 703 cross_layer: 1 file: pk7_doit.c
PKCS7_SIGNER_INFO * si ; location: 704 cross_layer: 1 file: pk7_doit.c
EVP_MD_CTX * mdc , ctx_tmp ; location: 705 cross_layer: 1 file: pk7_doit.c
STACK_OF ( PKCS7_SIGNER_INFO ) * si_sk = NULL; location: 707 cross_layer: 1 file: pk7_doit.c
i = OBJ_obj2nid ( p7 -> type ); location: 711 cross_layer: 1 file: pk7_doit.c
p7 -> state = PKCS7_S_HEADER; location: 712 cross_layer: 1 file: pk7_doit.c
switch ( i )  location: 714 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . data; location: 716 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . signed_and_enveloped -> signer_info; location: 720 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . signed_and_enveloped -> enc_data -> enc_data; location: 721 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 722 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 723 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 724 cross_layer: 1 file: pk7_doit.c
p7 -> d . signed_and_enveloped -> enc_data -> enc_data = os; location: 728 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . enveloped -> enc_data -> enc_data; location: 733 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 734 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 735 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 736 cross_layer: 1 file: pk7_doit.c
p7 -> d . enveloped -> enc_data -> enc_data = os; location: 740 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . sign -> signer_info; location: 744 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . sign -> contents ); location: 745 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . sign -> contents ) && p7 -> detached )  location: 747 cross_layer: 1 file: pk7_doit.c
p7 -> d . sign -> contents -> d . data = NULL; location: 749 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . digest -> contents ); location: 754 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . digest -> contents ) && p7 -> detached )  location: 756 cross_layer: 1 file: pk7_doit.c
p7 -> d . digest -> contents -> d . data = NULL; location: 758 cross_layer: 1 file: pk7_doit.c
if ( si_sk != NULL )  location: 767 cross_layer: 1 file: pk7_doit.c
for (i = 0; i < sk_PKCS7_SIGNER_INFO_num(si_sk); i++) location: 768 cross_layer: 1 file: pk7_doit.c
si = sk_PKCS7_SIGNER_INFO_value ( si_sk , i ); location: 769 cross_layer: 1 file: pk7_doit.c
if ( si -> pkey == NULL )  location: 770 cross_layer: 1 file: pk7_doit.c
j = OBJ_obj2nid ( si -> digest_alg -> algorithm ); location: 773 cross_layer: 1 file: pk7_doit.c
btmp = bio; location: 775 cross_layer: 1 file: pk7_doit.c
btmp = PKCS7_find_digest ( & mdc , btmp , j ); location: 777 cross_layer: 1 file: pk7_doit.c
if ( i == NID_pkcs7_digest )  location: 812 cross_layer: 1 file: pk7_doit.c
unsigned char md_data [ EVP_MAX_MD_SIZE ] ; location: 813 cross_layer: 1 file: pk7_doit.c
unsigned int md_len ; location: 814 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_find_digest ( & mdc , bio , OBJ_obj2nid ( p7 -> d . digest -> md -> algorithm ) ) )  location: 815 cross_layer: 1 file: pk7_doit.c
if ( ! EVP_DigestFinal_ex ( mdc , md_data , & md_len ) )  location: 818 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_is_detached ( p7 ) && ! ( os -> flags & ASN1_STRING_FLAG_NDEF ) )  location: 823 cross_layer: 1 file: pk7_doit.c
long contlen ; location: 825 cross_layer: 1 file: pk7_doit.c
btmp = BIO_find_type ( bio , BIO_TYPE_MEM ); location: 826 cross_layer: 1 file: pk7_doit.c
if ( btmp == NULL )  location: 827 cross_layer: 1 file: pk7_doit.c
contlen = BIO_get_mem_data ( btmp , & cont ); location: 831 cross_layer: 1 file: pk7_doit.c
ASN1_STRING_set0 ( os , ( unsigned char * ) cont , contlen ); location: 838 cross_layer: 1 file: pk7_doit.c
------------------------------
3 @@ testCode/CVE-2015-0289_NVD-CWE-Other_c0334c2c92dd1bc3ad8138ba6e74006c3631b0f9_pk7_doit.c_2.1_OLD.c @@ PKCS7_dataFinal @@ 838 @@ ['contlen', 'cont', 'os'] @@ {p7, bio, btmp, si, mdc , ctx_tmp, cont}
int PKCS7_dataFinal(PKCS7 *p7, BIO *bio) location: 699 cross_layer: 1 file: pk7_doit.c
int i , j ; location: 702 cross_layer: 1 file: pk7_doit.c
BIO * btmp ; location: 703 cross_layer: 1 file: pk7_doit.c
PKCS7_SIGNER_INFO * si ; location: 704 cross_layer: 1 file: pk7_doit.c
EVP_MD_CTX * mdc , ctx_tmp ; location: 705 cross_layer: 1 file: pk7_doit.c
STACK_OF ( PKCS7_SIGNER_INFO ) * si_sk = NULL; location: 707 cross_layer: 1 file: pk7_doit.c
i = OBJ_obj2nid ( p7 -> type ); location: 711 cross_layer: 1 file: pk7_doit.c
p7 -> state = PKCS7_S_HEADER; location: 712 cross_layer: 1 file: pk7_doit.c
switch ( i )  location: 714 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . data; location: 716 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . signed_and_enveloped -> signer_info; location: 720 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . signed_and_enveloped -> enc_data -> enc_data; location: 721 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 722 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 723 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 724 cross_layer: 1 file: pk7_doit.c
p7 -> d . signed_and_enveloped -> enc_data -> enc_data = os; location: 728 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . enveloped -> enc_data -> enc_data; location: 733 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 734 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 735 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 736 cross_layer: 1 file: pk7_doit.c
p7 -> d . enveloped -> enc_data -> enc_data = os; location: 740 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . sign -> signer_info; location: 744 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . sign -> contents ); location: 745 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . sign -> contents ) && p7 -> detached )  location: 747 cross_layer: 1 file: pk7_doit.c
p7 -> d . sign -> contents -> d . data = NULL; location: 749 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . digest -> contents ); location: 754 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . digest -> contents ) && p7 -> detached )  location: 756 cross_layer: 1 file: pk7_doit.c
p7 -> d . digest -> contents -> d . data = NULL; location: 758 cross_layer: 1 file: pk7_doit.c
if ( si_sk != NULL )  location: 767 cross_layer: 1 file: pk7_doit.c
for (i = 0; i < sk_PKCS7_SIGNER_INFO_num(si_sk); i++) location: 768 cross_layer: 1 file: pk7_doit.c
si = sk_PKCS7_SIGNER_INFO_value ( si_sk , i ); location: 769 cross_layer: 1 file: pk7_doit.c
if ( si -> pkey == NULL )  location: 770 cross_layer: 1 file: pk7_doit.c
j = OBJ_obj2nid ( si -> digest_alg -> algorithm ); location: 773 cross_layer: 1 file: pk7_doit.c
btmp = bio; location: 775 cross_layer: 1 file: pk7_doit.c
btmp = PKCS7_find_digest ( & mdc , btmp , j ); location: 777 cross_layer: 1 file: pk7_doit.c
if ( i == NID_pkcs7_digest )  location: 812 cross_layer: 1 file: pk7_doit.c
unsigned char md_data [ EVP_MAX_MD_SIZE ] ; location: 813 cross_layer: 1 file: pk7_doit.c
unsigned int md_len ; location: 814 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_find_digest ( & mdc , bio , OBJ_obj2nid ( p7 -> d . digest -> md -> algorithm ) ) )  location: 815 cross_layer: 1 file: pk7_doit.c
if ( ! EVP_DigestFinal_ex ( mdc , md_data , & md_len ) )  location: 818 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_is_detached ( p7 ) && ! ( os -> flags & ASN1_STRING_FLAG_NDEF ) )  location: 823 cross_layer: 1 file: pk7_doit.c
char * cont ; location: 824 cross_layer: 1 file: pk7_doit.c
long contlen ; location: 825 cross_layer: 1 file: pk7_doit.c
btmp = BIO_find_type ( bio , BIO_TYPE_MEM ); location: 826 cross_layer: 1 file: pk7_doit.c
if ( btmp == NULL )  location: 827 cross_layer: 1 file: pk7_doit.c
contlen = BIO_get_mem_data ( btmp , & cont ); location: 831 cross_layer: 1 file: pk7_doit.c
ASN1_STRING_set0 ( os , ( unsigned char * ) cont , contlen ); location: 838 cross_layer: 1 file: pk7_doit.c
------------------------------
4 @@ testCode/CVE-2015-0289_NVD-CWE-Other_c0334c2c92dd1bc3ad8138ba6e74006c3631b0f9_pk7_doit.c_2.1_OLD.c @@ PKCS7_dataFinal @@ 825 @@ ['contlen'] @@ {p7, bio, mdc , ctx_tmp}
int PKCS7_dataFinal(PKCS7 *p7, BIO *bio) location: 699 cross_layer: 1 file: pk7_doit.c
int i , j ; location: 702 cross_layer: 1 file: pk7_doit.c
EVP_MD_CTX * mdc , ctx_tmp ; location: 705 cross_layer: 1 file: pk7_doit.c
STACK_OF ( PKCS7_SIGNER_INFO ) * si_sk = NULL; location: 707 cross_layer: 1 file: pk7_doit.c
i = OBJ_obj2nid ( p7 -> type ); location: 711 cross_layer: 1 file: pk7_doit.c
p7 -> state = PKCS7_S_HEADER; location: 712 cross_layer: 1 file: pk7_doit.c
switch ( i )  location: 714 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . data; location: 716 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . signed_and_enveloped -> signer_info; location: 720 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . signed_and_enveloped -> enc_data -> enc_data; location: 721 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 722 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 723 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 724 cross_layer: 1 file: pk7_doit.c
p7 -> d . signed_and_enveloped -> enc_data -> enc_data = os; location: 728 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . enveloped -> enc_data -> enc_data; location: 733 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 734 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 735 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 736 cross_layer: 1 file: pk7_doit.c
p7 -> d . enveloped -> enc_data -> enc_data = os; location: 740 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . sign -> signer_info; location: 744 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . sign -> contents ); location: 745 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . sign -> contents ) && p7 -> detached )  location: 747 cross_layer: 1 file: pk7_doit.c
p7 -> d . sign -> contents -> d . data = NULL; location: 749 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . digest -> contents ); location: 754 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . digest -> contents ) && p7 -> detached )  location: 756 cross_layer: 1 file: pk7_doit.c
p7 -> d . digest -> contents -> d . data = NULL; location: 758 cross_layer: 1 file: pk7_doit.c
if ( si_sk != NULL )  location: 767 cross_layer: 1 file: pk7_doit.c
for (i = 0; i < sk_PKCS7_SIGNER_INFO_num(si_sk); i++) location: 768 cross_layer: 1 file: pk7_doit.c
if ( i == NID_pkcs7_digest )  location: 812 cross_layer: 1 file: pk7_doit.c
unsigned char md_data [ EVP_MAX_MD_SIZE ] ; location: 813 cross_layer: 1 file: pk7_doit.c
unsigned int md_len ; location: 814 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_find_digest ( & mdc , bio , OBJ_obj2nid ( p7 -> d . digest -> md -> algorithm ) ) )  location: 815 cross_layer: 1 file: pk7_doit.c
if ( ! EVP_DigestFinal_ex ( mdc , md_data , & md_len ) )  location: 818 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_is_detached ( p7 ) && ! ( os -> flags & ASN1_STRING_FLAG_NDEF ) )  location: 823 cross_layer: 1 file: pk7_doit.c
long contlen ; location: 825 cross_layer: 1 file: pk7_doit.c
contlen = BIO_get_mem_data ( btmp , & cont ); location: 831 cross_layer: 1 file: pk7_doit.c
ASN1_STRING_set0 ( os , ( unsigned char * ) cont , contlen ); location: 838 cross_layer: 1 file: pk7_doit.c
------------------------------
5 @@ testCode/CVE-2015-0289_NVD-CWE-Other_c0334c2c92dd1bc3ad8138ba6e74006c3631b0f9_pk7_doit.c_2.1_OLD.c @@ PKCS7_dataFinal @@ 824 @@ ['*cont'] @@ {p7, bio, mdc , ctx_tmp, cont}
int PKCS7_dataFinal(PKCS7 *p7, BIO *bio) location: 699 cross_layer: 1 file: pk7_doit.c
int i , j ; location: 702 cross_layer: 1 file: pk7_doit.c
EVP_MD_CTX * mdc , ctx_tmp ; location: 705 cross_layer: 1 file: pk7_doit.c
STACK_OF ( PKCS7_SIGNER_INFO ) * si_sk = NULL; location: 707 cross_layer: 1 file: pk7_doit.c
i = OBJ_obj2nid ( p7 -> type ); location: 711 cross_layer: 1 file: pk7_doit.c
p7 -> state = PKCS7_S_HEADER; location: 712 cross_layer: 1 file: pk7_doit.c
switch ( i )  location: 714 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . data; location: 716 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . signed_and_enveloped -> signer_info; location: 720 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . signed_and_enveloped -> enc_data -> enc_data; location: 721 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 722 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 723 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 724 cross_layer: 1 file: pk7_doit.c
p7 -> d . signed_and_enveloped -> enc_data -> enc_data = os; location: 728 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . enveloped -> enc_data -> enc_data; location: 733 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 734 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 735 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 736 cross_layer: 1 file: pk7_doit.c
p7 -> d . enveloped -> enc_data -> enc_data = os; location: 740 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . sign -> signer_info; location: 744 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . sign -> contents ); location: 745 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . sign -> contents ) && p7 -> detached )  location: 747 cross_layer: 1 file: pk7_doit.c
p7 -> d . sign -> contents -> d . data = NULL; location: 749 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . digest -> contents ); location: 754 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . digest -> contents ) && p7 -> detached )  location: 756 cross_layer: 1 file: pk7_doit.c
p7 -> d . digest -> contents -> d . data = NULL; location: 758 cross_layer: 1 file: pk7_doit.c
if ( si_sk != NULL )  location: 767 cross_layer: 1 file: pk7_doit.c
for (i = 0; i < sk_PKCS7_SIGNER_INFO_num(si_sk); i++) location: 768 cross_layer: 1 file: pk7_doit.c
if ( i == NID_pkcs7_digest )  location: 812 cross_layer: 1 file: pk7_doit.c
unsigned char md_data [ EVP_MAX_MD_SIZE ] ; location: 813 cross_layer: 1 file: pk7_doit.c
unsigned int md_len ; location: 814 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_find_digest ( & mdc , bio , OBJ_obj2nid ( p7 -> d . digest -> md -> algorithm ) ) )  location: 815 cross_layer: 1 file: pk7_doit.c
if ( ! EVP_DigestFinal_ex ( mdc , md_data , & md_len ) )  location: 818 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_is_detached ( p7 ) && ! ( os -> flags & ASN1_STRING_FLAG_NDEF ) )  location: 823 cross_layer: 1 file: pk7_doit.c
char * cont ; location: 824 cross_layer: 1 file: pk7_doit.c
ASN1_STRING_set0 ( os , ( unsigned char * ) cont , contlen ); location: 838 cross_layer: 1 file: pk7_doit.c
------------------------------
6 @@ testCode/CVE-2015-0289_NVD-CWE-Other_c0334c2c92dd1bc3ad8138ba6e74006c3631b0f9_pk7_doit.c_2.1_OLD.c @@ PKCS7_dataFinal @@ 837 @@ ['btmp'] @@ {p7, bio, btmp, si, mdc , ctx_tmp}
int PKCS7_dataFinal(PKCS7 *p7, BIO *bio) location: 699 cross_layer: 1 file: pk7_doit.c
int i , j ; location: 702 cross_layer: 1 file: pk7_doit.c
BIO * btmp ; location: 703 cross_layer: 1 file: pk7_doit.c
PKCS7_SIGNER_INFO * si ; location: 704 cross_layer: 1 file: pk7_doit.c
EVP_MD_CTX * mdc , ctx_tmp ; location: 705 cross_layer: 1 file: pk7_doit.c
STACK_OF ( PKCS7_SIGNER_INFO ) * si_sk = NULL; location: 707 cross_layer: 1 file: pk7_doit.c
i = OBJ_obj2nid ( p7 -> type ); location: 711 cross_layer: 1 file: pk7_doit.c
p7 -> state = PKCS7_S_HEADER; location: 712 cross_layer: 1 file: pk7_doit.c
switch ( i )  location: 714 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . data; location: 716 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . signed_and_enveloped -> signer_info; location: 720 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . signed_and_enveloped -> enc_data -> enc_data; location: 721 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 722 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 723 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 724 cross_layer: 1 file: pk7_doit.c
p7 -> d . signed_and_enveloped -> enc_data -> enc_data = os; location: 728 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . enveloped -> enc_data -> enc_data; location: 733 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 734 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 735 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 736 cross_layer: 1 file: pk7_doit.c
p7 -> d . enveloped -> enc_data -> enc_data = os; location: 740 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . sign -> signer_info; location: 744 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . sign -> contents ); location: 745 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . sign -> contents ) && p7 -> detached )  location: 747 cross_layer: 1 file: pk7_doit.c
p7 -> d . sign -> contents -> d . data = NULL; location: 749 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . digest -> contents ); location: 754 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . digest -> contents ) && p7 -> detached )  location: 756 cross_layer: 1 file: pk7_doit.c
p7 -> d . digest -> contents -> d . data = NULL; location: 758 cross_layer: 1 file: pk7_doit.c
if ( si_sk != NULL )  location: 767 cross_layer: 1 file: pk7_doit.c
for (i = 0; i < sk_PKCS7_SIGNER_INFO_num(si_sk); i++) location: 768 cross_layer: 1 file: pk7_doit.c
si = sk_PKCS7_SIGNER_INFO_value ( si_sk , i ); location: 769 cross_layer: 1 file: pk7_doit.c
if ( si -> pkey == NULL )  location: 770 cross_layer: 1 file: pk7_doit.c
j = OBJ_obj2nid ( si -> digest_alg -> algorithm ); location: 773 cross_layer: 1 file: pk7_doit.c
btmp = bio; location: 775 cross_layer: 1 file: pk7_doit.c
btmp = PKCS7_find_digest ( & mdc , btmp , j ); location: 777 cross_layer: 1 file: pk7_doit.c
if ( i == NID_pkcs7_digest )  location: 812 cross_layer: 1 file: pk7_doit.c
unsigned char md_data [ EVP_MAX_MD_SIZE ] ; location: 813 cross_layer: 1 file: pk7_doit.c
unsigned int md_len ; location: 814 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_find_digest ( & mdc , bio , OBJ_obj2nid ( p7 -> d . digest -> md -> algorithm ) ) )  location: 815 cross_layer: 1 file: pk7_doit.c
if ( ! EVP_DigestFinal_ex ( mdc , md_data , & md_len ) )  location: 818 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_is_detached ( p7 ) && ! ( os -> flags & ASN1_STRING_FLAG_NDEF ) )  location: 823 cross_layer: 1 file: pk7_doit.c
btmp = BIO_find_type ( bio , BIO_TYPE_MEM ); location: 826 cross_layer: 1 file: pk7_doit.c
if ( btmp == NULL )  location: 827 cross_layer: 1 file: pk7_doit.c
BIO_set_mem_eof_return ( btmp , 0 ); location: 837 cross_layer: 1 file: pk7_doit.c
ASN1_STRING_set0 ( os , ( unsigned char * ) cont , contlen ); location: 838 cross_layer: 1 file: pk7_doit.c
------------------------------
7 @@ testCode/CVE-2015-0289_NVD-CWE-Other_c0334c2c92dd1bc3ad8138ba6e74006c3631b0f9_pk7_doit.c_2.1_OLD.c @@ PKCS7_dataFinal @@ 823 @@ ['os->flags'] @@ {p7, bio, mdc , ctx_tmp}
int PKCS7_dataFinal(PKCS7 *p7, BIO *bio) location: 699 cross_layer: 1 file: pk7_doit.c
int i , j ; location: 702 cross_layer: 1 file: pk7_doit.c
EVP_MD_CTX * mdc , ctx_tmp ; location: 705 cross_layer: 1 file: pk7_doit.c
STACK_OF ( PKCS7_SIGNER_INFO ) * si_sk = NULL; location: 707 cross_layer: 1 file: pk7_doit.c
i = OBJ_obj2nid ( p7 -> type ); location: 711 cross_layer: 1 file: pk7_doit.c
p7 -> state = PKCS7_S_HEADER; location: 712 cross_layer: 1 file: pk7_doit.c
switch ( i )  location: 714 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . data; location: 716 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . signed_and_enveloped -> signer_info; location: 720 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . signed_and_enveloped -> enc_data -> enc_data; location: 721 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 722 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 723 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 724 cross_layer: 1 file: pk7_doit.c
p7 -> d . signed_and_enveloped -> enc_data -> enc_data = os; location: 728 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . enveloped -> enc_data -> enc_data; location: 733 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 734 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 735 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 736 cross_layer: 1 file: pk7_doit.c
p7 -> d . enveloped -> enc_data -> enc_data = os; location: 740 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . sign -> signer_info; location: 744 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . sign -> contents ); location: 745 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . sign -> contents ) && p7 -> detached )  location: 747 cross_layer: 1 file: pk7_doit.c
p7 -> d . sign -> contents -> d . data = NULL; location: 749 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . digest -> contents ); location: 754 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . digest -> contents ) && p7 -> detached )  location: 756 cross_layer: 1 file: pk7_doit.c
p7 -> d . digest -> contents -> d . data = NULL; location: 758 cross_layer: 1 file: pk7_doit.c
if ( si_sk != NULL )  location: 767 cross_layer: 1 file: pk7_doit.c
for (i = 0; i < sk_PKCS7_SIGNER_INFO_num(si_sk); i++) location: 768 cross_layer: 1 file: pk7_doit.c
if ( i == NID_pkcs7_digest )  location: 812 cross_layer: 1 file: pk7_doit.c
unsigned char md_data [ EVP_MAX_MD_SIZE ] ; location: 813 cross_layer: 1 file: pk7_doit.c
unsigned int md_len ; location: 814 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_find_digest ( & mdc , bio , OBJ_obj2nid ( p7 -> d . digest -> md -> algorithm ) ) )  location: 815 cross_layer: 1 file: pk7_doit.c
if ( ! EVP_DigestFinal_ex ( mdc , md_data , & md_len ) )  location: 818 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_is_detached ( p7 ) && ! ( os -> flags & ASN1_STRING_FLAG_NDEF ) )  location: 823 cross_layer: 1 file: pk7_doit.c
------------------------------
8 @@ testCode/CVE-2015-0289_NVD-CWE-Other_c0334c2c92dd1bc3ad8138ba6e74006c3631b0f9_pk7_doit.c_2.1_OLD.c @@ PKCS7_dataFinal @@ 836 @@ ['btmp'] @@ {p7, bio, btmp, si, mdc , ctx_tmp}
int PKCS7_dataFinal(PKCS7 *p7, BIO *bio) location: 699 cross_layer: 1 file: pk7_doit.c
int i , j ; location: 702 cross_layer: 1 file: pk7_doit.c
BIO * btmp ; location: 703 cross_layer: 1 file: pk7_doit.c
PKCS7_SIGNER_INFO * si ; location: 704 cross_layer: 1 file: pk7_doit.c
EVP_MD_CTX * mdc , ctx_tmp ; location: 705 cross_layer: 1 file: pk7_doit.c
STACK_OF ( PKCS7_SIGNER_INFO ) * si_sk = NULL; location: 707 cross_layer: 1 file: pk7_doit.c
i = OBJ_obj2nid ( p7 -> type ); location: 711 cross_layer: 1 file: pk7_doit.c
p7 -> state = PKCS7_S_HEADER; location: 712 cross_layer: 1 file: pk7_doit.c
switch ( i )  location: 714 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . data; location: 716 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . signed_and_enveloped -> signer_info; location: 720 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . signed_and_enveloped -> enc_data -> enc_data; location: 721 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 722 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 723 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 724 cross_layer: 1 file: pk7_doit.c
p7 -> d . signed_and_enveloped -> enc_data -> enc_data = os; location: 728 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . enveloped -> enc_data -> enc_data; location: 733 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 734 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 735 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 736 cross_layer: 1 file: pk7_doit.c
p7 -> d . enveloped -> enc_data -> enc_data = os; location: 740 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . sign -> signer_info; location: 744 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . sign -> contents ); location: 745 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . sign -> contents ) && p7 -> detached )  location: 747 cross_layer: 1 file: pk7_doit.c
p7 -> d . sign -> contents -> d . data = NULL; location: 749 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . digest -> contents ); location: 754 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . digest -> contents ) && p7 -> detached )  location: 756 cross_layer: 1 file: pk7_doit.c
p7 -> d . digest -> contents -> d . data = NULL; location: 758 cross_layer: 1 file: pk7_doit.c
if ( si_sk != NULL )  location: 767 cross_layer: 1 file: pk7_doit.c
for (i = 0; i < sk_PKCS7_SIGNER_INFO_num(si_sk); i++) location: 768 cross_layer: 1 file: pk7_doit.c
si = sk_PKCS7_SIGNER_INFO_value ( si_sk , i ); location: 769 cross_layer: 1 file: pk7_doit.c
if ( si -> pkey == NULL )  location: 770 cross_layer: 1 file: pk7_doit.c
j = OBJ_obj2nid ( si -> digest_alg -> algorithm ); location: 773 cross_layer: 1 file: pk7_doit.c
btmp = bio; location: 775 cross_layer: 1 file: pk7_doit.c
btmp = PKCS7_find_digest ( & mdc , btmp , j ); location: 777 cross_layer: 1 file: pk7_doit.c
if ( i == NID_pkcs7_digest )  location: 812 cross_layer: 1 file: pk7_doit.c
unsigned char md_data [ EVP_MAX_MD_SIZE ] ; location: 813 cross_layer: 1 file: pk7_doit.c
unsigned int md_len ; location: 814 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_find_digest ( & mdc , bio , OBJ_obj2nid ( p7 -> d . digest -> md -> algorithm ) ) )  location: 815 cross_layer: 1 file: pk7_doit.c
if ( ! EVP_DigestFinal_ex ( mdc , md_data , & md_len ) )  location: 818 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_is_detached ( p7 ) && ! ( os -> flags & ASN1_STRING_FLAG_NDEF ) )  location: 823 cross_layer: 1 file: pk7_doit.c
btmp = BIO_find_type ( bio , BIO_TYPE_MEM ); location: 826 cross_layer: 1 file: pk7_doit.c
if ( btmp == NULL )  location: 827 cross_layer: 1 file: pk7_doit.c
BIO_set_flags ( btmp , BIO_FLAGS_MEM_RDONLY ); location: 836 cross_layer: 1 file: pk7_doit.c
BIO_set_mem_eof_return ( btmp , 0 ); location: 837 cross_layer: 1 file: pk7_doit.c
ASN1_STRING_set0 ( os , ( unsigned char * ) cont , contlen ); location: 838 cross_layer: 1 file: pk7_doit.c
------------------------------
9 @@ testCode/CVE-2015-0289_NVD-CWE-Other_c0334c2c92dd1bc3ad8138ba6e74006c3631b0f9_pk7_doit.c_2.1_OLD.c @@ PKCS7_dataFinal @@ 827 @@ ['btmp'] @@ {p7, bio, btmp, si, mdc , ctx_tmp}
int PKCS7_dataFinal(PKCS7 *p7, BIO *bio) location: 699 cross_layer: 1 file: pk7_doit.c
int i , j ; location: 702 cross_layer: 1 file: pk7_doit.c
BIO * btmp ; location: 703 cross_layer: 1 file: pk7_doit.c
PKCS7_SIGNER_INFO * si ; location: 704 cross_layer: 1 file: pk7_doit.c
EVP_MD_CTX * mdc , ctx_tmp ; location: 705 cross_layer: 1 file: pk7_doit.c
STACK_OF ( PKCS7_SIGNER_INFO ) * si_sk = NULL; location: 707 cross_layer: 1 file: pk7_doit.c
i = OBJ_obj2nid ( p7 -> type ); location: 711 cross_layer: 1 file: pk7_doit.c
p7 -> state = PKCS7_S_HEADER; location: 712 cross_layer: 1 file: pk7_doit.c
switch ( i )  location: 714 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . data; location: 716 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . signed_and_enveloped -> signer_info; location: 720 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . signed_and_enveloped -> enc_data -> enc_data; location: 721 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 722 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 723 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 724 cross_layer: 1 file: pk7_doit.c
p7 -> d . signed_and_enveloped -> enc_data -> enc_data = os; location: 728 cross_layer: 1 file: pk7_doit.c
os = p7 -> d . enveloped -> enc_data -> enc_data; location: 733 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 734 cross_layer: 1 file: pk7_doit.c
os = M_ASN1_OCTET_STRING_new ( ); location: 735 cross_layer: 1 file: pk7_doit.c
if ( ! os )  location: 736 cross_layer: 1 file: pk7_doit.c
p7 -> d . enveloped -> enc_data -> enc_data = os; location: 740 cross_layer: 1 file: pk7_doit.c
si_sk = p7 -> d . sign -> signer_info; location: 744 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . sign -> contents ); location: 745 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . sign -> contents ) && p7 -> detached )  location: 747 cross_layer: 1 file: pk7_doit.c
p7 -> d . sign -> contents -> d . data = NULL; location: 749 cross_layer: 1 file: pk7_doit.c
os = PKCS7_get_octet_string ( p7 -> d . digest -> contents ); location: 754 cross_layer: 1 file: pk7_doit.c
if ( PKCS7_type_is_data ( p7 -> d . digest -> contents ) && p7 -> detached )  location: 756 cross_layer: 1 file: pk7_doit.c
p7 -> d . digest -> contents -> d . data = NULL; location: 758 cross_layer: 1 file: pk7_doit.c
if ( si_sk != NULL )  location: 767 cross_layer: 1 file: pk7_doit.c
for (i = 0; i < sk_PKCS7_SIGNER_INFO_num(si_sk); i++) location: 768 cross_layer: 1 file: pk7_doit.c
si = sk_PKCS7_SIGNER_INFO_value ( si_sk , i ); location: 769 cross_layer: 1 file: pk7_doit.c
if ( si -> pkey == NULL )  location: 770 cross_layer: 1 file: pk7_doit.c
j = OBJ_obj2nid ( si -> digest_alg -> algorithm ); location: 773 cross_layer: 1 file: pk7_doit.c
btmp = bio; location: 775 cross_layer: 1 file: pk7_doit.c
btmp = PKCS7_find_digest ( & mdc , btmp , j ); location: 777 cross_layer: 1 file: pk7_doit.c
if ( i == NID_pkcs7_digest )  location: 812 cross_layer: 1 file: pk7_doit.c
unsigned char md_data [ EVP_MAX_MD_SIZE ] ; location: 813 cross_layer: 1 file: pk7_doit.c
unsigned int md_len ; location: 814 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_find_digest ( & mdc , bio , OBJ_obj2nid ( p7 -> d . digest -> md -> algorithm ) ) )  location: 815 cross_layer: 1 file: pk7_doit.c
if ( ! EVP_DigestFinal_ex ( mdc , md_data , & md_len ) )  location: 818 cross_layer: 1 file: pk7_doit.c
if ( ! PKCS7_is_detached ( p7 ) && ! ( os -> flags & ASN1_STRING_FLAG_NDEF ) )  location: 823 cross_layer: 1 file: pk7_doit.c
btmp = BIO_find_type ( bio , BIO_TYPE_MEM ); location: 826 cross_layer: 1 file: pk7_doit.c
if ( btmp == NULL )  location: 827 cross_layer: 1 file: pk7_doit.c
contlen = BIO_get_mem_data ( btmp , & cont ); location: 831 cross_layer: 1 file: pk7_doit.c
BIO_set_flags ( btmp , BIO_FLAGS_MEM_RDONLY ); location: 836 cross_layer: 1 file: pk7_doit.c
BIO_set_mem_eof_return ( btmp , 0 ); location: 837 cross_layer: 1 file: pk7_doit.c
ASN1_STRING_set0 ( os , ( unsigned char * ) cont , contlen ); location: 838 cross_layer: 1 file: pk7_doit.c
------------------------------
