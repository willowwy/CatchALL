1 @@ testCode/CVE-2016-2176_CWE-119_2919516136a4227d9e6d8f2fe66ef976aaf8c561_x509_obj.c_1.1_OLD.c @@ *X509_NAME_oneline @@ 133 @@ ['q', 'num', 'sizeof', 'ebcdic_buf'] @@ {a, buf, ne, q}
char *X509_NAME_oneline(X509_NAME *a, char *buf, int len) location: 73 cross_layer: 1 file: x509_obj.c
X509_NAME_ENTRY * ne ; location: 75 cross_layer: 1 file: x509_obj.c
int i ; location: 76 cross_layer: 1 file: x509_obj.c
int n , lold , l , l1 , l2 , num , j , type ; location: 77 cross_layer: 1 file: x509_obj.c
unsigned char * q ; location: 80 cross_layer: 1 file: x509_obj.c
char ebcdic_buf [ 1024 ] ; location: 86 cross_layer: 1 file: x509_obj.c
if ( buf == NULL )  location: 89 cross_layer: 1 file: x509_obj.c
if ( ( b = BUF_MEM_new ( ) ) == NULL )  location: 90 cross_layer: 1 file: x509_obj.c
if ( ! BUF_MEM_grow ( b , 200 ) )  location: 92 cross_layer: 1 file: x509_obj.c
if ( len == 0 )  location: 96 cross_layer: 1 file: x509_obj.c
if ( a == NULL )  location: 99 cross_layer: 1 file: x509_obj.c
for (i = 0; i < sk_X509_NAME_ENTRY_num(a->entries); i++) location: 111 cross_layer: 1 file: x509_obj.c
ne = sk_X509_NAME_ENTRY_value ( a -> entries , i ); location: 112 cross_layer: 1 file: x509_obj.c
type = ne -> value -> type; location: 120 cross_layer: 1 file: x509_obj.c
num = ne -> value -> length; location: 121 cross_layer: 1 file: x509_obj.c
if ( num > NAME_ONELINE_MAX )  location: 122 cross_layer: 1 file: x509_obj.c
q = ne -> value -> data; location: 126 cross_layer: 1 file: x509_obj.c
if ( type == V_ASN1_GENERALSTRING || type == V_ASN1_VISIBLESTRING || type == V_ASN1_PRINTABLESTRING || type == V_ASN1_TELETEXSTRING || type == V_ASN1_VISIBLESTRING || type == V_ASN1_IA5STRING )  location: 128 cross_layer: 1 file: x509_obj.c
ascii2ebcdic ( ebcdic_buf , q , ( num > sizeof ebcdic_buf ) ? sizeof ebcdic_buf : num ); location: 133 cross_layer: 1 file: x509_obj.c
q = ebcdic_buf; location: 135 cross_layer: 1 file: x509_obj.c
if ( q [ j ] != 0 )  location: 142 cross_layer: 1 file: x509_obj.c
if ( ( q [ j ] < ' ' ) || ( q [ j ] > '~' ) )  location: 159 cross_layer: 1 file: x509_obj.c
q = ne -> value -> data; location: 188 cross_layer: 1 file: x509_obj.c
n = q [ j ]; location: 195 cross_layer: 1 file: x509_obj.c
if ( ( n < ' ' ) || ( n > '~' ) )  location: 196 cross_layer: 1 file: x509_obj.c
* ( p ++ ) = hex [ ( n >> 4 ) & 0x0f ]; location: 199 cross_layer: 1 file: x509_obj.c
* ( p ++ ) = hex [ n & 0x0f ]; location: 200 cross_layer: 1 file: x509_obj.c
* ( p ++ ) = n; location: 202 cross_layer: 1 file: x509_obj.c
* p = '\0'; location: 214 cross_layer: 1 file: x509_obj.c
* p = '\0'; location: 222 cross_layer: 1 file: x509_obj.c
return ( p ) ; location: 223 cross_layer: 1 file: x509_obj.c
------------------------------
