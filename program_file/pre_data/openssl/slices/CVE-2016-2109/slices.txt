1 @@ testCode/CVE-2016-2109_CWE-399_c62981390d6cf9e3d612c489b8b77c2913b25807_a_d2i_fp.c_OLD.c @@ asn1_d2i_read_bio @@ 231 @@ ['i'] @@ {in, b, p, q}
static int asn1_d2i_read_bio(BIO *in, BUF_MEM **pb) location: 141 cross_layer: 1 file: a_d2i_fp.c
BUF_MEM * b ; location: 143 cross_layer: 1 file: a_d2i_fp.c
unsigned char * p ; location: 144 cross_layer: 1 file: a_d2i_fp.c
int i ; location: 145 cross_layer: 1 file: a_d2i_fp.c
size_t want = HEADER_SIZE ; location: 146 cross_layer: 1 file: a_d2i_fp.c
int eos = 0 ; location: 147 cross_layer: 1 file: a_d2i_fp.c
size_t off = 0 ; location: 148 cross_layer: 1 file: a_d2i_fp.c
size_t len = 0 ; location: 149 cross_layer: 1 file: a_d2i_fp.c
const unsigned char * q ; location: 151 cross_layer: 1 file: a_d2i_fp.c
long slen ; location: 152 cross_layer: 1 file: a_d2i_fp.c
int inf , tag , xclass ; location: 153 cross_layer: 1 file: a_d2i_fp.c
b = BUF_MEM_new ( ); location: 155 cross_layer: 1 file: a_d2i_fp.c
if ( want >= ( len - off ) )  location: 163 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 164 cross_layer: 1 file: a_d2i_fp.c
if ( len + want < len || ! BUF_MEM_grow_clean ( b , len + want ) )  location: 166 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 170 cross_layer: 1 file: a_d2i_fp.c
if ( ( i < 0 ) && ( ( len - off ) == 0 ) )  location: 171 cross_layer: 1 file: a_d2i_fp.c
if ( i > 0 )  location: 175 cross_layer: 1 file: a_d2i_fp.c
if ( len + i < len )  location: 176 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 180 cross_layer: 1 file: a_d2i_fp.c
p = ( unsigned char * ) & ( b -> data [ off ] ); location: 185 cross_layer: 1 file: a_d2i_fp.c
q = p; location: 186 cross_layer: 1 file: a_d2i_fp.c
inf = ASN1_get_object ( & q , & slen , & tag , & xclass , len - off ); location: 187 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 0x80 )  location: 188 cross_layer: 1 file: a_d2i_fp.c
unsigned long e ; location: 189 cross_layer: 1 file: a_d2i_fp.c
e = ERR_GET_REASON ( ERR_peek_error ( ) ); location: 191 cross_layer: 1 file: a_d2i_fp.c
if ( e != ASN1_R_TOO_LONG )  location: 192 cross_layer: 1 file: a_d2i_fp.c
i = q - p; location: 197 cross_layer: 1 file: a_d2i_fp.c
off += i; location: 198 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 1 )  location: 200 cross_layer: 1 file: a_d2i_fp.c
eos ++; location: 202 cross_layer: 1 file: a_d2i_fp.c
if ( eos && ( slen == 0 ) && ( tag == V_ASN1_EOC ) )  location: 208 cross_layer: 1 file: a_d2i_fp.c
want = slen; location: 217 cross_layer: 1 file: a_d2i_fp.c
if ( want > ( len - off ) )  location: 218 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 219 cross_layer: 1 file: a_d2i_fp.c
if ( want > INT_MAX || len + want < len )  location: 220 cross_layer: 1 file: a_d2i_fp.c
if ( ! BUF_MEM_grow_clean ( b , len + want ) )  location: 225 cross_layer: 1 file: a_d2i_fp.c
while ( want > 0 )  location: 229 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 230 cross_layer: 1 file: a_d2i_fp.c
if ( i <= 0 )  location: 231 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 240 cross_layer: 1 file: a_d2i_fp.c
want -= i; location: 241 cross_layer: 1 file: a_d2i_fp.c
if ( off + slen < off )  location: 244 cross_layer: 1 file: a_d2i_fp.c
off += slen; location: 248 cross_layer: 1 file: a_d2i_fp.c
if ( off > INT_MAX )  location: 256 cross_layer: 1 file: a_d2i_fp.c
return off ; location: 262 cross_layer: 1 file: a_d2i_fp.c
len = asn1_d2i_read_bio ( in , & b ); location: 92 cross_layer: 2 file: a_d2i_fp.c
if ( len < 0 )  location: 93 cross_layer: 2 file: a_d2i_fp.c
ret = d2i ( x , & p , len ); location: 97 cross_layer: 2 file: a_d2i_fp.c
return ( ret ) ; location: 100 cross_layer: 2 file: a_d2i_fp.c
ret = ASN1_d2i_bio ( xnew , d2i , b , x ); location: 79 cross_layer: 3 file: a_d2i_fp.c
return ( ret ) ; location: 81 cross_layer: 3 file: a_d2i_fp.c
------------------------------
2 @@ testCode/CVE-2016-2109_CWE-399_c62981390d6cf9e3d612c489b8b77c2913b25807_a_d2i_fp.c_OLD.c @@ asn1_d2i_read_bio @@ 231 @@ ['i'] @@ {in, b, p, q}
static int asn1_d2i_read_bio(BIO *in, BUF_MEM **pb) location: 141 cross_layer: 1 file: a_d2i_fp.c
BUF_MEM * b ; location: 143 cross_layer: 1 file: a_d2i_fp.c
unsigned char * p ; location: 144 cross_layer: 1 file: a_d2i_fp.c
int i ; location: 145 cross_layer: 1 file: a_d2i_fp.c
size_t want = HEADER_SIZE ; location: 146 cross_layer: 1 file: a_d2i_fp.c
int eos = 0 ; location: 147 cross_layer: 1 file: a_d2i_fp.c
size_t off = 0 ; location: 148 cross_layer: 1 file: a_d2i_fp.c
size_t len = 0 ; location: 149 cross_layer: 1 file: a_d2i_fp.c
const unsigned char * q ; location: 151 cross_layer: 1 file: a_d2i_fp.c
long slen ; location: 152 cross_layer: 1 file: a_d2i_fp.c
int inf , tag , xclass ; location: 153 cross_layer: 1 file: a_d2i_fp.c
b = BUF_MEM_new ( ); location: 155 cross_layer: 1 file: a_d2i_fp.c
if ( want >= ( len - off ) )  location: 163 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 164 cross_layer: 1 file: a_d2i_fp.c
if ( len + want < len || ! BUF_MEM_grow_clean ( b , len + want ) )  location: 166 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 170 cross_layer: 1 file: a_d2i_fp.c
if ( ( i < 0 ) && ( ( len - off ) == 0 ) )  location: 171 cross_layer: 1 file: a_d2i_fp.c
if ( i > 0 )  location: 175 cross_layer: 1 file: a_d2i_fp.c
if ( len + i < len )  location: 176 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 180 cross_layer: 1 file: a_d2i_fp.c
p = ( unsigned char * ) & ( b -> data [ off ] ); location: 185 cross_layer: 1 file: a_d2i_fp.c
q = p; location: 186 cross_layer: 1 file: a_d2i_fp.c
inf = ASN1_get_object ( & q , & slen , & tag , & xclass , len - off ); location: 187 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 0x80 )  location: 188 cross_layer: 1 file: a_d2i_fp.c
unsigned long e ; location: 189 cross_layer: 1 file: a_d2i_fp.c
e = ERR_GET_REASON ( ERR_peek_error ( ) ); location: 191 cross_layer: 1 file: a_d2i_fp.c
if ( e != ASN1_R_TOO_LONG )  location: 192 cross_layer: 1 file: a_d2i_fp.c
i = q - p; location: 197 cross_layer: 1 file: a_d2i_fp.c
off += i; location: 198 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 1 )  location: 200 cross_layer: 1 file: a_d2i_fp.c
eos ++; location: 202 cross_layer: 1 file: a_d2i_fp.c
if ( eos && ( slen == 0 ) && ( tag == V_ASN1_EOC ) )  location: 208 cross_layer: 1 file: a_d2i_fp.c
want = slen; location: 217 cross_layer: 1 file: a_d2i_fp.c
if ( want > ( len - off ) )  location: 218 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 219 cross_layer: 1 file: a_d2i_fp.c
if ( want > INT_MAX || len + want < len )  location: 220 cross_layer: 1 file: a_d2i_fp.c
if ( ! BUF_MEM_grow_clean ( b , len + want ) )  location: 225 cross_layer: 1 file: a_d2i_fp.c
while ( want > 0 )  location: 229 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 230 cross_layer: 1 file: a_d2i_fp.c
if ( i <= 0 )  location: 231 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 240 cross_layer: 1 file: a_d2i_fp.c
want -= i; location: 241 cross_layer: 1 file: a_d2i_fp.c
if ( off + slen < off )  location: 244 cross_layer: 1 file: a_d2i_fp.c
off += slen; location: 248 cross_layer: 1 file: a_d2i_fp.c
if ( off > INT_MAX )  location: 256 cross_layer: 1 file: a_d2i_fp.c
return off ; location: 262 cross_layer: 1 file: a_d2i_fp.c
len = asn1_d2i_read_bio ( in , & b ); location: 112 cross_layer: 2 file: a_d2i_fp.c
if ( len < 0 )  location: 113 cross_layer: 2 file: a_d2i_fp.c
ret = ASN1_item_d2i ( x , & p , len , it ); location: 117 cross_layer: 2 file: a_d2i_fp.c
return ( ret ) ; location: 120 cross_layer: 2 file: a_d2i_fp.c
ret = ASN1_item_d2i_bio ( it , b , x ); location: 134 cross_layer: 3 file: a_d2i_fp.c
return ( ret ) ; location: 136 cross_layer: 3 file: a_d2i_fp.c
------------------------------
3 @@ testCode/CVE-2016-2109_CWE-399_c62981390d6cf9e3d612c489b8b77c2913b25807_a_d2i_fp.c_OLD.c @@ asn1_d2i_read_bio @@ 241 @@ ['want'] @@ {in, b, p, q}
static int asn1_d2i_read_bio(BIO *in, BUF_MEM **pb) location: 141 cross_layer: 1 file: a_d2i_fp.c
BUF_MEM * b ; location: 143 cross_layer: 1 file: a_d2i_fp.c
unsigned char * p ; location: 144 cross_layer: 1 file: a_d2i_fp.c
int i ; location: 145 cross_layer: 1 file: a_d2i_fp.c
size_t want = HEADER_SIZE ; location: 146 cross_layer: 1 file: a_d2i_fp.c
int eos = 0 ; location: 147 cross_layer: 1 file: a_d2i_fp.c
size_t off = 0 ; location: 148 cross_layer: 1 file: a_d2i_fp.c
size_t len = 0 ; location: 149 cross_layer: 1 file: a_d2i_fp.c
const unsigned char * q ; location: 151 cross_layer: 1 file: a_d2i_fp.c
long slen ; location: 152 cross_layer: 1 file: a_d2i_fp.c
int inf , tag , xclass ; location: 153 cross_layer: 1 file: a_d2i_fp.c
b = BUF_MEM_new ( ); location: 155 cross_layer: 1 file: a_d2i_fp.c
if ( want >= ( len - off ) )  location: 163 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 164 cross_layer: 1 file: a_d2i_fp.c
if ( len + want < len || ! BUF_MEM_grow_clean ( b , len + want ) )  location: 166 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 170 cross_layer: 1 file: a_d2i_fp.c
if ( ( i < 0 ) && ( ( len - off ) == 0 ) )  location: 171 cross_layer: 1 file: a_d2i_fp.c
if ( i > 0 )  location: 175 cross_layer: 1 file: a_d2i_fp.c
if ( len + i < len )  location: 176 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 180 cross_layer: 1 file: a_d2i_fp.c
p = ( unsigned char * ) & ( b -> data [ off ] ); location: 185 cross_layer: 1 file: a_d2i_fp.c
q = p; location: 186 cross_layer: 1 file: a_d2i_fp.c
inf = ASN1_get_object ( & q , & slen , & tag , & xclass , len - off ); location: 187 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 0x80 )  location: 188 cross_layer: 1 file: a_d2i_fp.c
unsigned long e ; location: 189 cross_layer: 1 file: a_d2i_fp.c
e = ERR_GET_REASON ( ERR_peek_error ( ) ); location: 191 cross_layer: 1 file: a_d2i_fp.c
if ( e != ASN1_R_TOO_LONG )  location: 192 cross_layer: 1 file: a_d2i_fp.c
i = q - p; location: 197 cross_layer: 1 file: a_d2i_fp.c
off += i; location: 198 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 1 )  location: 200 cross_layer: 1 file: a_d2i_fp.c
eos ++; location: 202 cross_layer: 1 file: a_d2i_fp.c
if ( eos && ( slen == 0 ) && ( tag == V_ASN1_EOC ) )  location: 208 cross_layer: 1 file: a_d2i_fp.c
want = slen; location: 217 cross_layer: 1 file: a_d2i_fp.c
if ( want > ( len - off ) )  location: 218 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 219 cross_layer: 1 file: a_d2i_fp.c
if ( want > INT_MAX || len + want < len )  location: 220 cross_layer: 1 file: a_d2i_fp.c
if ( ! BUF_MEM_grow_clean ( b , len + want ) )  location: 225 cross_layer: 1 file: a_d2i_fp.c
while ( want > 0 )  location: 229 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 230 cross_layer: 1 file: a_d2i_fp.c
if ( i <= 0 )  location: 231 cross_layer: 1 file: a_d2i_fp.c
want -= i; location: 241 cross_layer: 1 file: a_d2i_fp.c
len = asn1_d2i_read_bio ( in , & b ); location: 92 cross_layer: 2 file: a_d2i_fp.c
if ( len < 0 )  location: 93 cross_layer: 2 file: a_d2i_fp.c
ret = d2i ( x , & p , len ); location: 97 cross_layer: 2 file: a_d2i_fp.c
return ( ret ) ; location: 100 cross_layer: 2 file: a_d2i_fp.c
ret = ASN1_d2i_bio ( xnew , d2i , b , x ); location: 79 cross_layer: 3 file: a_d2i_fp.c
return ( ret ) ; location: 81 cross_layer: 3 file: a_d2i_fp.c
------------------------------
4 @@ testCode/CVE-2016-2109_CWE-399_c62981390d6cf9e3d612c489b8b77c2913b25807_a_d2i_fp.c_OLD.c @@ asn1_d2i_read_bio @@ 241 @@ ['want'] @@ {in, b, p, q}
static int asn1_d2i_read_bio(BIO *in, BUF_MEM **pb) location: 141 cross_layer: 1 file: a_d2i_fp.c
BUF_MEM * b ; location: 143 cross_layer: 1 file: a_d2i_fp.c
unsigned char * p ; location: 144 cross_layer: 1 file: a_d2i_fp.c
int i ; location: 145 cross_layer: 1 file: a_d2i_fp.c
size_t want = HEADER_SIZE ; location: 146 cross_layer: 1 file: a_d2i_fp.c
int eos = 0 ; location: 147 cross_layer: 1 file: a_d2i_fp.c
size_t off = 0 ; location: 148 cross_layer: 1 file: a_d2i_fp.c
size_t len = 0 ; location: 149 cross_layer: 1 file: a_d2i_fp.c
const unsigned char * q ; location: 151 cross_layer: 1 file: a_d2i_fp.c
long slen ; location: 152 cross_layer: 1 file: a_d2i_fp.c
int inf , tag , xclass ; location: 153 cross_layer: 1 file: a_d2i_fp.c
b = BUF_MEM_new ( ); location: 155 cross_layer: 1 file: a_d2i_fp.c
if ( want >= ( len - off ) )  location: 163 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 164 cross_layer: 1 file: a_d2i_fp.c
if ( len + want < len || ! BUF_MEM_grow_clean ( b , len + want ) )  location: 166 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 170 cross_layer: 1 file: a_d2i_fp.c
if ( ( i < 0 ) && ( ( len - off ) == 0 ) )  location: 171 cross_layer: 1 file: a_d2i_fp.c
if ( i > 0 )  location: 175 cross_layer: 1 file: a_d2i_fp.c
if ( len + i < len )  location: 176 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 180 cross_layer: 1 file: a_d2i_fp.c
p = ( unsigned char * ) & ( b -> data [ off ] ); location: 185 cross_layer: 1 file: a_d2i_fp.c
q = p; location: 186 cross_layer: 1 file: a_d2i_fp.c
inf = ASN1_get_object ( & q , & slen , & tag , & xclass , len - off ); location: 187 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 0x80 )  location: 188 cross_layer: 1 file: a_d2i_fp.c
unsigned long e ; location: 189 cross_layer: 1 file: a_d2i_fp.c
e = ERR_GET_REASON ( ERR_peek_error ( ) ); location: 191 cross_layer: 1 file: a_d2i_fp.c
if ( e != ASN1_R_TOO_LONG )  location: 192 cross_layer: 1 file: a_d2i_fp.c
i = q - p; location: 197 cross_layer: 1 file: a_d2i_fp.c
off += i; location: 198 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 1 )  location: 200 cross_layer: 1 file: a_d2i_fp.c
eos ++; location: 202 cross_layer: 1 file: a_d2i_fp.c
if ( eos && ( slen == 0 ) && ( tag == V_ASN1_EOC ) )  location: 208 cross_layer: 1 file: a_d2i_fp.c
want = slen; location: 217 cross_layer: 1 file: a_d2i_fp.c
if ( want > ( len - off ) )  location: 218 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 219 cross_layer: 1 file: a_d2i_fp.c
if ( want > INT_MAX || len + want < len )  location: 220 cross_layer: 1 file: a_d2i_fp.c
if ( ! BUF_MEM_grow_clean ( b , len + want ) )  location: 225 cross_layer: 1 file: a_d2i_fp.c
while ( want > 0 )  location: 229 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 230 cross_layer: 1 file: a_d2i_fp.c
if ( i <= 0 )  location: 231 cross_layer: 1 file: a_d2i_fp.c
want -= i; location: 241 cross_layer: 1 file: a_d2i_fp.c
len = asn1_d2i_read_bio ( in , & b ); location: 112 cross_layer: 2 file: a_d2i_fp.c
if ( len < 0 )  location: 113 cross_layer: 2 file: a_d2i_fp.c
ret = ASN1_item_d2i ( x , & p , len , it ); location: 117 cross_layer: 2 file: a_d2i_fp.c
return ( ret ) ; location: 120 cross_layer: 2 file: a_d2i_fp.c
ret = ASN1_item_d2i_bio ( it , b , x ); location: 134 cross_layer: 3 file: a_d2i_fp.c
return ( ret ) ; location: 136 cross_layer: 3 file: a_d2i_fp.c
------------------------------
5 @@ testCode/CVE-2016-2109_CWE-399_c62981390d6cf9e3d612c489b8b77c2913b25807_a_d2i_fp.c_OLD.c @@ asn1_d2i_read_bio @@ 230 @@ ['i'] @@ {in, b, p, q}
static int asn1_d2i_read_bio(BIO *in, BUF_MEM **pb) location: 141 cross_layer: 1 file: a_d2i_fp.c
BUF_MEM * b ; location: 143 cross_layer: 1 file: a_d2i_fp.c
unsigned char * p ; location: 144 cross_layer: 1 file: a_d2i_fp.c
int i ; location: 145 cross_layer: 1 file: a_d2i_fp.c
size_t want = HEADER_SIZE ; location: 146 cross_layer: 1 file: a_d2i_fp.c
int eos = 0 ; location: 147 cross_layer: 1 file: a_d2i_fp.c
size_t off = 0 ; location: 148 cross_layer: 1 file: a_d2i_fp.c
size_t len = 0 ; location: 149 cross_layer: 1 file: a_d2i_fp.c
const unsigned char * q ; location: 151 cross_layer: 1 file: a_d2i_fp.c
long slen ; location: 152 cross_layer: 1 file: a_d2i_fp.c
int inf , tag , xclass ; location: 153 cross_layer: 1 file: a_d2i_fp.c
b = BUF_MEM_new ( ); location: 155 cross_layer: 1 file: a_d2i_fp.c
if ( want >= ( len - off ) )  location: 163 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 164 cross_layer: 1 file: a_d2i_fp.c
if ( len + want < len || ! BUF_MEM_grow_clean ( b , len + want ) )  location: 166 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 170 cross_layer: 1 file: a_d2i_fp.c
if ( ( i < 0 ) && ( ( len - off ) == 0 ) )  location: 171 cross_layer: 1 file: a_d2i_fp.c
if ( i > 0 )  location: 175 cross_layer: 1 file: a_d2i_fp.c
if ( len + i < len )  location: 176 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 180 cross_layer: 1 file: a_d2i_fp.c
p = ( unsigned char * ) & ( b -> data [ off ] ); location: 185 cross_layer: 1 file: a_d2i_fp.c
q = p; location: 186 cross_layer: 1 file: a_d2i_fp.c
inf = ASN1_get_object ( & q , & slen , & tag , & xclass , len - off ); location: 187 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 0x80 )  location: 188 cross_layer: 1 file: a_d2i_fp.c
unsigned long e ; location: 189 cross_layer: 1 file: a_d2i_fp.c
e = ERR_GET_REASON ( ERR_peek_error ( ) ); location: 191 cross_layer: 1 file: a_d2i_fp.c
if ( e != ASN1_R_TOO_LONG )  location: 192 cross_layer: 1 file: a_d2i_fp.c
i = q - p; location: 197 cross_layer: 1 file: a_d2i_fp.c
off += i; location: 198 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 1 )  location: 200 cross_layer: 1 file: a_d2i_fp.c
eos ++; location: 202 cross_layer: 1 file: a_d2i_fp.c
if ( eos && ( slen == 0 ) && ( tag == V_ASN1_EOC ) )  location: 208 cross_layer: 1 file: a_d2i_fp.c
want = slen; location: 217 cross_layer: 1 file: a_d2i_fp.c
if ( want > ( len - off ) )  location: 218 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 219 cross_layer: 1 file: a_d2i_fp.c
if ( want > INT_MAX || len + want < len )  location: 220 cross_layer: 1 file: a_d2i_fp.c
if ( ! BUF_MEM_grow_clean ( b , len + want ) )  location: 225 cross_layer: 1 file: a_d2i_fp.c
while ( want > 0 )  location: 229 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 230 cross_layer: 1 file: a_d2i_fp.c
if ( i <= 0 )  location: 231 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 240 cross_layer: 1 file: a_d2i_fp.c
want -= i; location: 241 cross_layer: 1 file: a_d2i_fp.c
len = asn1_d2i_read_bio ( in , & b ); location: 92 cross_layer: 2 file: a_d2i_fp.c
if ( len < 0 )  location: 93 cross_layer: 2 file: a_d2i_fp.c
ret = d2i ( x , & p , len ); location: 97 cross_layer: 2 file: a_d2i_fp.c
return ( ret ) ; location: 100 cross_layer: 2 file: a_d2i_fp.c
ret = ASN1_d2i_bio ( xnew , d2i , b , x ); location: 79 cross_layer: 3 file: a_d2i_fp.c
return ( ret ) ; location: 81 cross_layer: 3 file: a_d2i_fp.c
------------------------------
6 @@ testCode/CVE-2016-2109_CWE-399_c62981390d6cf9e3d612c489b8b77c2913b25807_a_d2i_fp.c_OLD.c @@ asn1_d2i_read_bio @@ 230 @@ ['i'] @@ {in, b, p, q}
static int asn1_d2i_read_bio(BIO *in, BUF_MEM **pb) location: 141 cross_layer: 1 file: a_d2i_fp.c
BUF_MEM * b ; location: 143 cross_layer: 1 file: a_d2i_fp.c
unsigned char * p ; location: 144 cross_layer: 1 file: a_d2i_fp.c
int i ; location: 145 cross_layer: 1 file: a_d2i_fp.c
size_t want = HEADER_SIZE ; location: 146 cross_layer: 1 file: a_d2i_fp.c
int eos = 0 ; location: 147 cross_layer: 1 file: a_d2i_fp.c
size_t off = 0 ; location: 148 cross_layer: 1 file: a_d2i_fp.c
size_t len = 0 ; location: 149 cross_layer: 1 file: a_d2i_fp.c
const unsigned char * q ; location: 151 cross_layer: 1 file: a_d2i_fp.c
long slen ; location: 152 cross_layer: 1 file: a_d2i_fp.c
int inf , tag , xclass ; location: 153 cross_layer: 1 file: a_d2i_fp.c
b = BUF_MEM_new ( ); location: 155 cross_layer: 1 file: a_d2i_fp.c
if ( want >= ( len - off ) )  location: 163 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 164 cross_layer: 1 file: a_d2i_fp.c
if ( len + want < len || ! BUF_MEM_grow_clean ( b , len + want ) )  location: 166 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 170 cross_layer: 1 file: a_d2i_fp.c
if ( ( i < 0 ) && ( ( len - off ) == 0 ) )  location: 171 cross_layer: 1 file: a_d2i_fp.c
if ( i > 0 )  location: 175 cross_layer: 1 file: a_d2i_fp.c
if ( len + i < len )  location: 176 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 180 cross_layer: 1 file: a_d2i_fp.c
p = ( unsigned char * ) & ( b -> data [ off ] ); location: 185 cross_layer: 1 file: a_d2i_fp.c
q = p; location: 186 cross_layer: 1 file: a_d2i_fp.c
inf = ASN1_get_object ( & q , & slen , & tag , & xclass , len - off ); location: 187 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 0x80 )  location: 188 cross_layer: 1 file: a_d2i_fp.c
unsigned long e ; location: 189 cross_layer: 1 file: a_d2i_fp.c
e = ERR_GET_REASON ( ERR_peek_error ( ) ); location: 191 cross_layer: 1 file: a_d2i_fp.c
if ( e != ASN1_R_TOO_LONG )  location: 192 cross_layer: 1 file: a_d2i_fp.c
i = q - p; location: 197 cross_layer: 1 file: a_d2i_fp.c
off += i; location: 198 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 1 )  location: 200 cross_layer: 1 file: a_d2i_fp.c
eos ++; location: 202 cross_layer: 1 file: a_d2i_fp.c
if ( eos && ( slen == 0 ) && ( tag == V_ASN1_EOC ) )  location: 208 cross_layer: 1 file: a_d2i_fp.c
want = slen; location: 217 cross_layer: 1 file: a_d2i_fp.c
if ( want > ( len - off ) )  location: 218 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 219 cross_layer: 1 file: a_d2i_fp.c
if ( want > INT_MAX || len + want < len )  location: 220 cross_layer: 1 file: a_d2i_fp.c
if ( ! BUF_MEM_grow_clean ( b , len + want ) )  location: 225 cross_layer: 1 file: a_d2i_fp.c
while ( want > 0 )  location: 229 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 230 cross_layer: 1 file: a_d2i_fp.c
if ( i <= 0 )  location: 231 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 240 cross_layer: 1 file: a_d2i_fp.c
want -= i; location: 241 cross_layer: 1 file: a_d2i_fp.c
len = asn1_d2i_read_bio ( in , & b ); location: 112 cross_layer: 2 file: a_d2i_fp.c
if ( len < 0 )  location: 113 cross_layer: 2 file: a_d2i_fp.c
ret = ASN1_item_d2i ( x , & p , len , it ); location: 117 cross_layer: 2 file: a_d2i_fp.c
return ( ret ) ; location: 120 cross_layer: 2 file: a_d2i_fp.c
ret = ASN1_item_d2i_bio ( it , b , x ); location: 134 cross_layer: 3 file: a_d2i_fp.c
return ( ret ) ; location: 136 cross_layer: 3 file: a_d2i_fp.c
------------------------------
7 @@ testCode/CVE-2016-2109_CWE-399_c62981390d6cf9e3d612c489b8b77c2913b25807_a_d2i_fp.c_OLD.c @@ asn1_d2i_read_bio @@ 225 @@ ['want', 'b', 'len'] @@ {in, b, p, q}
static int asn1_d2i_read_bio(BIO *in, BUF_MEM **pb) location: 141 cross_layer: 1 file: a_d2i_fp.c
BUF_MEM * b ; location: 143 cross_layer: 1 file: a_d2i_fp.c
unsigned char * p ; location: 144 cross_layer: 1 file: a_d2i_fp.c
int i ; location: 145 cross_layer: 1 file: a_d2i_fp.c
size_t want = HEADER_SIZE ; location: 146 cross_layer: 1 file: a_d2i_fp.c
int eos = 0 ; location: 147 cross_layer: 1 file: a_d2i_fp.c
size_t off = 0 ; location: 148 cross_layer: 1 file: a_d2i_fp.c
size_t len = 0 ; location: 149 cross_layer: 1 file: a_d2i_fp.c
const unsigned char * q ; location: 151 cross_layer: 1 file: a_d2i_fp.c
long slen ; location: 152 cross_layer: 1 file: a_d2i_fp.c
int inf , tag , xclass ; location: 153 cross_layer: 1 file: a_d2i_fp.c
b = BUF_MEM_new ( ); location: 155 cross_layer: 1 file: a_d2i_fp.c
if ( want >= ( len - off ) )  location: 163 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 164 cross_layer: 1 file: a_d2i_fp.c
if ( len + want < len || ! BUF_MEM_grow_clean ( b , len + want ) )  location: 166 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 170 cross_layer: 1 file: a_d2i_fp.c
if ( ( i < 0 ) && ( ( len - off ) == 0 ) )  location: 171 cross_layer: 1 file: a_d2i_fp.c
if ( i > 0 )  location: 175 cross_layer: 1 file: a_d2i_fp.c
if ( len + i < len )  location: 176 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 180 cross_layer: 1 file: a_d2i_fp.c
p = ( unsigned char * ) & ( b -> data [ off ] ); location: 185 cross_layer: 1 file: a_d2i_fp.c
q = p; location: 186 cross_layer: 1 file: a_d2i_fp.c
inf = ASN1_get_object ( & q , & slen , & tag , & xclass , len - off ); location: 187 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 0x80 )  location: 188 cross_layer: 1 file: a_d2i_fp.c
unsigned long e ; location: 189 cross_layer: 1 file: a_d2i_fp.c
e = ERR_GET_REASON ( ERR_peek_error ( ) ); location: 191 cross_layer: 1 file: a_d2i_fp.c
if ( e != ASN1_R_TOO_LONG )  location: 192 cross_layer: 1 file: a_d2i_fp.c
i = q - p; location: 197 cross_layer: 1 file: a_d2i_fp.c
off += i; location: 198 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 1 )  location: 200 cross_layer: 1 file: a_d2i_fp.c
eos ++; location: 202 cross_layer: 1 file: a_d2i_fp.c
if ( eos && ( slen == 0 ) && ( tag == V_ASN1_EOC ) )  location: 208 cross_layer: 1 file: a_d2i_fp.c
want = slen; location: 217 cross_layer: 1 file: a_d2i_fp.c
if ( want > ( len - off ) )  location: 218 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 219 cross_layer: 1 file: a_d2i_fp.c
if ( want > INT_MAX || len + want < len )  location: 220 cross_layer: 1 file: a_d2i_fp.c
if ( ! BUF_MEM_grow_clean ( b , len + want ) )  location: 225 cross_layer: 1 file: a_d2i_fp.c
while ( want > 0 )  location: 229 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 230 cross_layer: 1 file: a_d2i_fp.c
if ( i <= 0 )  location: 231 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 240 cross_layer: 1 file: a_d2i_fp.c
want -= i; location: 241 cross_layer: 1 file: a_d2i_fp.c
if ( off + slen < off )  location: 244 cross_layer: 1 file: a_d2i_fp.c
off += slen; location: 248 cross_layer: 1 file: a_d2i_fp.c
if ( off > INT_MAX )  location: 256 cross_layer: 1 file: a_d2i_fp.c
* pb = b; location: 261 cross_layer: 1 file: a_d2i_fp.c
return off ; location: 262 cross_layer: 1 file: a_d2i_fp.c
BUF_MEM_free ( b ); location: 264 cross_layer: 1 file: a_d2i_fp.c
len = asn1_d2i_read_bio ( in , & b ); location: 92 cross_layer: 2 file: a_d2i_fp.c
if ( len < 0 )  location: 93 cross_layer: 2 file: a_d2i_fp.c
ret = d2i ( x , & p , len ); location: 97 cross_layer: 2 file: a_d2i_fp.c
return ( ret ) ; location: 100 cross_layer: 2 file: a_d2i_fp.c
ret = ASN1_d2i_bio ( xnew , d2i , b , x ); location: 79 cross_layer: 3 file: a_d2i_fp.c
return ( ret ) ; location: 81 cross_layer: 3 file: a_d2i_fp.c
------------------------------
8 @@ testCode/CVE-2016-2109_CWE-399_c62981390d6cf9e3d612c489b8b77c2913b25807_a_d2i_fp.c_OLD.c @@ asn1_d2i_read_bio @@ 225 @@ ['want', 'b', 'len'] @@ {in, b, p, q}
static int asn1_d2i_read_bio(BIO *in, BUF_MEM **pb) location: 141 cross_layer: 1 file: a_d2i_fp.c
BUF_MEM * b ; location: 143 cross_layer: 1 file: a_d2i_fp.c
unsigned char * p ; location: 144 cross_layer: 1 file: a_d2i_fp.c
int i ; location: 145 cross_layer: 1 file: a_d2i_fp.c
size_t want = HEADER_SIZE ; location: 146 cross_layer: 1 file: a_d2i_fp.c
int eos = 0 ; location: 147 cross_layer: 1 file: a_d2i_fp.c
size_t off = 0 ; location: 148 cross_layer: 1 file: a_d2i_fp.c
size_t len = 0 ; location: 149 cross_layer: 1 file: a_d2i_fp.c
const unsigned char * q ; location: 151 cross_layer: 1 file: a_d2i_fp.c
long slen ; location: 152 cross_layer: 1 file: a_d2i_fp.c
int inf , tag , xclass ; location: 153 cross_layer: 1 file: a_d2i_fp.c
b = BUF_MEM_new ( ); location: 155 cross_layer: 1 file: a_d2i_fp.c
if ( want >= ( len - off ) )  location: 163 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 164 cross_layer: 1 file: a_d2i_fp.c
if ( len + want < len || ! BUF_MEM_grow_clean ( b , len + want ) )  location: 166 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 170 cross_layer: 1 file: a_d2i_fp.c
if ( ( i < 0 ) && ( ( len - off ) == 0 ) )  location: 171 cross_layer: 1 file: a_d2i_fp.c
if ( i > 0 )  location: 175 cross_layer: 1 file: a_d2i_fp.c
if ( len + i < len )  location: 176 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 180 cross_layer: 1 file: a_d2i_fp.c
p = ( unsigned char * ) & ( b -> data [ off ] ); location: 185 cross_layer: 1 file: a_d2i_fp.c
q = p; location: 186 cross_layer: 1 file: a_d2i_fp.c
inf = ASN1_get_object ( & q , & slen , & tag , & xclass , len - off ); location: 187 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 0x80 )  location: 188 cross_layer: 1 file: a_d2i_fp.c
unsigned long e ; location: 189 cross_layer: 1 file: a_d2i_fp.c
e = ERR_GET_REASON ( ERR_peek_error ( ) ); location: 191 cross_layer: 1 file: a_d2i_fp.c
if ( e != ASN1_R_TOO_LONG )  location: 192 cross_layer: 1 file: a_d2i_fp.c
i = q - p; location: 197 cross_layer: 1 file: a_d2i_fp.c
off += i; location: 198 cross_layer: 1 file: a_d2i_fp.c
if ( inf & 1 )  location: 200 cross_layer: 1 file: a_d2i_fp.c
eos ++; location: 202 cross_layer: 1 file: a_d2i_fp.c
if ( eos && ( slen == 0 ) && ( tag == V_ASN1_EOC ) )  location: 208 cross_layer: 1 file: a_d2i_fp.c
want = slen; location: 217 cross_layer: 1 file: a_d2i_fp.c
if ( want > ( len - off ) )  location: 218 cross_layer: 1 file: a_d2i_fp.c
want -= ( len - off ); location: 219 cross_layer: 1 file: a_d2i_fp.c
if ( want > INT_MAX || len + want < len )  location: 220 cross_layer: 1 file: a_d2i_fp.c
if ( ! BUF_MEM_grow_clean ( b , len + want ) )  location: 225 cross_layer: 1 file: a_d2i_fp.c
while ( want > 0 )  location: 229 cross_layer: 1 file: a_d2i_fp.c
i = BIO_read ( in , & ( b -> data [ len ] ) , want ); location: 230 cross_layer: 1 file: a_d2i_fp.c
if ( i <= 0 )  location: 231 cross_layer: 1 file: a_d2i_fp.c
len += i; location: 240 cross_layer: 1 file: a_d2i_fp.c
want -= i; location: 241 cross_layer: 1 file: a_d2i_fp.c
if ( off + slen < off )  location: 244 cross_layer: 1 file: a_d2i_fp.c
off += slen; location: 248 cross_layer: 1 file: a_d2i_fp.c
if ( off > INT_MAX )  location: 256 cross_layer: 1 file: a_d2i_fp.c
* pb = b; location: 261 cross_layer: 1 file: a_d2i_fp.c
return off ; location: 262 cross_layer: 1 file: a_d2i_fp.c
BUF_MEM_free ( b ); location: 264 cross_layer: 1 file: a_d2i_fp.c
len = asn1_d2i_read_bio ( in , & b ); location: 112 cross_layer: 2 file: a_d2i_fp.c
if ( len < 0 )  location: 113 cross_layer: 2 file: a_d2i_fp.c
ret = ASN1_item_d2i ( x , & p , len , it ); location: 117 cross_layer: 2 file: a_d2i_fp.c
return ( ret ) ; location: 120 cross_layer: 2 file: a_d2i_fp.c
ret = ASN1_item_d2i_bio ( it , b , x ); location: 134 cross_layer: 3 file: a_d2i_fp.c
return ( ret ) ; location: 136 cross_layer: 3 file: a_d2i_fp.c
------------------------------
