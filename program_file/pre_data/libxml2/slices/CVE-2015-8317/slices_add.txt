1 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 8073 cross_layer: 3 file: parser.c
xmlParsePEReference ( ctxt ); location: 7122 cross_layer: 4 file: parser.c
------------------------------
2 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 8073 cross_layer: 3 file: parser.c
xmlParsePEReference ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
3 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 8073 cross_layer: 3 file: parser.c
xmlParsePEReference ( ctxt ); location: 8410 cross_layer: 4 file: parser.c
------------------------------
4 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 8073 cross_layer: 3 file: parser.c
xmlParsePEReference ( ctxt ); location: 6802 cross_layer: 4 file: parser.c
------------------------------
5 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 7088 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12919 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12921 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12922 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12923 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12924 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12925 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12928 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12929 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12930 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12931 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12932 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12938 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12939 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12941 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12942 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12944 cross_layer: 4 file: parser.c
------------------------------
6 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 2681 cross_layer: 3 file: parser.c
xmlParserHandlePEReference ( ctxt ); location: 2167 cross_layer: 4 file: parser.c
------------------------------
7 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13304 cross_layer: 3 file: parser.c
return ( xmlParseExternalEntityPrivate ( doc , NULL , sax , user_data , depth , URL , ID , lst ) ) ; location: 13405 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13196 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13205 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13211 cross_layer: 5 file: parser.c
* list = NULL; location: 13212 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13213 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13215 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13219 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13220 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13221 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13222 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13223 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13224 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13225 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13226 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13227 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13228 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13229 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13230 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13236 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13237 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13238 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13239 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13241 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13242 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13243 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13245 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13247 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13250 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13252 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13253 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13257 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13258 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13259 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13260 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13262 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13263 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13265 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13266 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13267 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13268 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13269 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13270 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13271 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13272 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13273 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13274 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13275 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13278 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13279 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13280 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13281 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13289 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13296 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13304 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13307 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13308 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13310 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13313 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13315 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13317 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13318 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13321 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13322 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13325 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13327 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13334 cross_layer: 5 file: parser.c
* list = cur; location: 13335 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13336 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13337 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13338 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13340 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13349 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13350 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 13355 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13356 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13357 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code != XML_ERR_OK )  location: 13362 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13363 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13365 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13366 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13367 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13368 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13369 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13370 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13371 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13372 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13373 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13374 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13375 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13376 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13378 cross_layer: 5 file: parser.c
------------------------------
8 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13304 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7276 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7279 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7282 cross_layer: 4 file: parser.c
static void
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 753 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 755 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 758 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 759 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 760 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7290 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7291 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7292 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7293 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7294 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 342 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 347 cross_layer: 5 file: parser.c
switch ( error )  location: 350 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 532 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 536 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 537 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 538 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 541 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 542 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 543 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 544 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7298 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 125 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 129 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 131 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 138 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 140 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 143 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 145 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 148 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 149 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 150 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 151 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 152 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 156 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 157 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 165 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 166 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 169 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 171 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 173 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 177 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 183 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 184 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 187 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 189 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 192 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 196 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 201 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 202 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 205 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 211 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 217 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 222 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7303 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7304 cross_layer: 4 file: parser.c
ent -> children = list; location: 7307 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7308 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7313 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7316 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7318 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7320 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7322 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7323 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7324 cross_layer: 4 file: parser.c
ent -> last = list; location: 7325 cross_layer: 4 file: parser.c
list = list -> next; location: 7326 cross_layer: 4 file: parser.c
list = ent -> children; location: 7328 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7330 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7331 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14774 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14777 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7335 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7337 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7338 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7339 cross_layer: 4 file: parser.c
ent -> last = list; location: 7340 cross_layer: 4 file: parser.c
list = list -> next; location: 7341 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7348 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7350 cross_layer: 4 file: parser.c
static void
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 724 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 726 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 729 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 730 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 731 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 735 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 736 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 737 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 738 cross_layer: 5 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7352 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 125 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 129 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 131 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 138 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 140 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 143 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 145 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 148 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 149 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 150 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 151 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 152 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 156 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 157 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 165 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 166 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 169 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 171 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 173 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 177 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 183 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 184 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 187 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 189 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 192 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 196 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 201 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 202 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 205 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 211 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 217 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 222 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7357 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7358 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7359 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7360 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7368 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7375 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7382 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7388 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7389 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseBalancedChunkMemoryInternal(xmlParserCtxtPtr oldctxt,
const xmlChar *string, void *user_data, xmlNodePtr *lst) location: 13460 cross_layer: 5 file: parser.c
if ( ( ( oldctxt -> depth > 40 ) && ( ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( oldctxt -> depth > 1024 ) )  location: 13473 cross_layer: 5 file: parser.c
if ( lst != NULL )  location: 13479 cross_layer: 5 file: parser.c
* lst = NULL; location: 13480 cross_layer: 5 file: parser.c
if ( string == NULL )  location: 13481 cross_layer: 5 file: parser.c
size = xmlStrlen ( string ); location: 13484 cross_layer: 5 file: parser.c
ctxt = xmlCreateMemoryParserCtxt ( ( char * ) string , size ); location: 13486 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13487 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13488 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13489 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13491 cross_layer: 5 file: parser.c
if ( ctxt -> dict != NULL )  location: 13492 cross_layer: 5 file: parser.c
xmlDictFree ( ctxt -> dict ); location: 13492 cross_layer: 5 file: parser.c
ctxt -> dict = oldctxt -> dict; location: 13493 cross_layer: 5 file: parser.c
ctxt -> str_xml = xmlDictLookup ( ctxt -> dict , BAD_CAST "xml" , 3 )
ctxt -> str_xmlns = xmlDictLookup ( ctxt -> dict , BAD_CAST "xmlns" , 5 ) location: 13495 cross_layer: 5 file: parser.c
ctxt -> str_xml_ns = xmlDictLookup ( ctxt -> dict , XML_XML_NAMESPACE , 36 ); location: 13496 cross_layer: 5 file: parser.c
for (i = 0;i < oldctxt->nsNr;i += 2) location: 13500 cross_layer: 5 file: parser.c
nsPush ( ctxt , oldctxt -> nsTab [ i ] , oldctxt -> nsTab [ i + 1 ] ); location: 13501 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13505 cross_layer: 5 file: parser.c
ctxt -> sax = oldctxt -> sax; location: 13506 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13507 cross_layer: 5 file: parser.c
ctxt -> replaceEntities = oldctxt -> replaceEntities; location: 13508 cross_layer: 5 file: parser.c
ctxt -> options = oldctxt -> options; location: 13509 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13511 cross_layer: 5 file: parser.c
if ( oldctxt -> myDoc == NULL )  location: 13512 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13515 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13516 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13517 cross_layer: 5 file: parser.c
newDoc -> dict = ctxt -> dict; location: 13521 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13522 cross_layer: 5 file: parser.c
ctxt -> myDoc = newDoc; location: 13523 cross_layer: 5 file: parser.c
ctxt -> myDoc = oldctxt -> myDoc; location: 13525 cross_layer: 5 file: parser.c
content = ctxt -> myDoc -> children; location: 13526 cross_layer: 5 file: parser.c
last = ctxt -> myDoc -> last; location: 13527 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( ctxt -> myDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13529 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13530 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13531 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13532 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13533 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13534 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13535 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = NULL; location: 13539 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = NULL; location: 13540 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ctxt -> myDoc , newRoot ); location: 13541 cross_layer: 5 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13542 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13543 cross_layer: 5 file: parser.c
ctxt -> depth = oldctxt -> depth + 1; location: 13544 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13546 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13547 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) || ( oldctxt -> replaceEntities != 0 ) )  location: 13548 cross_layer: 5 file: parser.c
ctxt -> loadsubset |= XML_SKIP_IDS; location: 13552 cross_layer: 5 file: parser.c
ctxt -> dictNames = oldctxt -> dictNames; location: 13554 cross_layer: 5 file: parser.c
ctxt -> attsDefault = oldctxt -> attsDefault; location: 13555 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = oldctxt -> attsSpecial; location: 13556 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13558 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13560 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13562 cross_layer: 5 file: parser.c
if ( ctxt -> node != ctxt -> myDoc -> children )  location: 13564 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13565 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13568 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13569 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13572 cross_layer: 5 file: parser.c
if ( ( lst != NULL ) && ( ret == XML_ERR_OK ) )  location: 13577 cross_layer: 5 file: parser.c
cur = ctxt -> myDoc -> children -> children; location: 13584 cross_layer: 5 file: parser.c
* lst = cur; location: 13585 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13586 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) && ( oldctxt -> wellFormed ) && ( oldctxt -> myDoc ) && ( oldctxt -> myDoc -> intSubset ) && ( cur -> type == XML_ELEMENT_NODE ) )  location: 13588 cross_layer: 5 file: parser.c
oldctxt -> valid &= xmlValidateElement ( & oldctxt -> vctxt , oldctxt -> myDoc , cur ); location: 13591 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13595 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13596 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children -> children = NULL; location: 13598 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 13600 cross_layer: 5 file: parser.c
xmlFreeNode ( ctxt -> myDoc -> children ); location: 13601 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = content; location: 13602 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = last; location: 13603 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13610 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13611 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code != XML_ERR_OK )  location: 13616 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13617 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13619 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13620 cross_layer: 5 file: parser.c
ctxt -> attsDefault = NULL; location: 13621 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = NULL; location: 13622 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13623 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13624 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13625 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13628 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7391 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7392 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7394 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7395 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7398 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7401 cross_layer: 4 file: parser.c
static void
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 753 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 755 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 758 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 759 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 760 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7404 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7405 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 342 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 347 cross_layer: 5 file: parser.c
switch ( error )  location: 350 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 532 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 536 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 537 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 538 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 541 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 542 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 543 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 544 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7409 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7415 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7423 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7428 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7432 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7446 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7452 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7459 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7460 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 125 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 129 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 131 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 138 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 140 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 143 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 145 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 148 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 149 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 150 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 151 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 152 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 156 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 157 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 165 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 166 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 169 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 171 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 173 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 177 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 183 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 184 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 187 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 189 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 192 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 196 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 201 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 202 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 205 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 211 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 217 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 222 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7470 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7471 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7472 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7473 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7474 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7475 cross_layer: 4 file: parser.c
firstChild = nw; location: 7477 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7479 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7481 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7486 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7490 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7494 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7497 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7498 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14774 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14777 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7500 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7507 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7508 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 125 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 129 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 131 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 138 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 140 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 143 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 145 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 148 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 149 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 150 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 151 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 152 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 156 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 157 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 165 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 166 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 169 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 171 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 173 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 177 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 183 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 184 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 187 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 189 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 192 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 196 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 201 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 202 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 205 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 211 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 217 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 222 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7517 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7518 cross_layer: 4 file: parser.c
last = ent -> last; location: 7519 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7520 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7521 cross_layer: 4 file: parser.c
next = cur -> next; location: 7522 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7523 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7524 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7525 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7526 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7527 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7528 cross_layer: 4 file: parser.c
firstChild = cur; location: 7530 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7532 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7533 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7535 cross_layer: 4 file: parser.c
cur = next; location: 7537 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7539 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7540 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7542 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7543 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14774 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14777 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7555 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7556 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7557 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7559 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7560 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7567 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7568 cross_layer: 4 file: parser.c
------------------------------
9 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13304 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7395 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7398 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7401 cross_layer: 4 file: parser.c
static void
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 753 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 755 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 758 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 759 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 760 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7404 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7405 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 342 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 347 cross_layer: 5 file: parser.c
switch ( error )  location: 350 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 532 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 536 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 537 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 538 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 541 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 542 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 543 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 544 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7409 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7415 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7423 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7428 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7432 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7446 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7452 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7459 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7460 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 125 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 129 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 131 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 138 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 140 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 143 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 145 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 148 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 149 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 150 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 151 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 152 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 156 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 157 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 165 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 166 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 169 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 171 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 173 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 177 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 183 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 184 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 187 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 189 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 192 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 196 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 201 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 202 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 205 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 211 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 217 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 222 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7470 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7471 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7472 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7473 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7474 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7475 cross_layer: 4 file: parser.c
firstChild = nw; location: 7477 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7479 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7481 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7486 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7490 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7494 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7497 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7498 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14774 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14777 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7500 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7507 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7508 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 125 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 129 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 131 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 138 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 140 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 143 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 145 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 148 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 149 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 150 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 151 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 152 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 156 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 157 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 165 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 166 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 169 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 171 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 173 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 177 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 183 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 184 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 187 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 189 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 192 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 196 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 201 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 202 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 205 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 211 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 217 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 222 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7517 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7518 cross_layer: 4 file: parser.c
last = ent -> last; location: 7519 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7520 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7521 cross_layer: 4 file: parser.c
next = cur -> next; location: 7522 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7523 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7524 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7525 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7526 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7527 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7528 cross_layer: 4 file: parser.c
firstChild = cur; location: 7530 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7532 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7533 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7535 cross_layer: 4 file: parser.c
cur = next; location: 7537 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7539 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7540 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7542 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7543 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14774 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14777 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7555 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7556 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7557 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7559 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7560 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7567 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7568 cross_layer: 4 file: parser.c
------------------------------
10 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13076 cross_layer: 3 file: parser.c
------------------------------
11 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 11405 cross_layer: 3 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12380 cross_layer: 4 file: parser.c
------------------------------
12 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 11405 cross_layer: 3 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12395 cross_layer: 4 file: parser.c
------------------------------
13 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10963 cross_layer: 3 file: parser.c
xmlParseExtParsedEnt ( ctxt ); location: 14055 cross_layer: 4 file: parser.c
------------------------------
14 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10783 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 15307 cross_layer: 4 file: parser.c
------------------------------
15 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10783 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14286 cross_layer: 4 file: parser.c
------------------------------
16 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10783 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14558 cross_layer: 4 file: parser.c
------------------------------
17 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10783 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14652 cross_layer: 4 file: parser.c
------------------------------
18 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10783 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14725 cross_layer: 4 file: parser.c
------------------------------
19 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10407 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10404 cross_layer: 1 file: parser.c
if ( RAW != '"' )  location: 10405 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10407 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10783 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14442 cross_layer: 4 file: parser.c
------------------------------
20 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 8073 cross_layer: 3 file: parser.c
xmlParsePEReference ( ctxt ); location: 7122 cross_layer: 4 file: parser.c
------------------------------
21 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 8073 cross_layer: 3 file: parser.c
xmlParsePEReference ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
22 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 8073 cross_layer: 3 file: parser.c
xmlParsePEReference ( ctxt ); location: 8410 cross_layer: 4 file: parser.c
------------------------------
23 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 8073 cross_layer: 3 file: parser.c
xmlParsePEReference ( ctxt ); location: 6802 cross_layer: 4 file: parser.c
------------------------------
24 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 7088 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12919 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12921 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12922 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12923 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12924 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12925 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12928 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12929 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12930 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12931 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12932 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12938 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12939 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12941 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12942 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12944 cross_layer: 4 file: parser.c
------------------------------
25 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 2681 cross_layer: 3 file: parser.c
xmlParserHandlePEReference ( ctxt ); location: 2167 cross_layer: 4 file: parser.c
------------------------------
26 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13304 cross_layer: 3 file: parser.c
return ( xmlParseExternalEntityPrivate ( doc , NULL , sax , user_data , depth , URL , ID , lst ) ) ; location: 13405 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13196 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13205 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13211 cross_layer: 5 file: parser.c
* list = NULL; location: 13212 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13213 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13215 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13219 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13220 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13221 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13222 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13223 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13224 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13225 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13226 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13227 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13228 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13229 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13230 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13236 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13237 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13238 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13239 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13241 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13242 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13243 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13245 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13247 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13250 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13252 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13253 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13257 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13258 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13259 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13260 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13262 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13263 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13265 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13266 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13267 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13268 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13269 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13270 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13271 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13272 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13273 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13274 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13275 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13278 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13279 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13280 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13281 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13289 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13296 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13304 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13307 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13308 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13310 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13313 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13315 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13317 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13318 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13321 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13322 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13325 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13327 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13334 cross_layer: 5 file: parser.c
* list = cur; location: 13335 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13336 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13337 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13338 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13340 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13349 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13350 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 13355 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13356 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13357 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code != XML_ERR_OK )  location: 13362 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13363 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13365 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13366 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13367 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13368 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13369 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13370 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13371 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13372 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13373 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13374 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13375 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13376 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13378 cross_layer: 5 file: parser.c
------------------------------
27 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13304 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7276 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7279 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7282 cross_layer: 4 file: parser.c
static void
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 753 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 755 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 758 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 759 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 760 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7290 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7291 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7292 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7293 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7294 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 342 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 347 cross_layer: 5 file: parser.c
switch ( error )  location: 350 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 532 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 536 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 537 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 538 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 541 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 542 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 543 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 544 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7298 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 125 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 129 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 131 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 138 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 140 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 143 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 145 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 148 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 149 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 150 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 151 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 152 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 156 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 157 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 165 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 166 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 169 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 171 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 173 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 177 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 183 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 184 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 187 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 189 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 192 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 196 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 201 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 202 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 205 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 211 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 217 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 222 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7303 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7304 cross_layer: 4 file: parser.c
ent -> children = list; location: 7307 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7308 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7313 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7316 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7318 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7320 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7322 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7323 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7324 cross_layer: 4 file: parser.c
ent -> last = list; location: 7325 cross_layer: 4 file: parser.c
list = list -> next; location: 7326 cross_layer: 4 file: parser.c
list = ent -> children; location: 7328 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7330 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7331 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14774 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14777 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7335 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7337 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7338 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7339 cross_layer: 4 file: parser.c
ent -> last = list; location: 7340 cross_layer: 4 file: parser.c
list = list -> next; location: 7341 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7348 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7350 cross_layer: 4 file: parser.c
static void
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 724 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 726 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 729 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 730 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 731 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 735 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 736 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 737 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 738 cross_layer: 5 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7352 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 125 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 129 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 131 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 138 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 140 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 143 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 145 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 148 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 149 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 150 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 151 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 152 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 156 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 157 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 165 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 166 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 169 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 171 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 173 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 177 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 183 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 184 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 187 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 189 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 192 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 196 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 201 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 202 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 205 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 211 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 217 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 222 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7357 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7358 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7359 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7360 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7368 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7375 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7382 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7388 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7389 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseBalancedChunkMemoryInternal(xmlParserCtxtPtr oldctxt,
const xmlChar *string, void *user_data, xmlNodePtr *lst) location: 13460 cross_layer: 5 file: parser.c
if ( ( ( oldctxt -> depth > 40 ) && ( ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( oldctxt -> depth > 1024 ) )  location: 13473 cross_layer: 5 file: parser.c
if ( lst != NULL )  location: 13479 cross_layer: 5 file: parser.c
* lst = NULL; location: 13480 cross_layer: 5 file: parser.c
if ( string == NULL )  location: 13481 cross_layer: 5 file: parser.c
size = xmlStrlen ( string ); location: 13484 cross_layer: 5 file: parser.c
ctxt = xmlCreateMemoryParserCtxt ( ( char * ) string , size ); location: 13486 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13487 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13488 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13489 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13491 cross_layer: 5 file: parser.c
if ( ctxt -> dict != NULL )  location: 13492 cross_layer: 5 file: parser.c
xmlDictFree ( ctxt -> dict ); location: 13492 cross_layer: 5 file: parser.c
ctxt -> dict = oldctxt -> dict; location: 13493 cross_layer: 5 file: parser.c
ctxt -> str_xml = xmlDictLookup ( ctxt -> dict , BAD_CAST "xml" , 3 )
ctxt -> str_xmlns = xmlDictLookup ( ctxt -> dict , BAD_CAST "xmlns" , 5 ) location: 13495 cross_layer: 5 file: parser.c
ctxt -> str_xml_ns = xmlDictLookup ( ctxt -> dict , XML_XML_NAMESPACE , 36 ); location: 13496 cross_layer: 5 file: parser.c
for (i = 0;i < oldctxt->nsNr;i += 2) location: 13500 cross_layer: 5 file: parser.c
nsPush ( ctxt , oldctxt -> nsTab [ i ] , oldctxt -> nsTab [ i + 1 ] ); location: 13501 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13505 cross_layer: 5 file: parser.c
ctxt -> sax = oldctxt -> sax; location: 13506 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13507 cross_layer: 5 file: parser.c
ctxt -> replaceEntities = oldctxt -> replaceEntities; location: 13508 cross_layer: 5 file: parser.c
ctxt -> options = oldctxt -> options; location: 13509 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13511 cross_layer: 5 file: parser.c
if ( oldctxt -> myDoc == NULL )  location: 13512 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13515 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13516 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13517 cross_layer: 5 file: parser.c
newDoc -> dict = ctxt -> dict; location: 13521 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13522 cross_layer: 5 file: parser.c
ctxt -> myDoc = newDoc; location: 13523 cross_layer: 5 file: parser.c
ctxt -> myDoc = oldctxt -> myDoc; location: 13525 cross_layer: 5 file: parser.c
content = ctxt -> myDoc -> children; location: 13526 cross_layer: 5 file: parser.c
last = ctxt -> myDoc -> last; location: 13527 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( ctxt -> myDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13529 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13530 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13531 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13532 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13533 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13534 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13535 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = NULL; location: 13539 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = NULL; location: 13540 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ctxt -> myDoc , newRoot ); location: 13541 cross_layer: 5 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13542 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13543 cross_layer: 5 file: parser.c
ctxt -> depth = oldctxt -> depth + 1; location: 13544 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13546 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13547 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) || ( oldctxt -> replaceEntities != 0 ) )  location: 13548 cross_layer: 5 file: parser.c
ctxt -> loadsubset |= XML_SKIP_IDS; location: 13552 cross_layer: 5 file: parser.c
ctxt -> dictNames = oldctxt -> dictNames; location: 13554 cross_layer: 5 file: parser.c
ctxt -> attsDefault = oldctxt -> attsDefault; location: 13555 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = oldctxt -> attsSpecial; location: 13556 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13558 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13560 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13562 cross_layer: 5 file: parser.c
if ( ctxt -> node != ctxt -> myDoc -> children )  location: 13564 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13565 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13568 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13569 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13572 cross_layer: 5 file: parser.c
if ( ( lst != NULL ) && ( ret == XML_ERR_OK ) )  location: 13577 cross_layer: 5 file: parser.c
cur = ctxt -> myDoc -> children -> children; location: 13584 cross_layer: 5 file: parser.c
* lst = cur; location: 13585 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13586 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) && ( oldctxt -> wellFormed ) && ( oldctxt -> myDoc ) && ( oldctxt -> myDoc -> intSubset ) && ( cur -> type == XML_ELEMENT_NODE ) )  location: 13588 cross_layer: 5 file: parser.c
oldctxt -> valid &= xmlValidateElement ( & oldctxt -> vctxt , oldctxt -> myDoc , cur ); location: 13591 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13595 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13596 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children -> children = NULL; location: 13598 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 13600 cross_layer: 5 file: parser.c
xmlFreeNode ( ctxt -> myDoc -> children ); location: 13601 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = content; location: 13602 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = last; location: 13603 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13610 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13611 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code != XML_ERR_OK )  location: 13616 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13617 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13619 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13620 cross_layer: 5 file: parser.c
ctxt -> attsDefault = NULL; location: 13621 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = NULL; location: 13622 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13623 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13624 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13625 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13628 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7391 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7392 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7394 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7395 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7398 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7401 cross_layer: 4 file: parser.c
static void
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 753 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 755 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 758 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 759 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 760 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7404 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7405 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 342 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 347 cross_layer: 5 file: parser.c
switch ( error )  location: 350 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 532 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 536 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 537 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 538 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 541 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 542 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 543 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 544 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7409 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7415 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7423 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7428 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7432 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7446 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7452 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7459 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7460 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 125 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 129 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 131 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 138 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 140 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 143 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 145 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 148 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 149 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 150 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 151 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 152 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 156 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 157 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 165 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 166 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 169 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 171 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 173 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 177 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 183 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 184 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 187 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 189 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 192 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 196 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 201 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 202 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 205 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 211 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 217 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 222 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7470 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7471 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7472 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7473 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7474 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7475 cross_layer: 4 file: parser.c
firstChild = nw; location: 7477 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7479 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7481 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7486 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7490 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7494 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7497 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7498 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14774 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14777 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7500 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7507 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7508 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 125 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 129 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 131 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 138 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 140 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 143 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 145 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 148 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 149 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 150 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 151 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 152 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 156 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 157 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 165 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 166 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 169 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 171 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 173 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 177 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 183 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 184 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 187 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 189 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 192 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 196 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 201 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 202 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 205 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 211 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 217 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 222 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7517 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7518 cross_layer: 4 file: parser.c
last = ent -> last; location: 7519 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7520 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7521 cross_layer: 4 file: parser.c
next = cur -> next; location: 7522 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7523 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7524 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7525 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7526 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7527 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7528 cross_layer: 4 file: parser.c
firstChild = cur; location: 7530 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7532 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7533 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7535 cross_layer: 4 file: parser.c
cur = next; location: 7537 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7539 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7540 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7542 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7543 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14774 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14777 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7555 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7556 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7557 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7559 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7560 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7567 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7568 cross_layer: 4 file: parser.c
------------------------------
28 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13304 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7395 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7398 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7401 cross_layer: 4 file: parser.c
static void
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 753 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 755 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 758 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 759 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 760 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7404 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7405 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 342 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 347 cross_layer: 5 file: parser.c
switch ( error )  location: 350 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 532 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 536 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 537 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 538 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 541 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 542 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 543 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 544 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7409 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7415 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7423 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7428 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7432 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7446 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7452 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7459 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7460 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 125 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 129 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 131 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 138 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 140 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 143 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 145 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 148 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 149 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 150 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 151 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 152 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 156 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 157 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 165 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 166 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 169 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 171 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 173 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 177 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 183 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 184 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 187 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 189 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 192 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 196 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 201 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 202 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 205 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 211 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 217 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 222 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7470 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7471 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7472 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7473 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7474 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7475 cross_layer: 4 file: parser.c
firstChild = nw; location: 7477 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7479 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7481 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7486 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7490 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7494 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7497 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7498 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14774 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14777 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7500 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7507 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7508 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 125 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 129 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 131 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 138 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 140 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 143 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 145 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 148 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 149 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 150 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 151 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 152 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 156 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 157 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 165 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 166 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 169 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 171 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 173 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 177 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 183 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 184 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 187 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 189 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 192 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 196 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 201 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 202 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 205 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 211 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 217 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 222 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7517 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7518 cross_layer: 4 file: parser.c
last = ent -> last; location: 7519 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7520 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7521 cross_layer: 4 file: parser.c
next = cur -> next; location: 7522 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7523 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7524 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7525 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7526 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7527 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7528 cross_layer: 4 file: parser.c
firstChild = cur; location: 7530 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7532 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7533 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7535 cross_layer: 4 file: parser.c
cur = next; location: 7537 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7539 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7540 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7542 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7543 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14774 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14777 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7555 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7556 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7557 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7559 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7560 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7567 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7568 cross_layer: 4 file: parser.c
------------------------------
29 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
encoding = xmlParseEncodingDecl ( ctxt ); location: 7029 cross_layer: 2 file: parser.c
if ( ( encoding == NULL ) && ( ctxt -> errNo == XML_ERR_OK ) )  location: 7036 cross_layer: 2 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13076 cross_layer: 3 file: parser.c
------------------------------
30 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 11405 cross_layer: 3 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12380 cross_layer: 4 file: parser.c
------------------------------
31 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 11405 cross_layer: 3 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12395 cross_layer: 4 file: parser.c
------------------------------
32 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10963 cross_layer: 3 file: parser.c
xmlParseExtParsedEnt ( ctxt ); location: 14055 cross_layer: 4 file: parser.c
------------------------------
33 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10783 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 15307 cross_layer: 4 file: parser.c
------------------------------
34 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10783 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14286 cross_layer: 4 file: parser.c
------------------------------
35 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10783 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14558 cross_layer: 4 file: parser.c
------------------------------
36 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10783 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14652 cross_layer: 4 file: parser.c
------------------------------
37 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10783 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14725 cross_layer: 4 file: parser.c
------------------------------
38 @@ testCode/CVE-2015-8317_CWE-119_9aa37588ee78a06ca1379a9d9356eab16686099c_parser.c_NEW.c @@ xmlParseEncodingDecl @@ 10416 @@ ['encoding'] @@ {}
const xmlChar *
xmlParseEncodingDecl(xmlParserCtxtPtr ctxt) location: 10389 cross_layer: 1 file: parser.c
if ( RAW == '"' )  location: 10402 cross_layer: 1 file: parser.c
if ( RAW == '\'' )  location: 10411 cross_layer: 1 file: parser.c
encoding = xmlParseEncName ( ctxt ); location: 10413 cross_layer: 1 file: parser.c
if ( RAW != '\'' )  location: 10414 cross_layer: 1 file: parser.c
xmlFree ( ( xmlChar * ) encoding ); location: 10416 cross_layer: 1 file: parser.c
xmlParseEncodingDecl ( ctxt ); location: 10642 cross_layer: 2 file: parser.c
xmlParseXMLDecl ( ctxt ); location: 10783 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14442 cross_layer: 4 file: parser.c
------------------------------
