1 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_OLD.c @@ xmlReallocLoc @@ 362 @@ ['size'] @@ {ptr, p ,, tmp, ptr, file}
void *
xmlReallocLoc(void *ptr,size_t size, const char * file, int line) location: 322 cross_layer: 1 file: xmlmemory.c
MEMHDR * p , * tmp ; location: 324 cross_layer: 1 file: xmlmemory.c
if ( ptr == NULL )  location: 330 cross_layer: 1 file: xmlmemory.c
TEST_POINT p = CLIENT_2_HDR ( ptr ) ; location: 334 cross_layer: 1 file: xmlmemory.c
if ( p -> mh_tag != MEMTAG )  location: 339 cross_layer: 1 file: xmlmemory.c
tmp = ( MEMHDR * ) realloc ( p , RESERVE_SIZE + size ); location: 355 cross_layer: 1 file: xmlmemory.c    (key_var lines)
if ( ! tmp )  location: 356 cross_layer: 1 file: xmlmemory.c
p = tmp; location: 360 cross_layer: 1 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Realloced(%lu -> %lu) Ok\n" ,
xmlMemTraceBlockAt , ( long unsigned ) p -> mh_size ,
( long unsigned ) size ) location: 365 cross_layer: 1 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 368 cross_layer: 1 file: xmlmemory.c
p -> mh_number = number; location: 369 cross_layer: 1 file: xmlmemory.c
p -> mh_type = REALLOC_TYPE; location: 370 cross_layer: 1 file: xmlmemory.c
p -> mh_size = size; location: 371 cross_layer: 1 file: xmlmemory.c
p -> mh_file = file; location: 372 cross_layer: 1 file: xmlmemory.c
p -> mh_line = line; location: 373 cross_layer: 1 file: xmlmemory.c
debugMemSize += size; location: 375 cross_layer: 1 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 377 cross_layer: 1 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 377 cross_layer: 1 file: xmlmemory.c
debugmem_list_add ( p ); location: 379 cross_layer: 1 file: xmlmemory.c
static void debugmem_list_add(MEMHDR *p) location: 808 cross_layer: 2 file: xmlmemory.c
p -> mh_next = memlist; location: 810 cross_layer: 2 file: xmlmemory.c
p -> mh_prev = NULL; location: 811 cross_layer: 2 file: xmlmemory.c
memlist -> mh_prev = p; location: 812 cross_layer: 2 file: xmlmemory.c
memlist = p; location: 813 cross_layer: 2 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Realloced(%d to %d) Ok\n" , oldsize , size ); location: 386 cross_layer: 1 file: xmlmemory.c
return ( HDR_2_CLIENT ( p ) ) ; location: 389 cross_layer: 1 file: xmlmemory.c
return ( xmlReallocLoc ( ptr , size , "none" , 0 ) ) ; location: 407 cross_layer: 2 file: xmlmemory.c
void *
xmlReallocLoc(void *ptr,size_t size, const char * file, int line) location: 322 cross_layer: 3 file: xmlmemory.c
if ( ptr == NULL )  location: 330 cross_layer: 3 file: xmlmemory.c
return ( xmlMallocLoc ( size , file , line ) ) ; location: 331 cross_layer: 3 file: xmlmemory.c
TEST_POINT p = CLIENT_2_HDR ( ptr ) ; location: 334 cross_layer: 3 file: xmlmemory.c
number = p -> mh_number; location: 337 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == number )  location: 338 cross_layer: 3 file: xmlmemory.c
if ( p -> mh_tag != MEMTAG )  location: 339 cross_layer: 3 file: xmlmemory.c
Mem_Tag_Err ( p ); location: 340 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = ~MEMTAG; location: 343 cross_layer: 3 file: xmlmemory.c
debugMemSize -= p -> mh_size; location: 345 cross_layer: 3 file: xmlmemory.c
oldsize = p -> mh_size; location: 348 cross_layer: 3 file: xmlmemory.c
debugmem_list_delete ( p ); location: 351 cross_layer: 3 file: xmlmemory.c
tmp = ( MEMHDR * ) realloc ( p , RESERVE_SIZE + size ); location: 355 cross_layer: 3 file: xmlmemory.c    (key_var lines)
if ( ! tmp )  location: 356 cross_layer: 3 file: xmlmemory.c
free ( p ); location: 357 cross_layer: 3 file: xmlmemory.c
p = tmp; location: 360 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ptr )  location: 361 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Realloced(%lu -> %lu) Ok\n" ,
xmlMemTraceBlockAt , ( long unsigned ) p -> mh_size ,
( long unsigned ) size ) location: 365 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 368 cross_layer: 3 file: xmlmemory.c
p -> mh_number = number; location: 369 cross_layer: 3 file: xmlmemory.c
p -> mh_type = REALLOC_TYPE; location: 370 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 371 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 372 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 373 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 375 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 377 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 377 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 379 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Realloced(%d to %d) Ok\n" , oldsize , size ); location: 386 cross_layer: 3 file: xmlmemory.c
return ( HDR_2_CLIENT ( p ) ) ; location: 389 cross_layer: 3 file: xmlmemory.c
------------------------------
2 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_OLD.c @@ xmlMallocLoc @@ 176 @@ ['xmlGenericErrorContext'] @@ {file}
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 1 file: xmlmemory.c
return ( xmlMallocLoc ( size , file , line ) ) ; location: 331 cross_layer: 2 file: xmlmemory.c    (key_var lines)
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d)\n" , size ); location: 169 cross_layer: 3 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 175 cross_layer: 3 file: xmlmemory.c
if ( ! p )  location: 177 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 183 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 184 cross_layer: 3 file: xmlmemory.c
p -> mh_type = MALLOC_TYPE; location: 185 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 186 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 187 cross_layer: 3 file: xmlmemory.c
p -> mh_number = ++ block; location: 189 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 190 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 192 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 192 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 194 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d) Ok\n" , size ); location: 199 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 203 cross_layer: 3 file: xmlmemory.c
ret = HDR_2_CLIENT ( p ); location: 205 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ret )  location: 207 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Malloc(%lu) Ok\n" , xmlMemTraceBlockAt ,
( long unsigned ) size ) location: 210 cross_layer: 3 file: xmlmemory.c
return ( ret ) ; location: 216 cross_layer: 3 file: xmlmemory.c
return ( xmlReallocLoc ( ptr , size , "none" , 0 ) ) ; location: 407 cross_layer: 3 file: xmlmemory.c
void *
xmlReallocLoc(void *ptr,size_t size, const char * file, int line) location: 322 cross_layer: 4 file: xmlmemory.c
if ( ptr == NULL )  location: 330 cross_layer: 4 file: xmlmemory.c
return ( xmlMallocLoc ( size , file , line ) ) ; location: 331 cross_layer: 4 file: xmlmemory.c
TEST_POINT p = CLIENT_2_HDR ( ptr ) ; location: 334 cross_layer: 4 file: xmlmemory.c
number = p -> mh_number; location: 337 cross_layer: 4 file: xmlmemory.c
if ( xmlMemStopAtBlock == number )  location: 338 cross_layer: 4 file: xmlmemory.c
if ( p -> mh_tag != MEMTAG )  location: 339 cross_layer: 4 file: xmlmemory.c
Mem_Tag_Err ( p ); location: 340 cross_layer: 4 file: xmlmemory.c
p -> mh_tag = ~MEMTAG; location: 343 cross_layer: 4 file: xmlmemory.c
debugMemSize -= p -> mh_size; location: 345 cross_layer: 4 file: xmlmemory.c
oldsize = p -> mh_size; location: 348 cross_layer: 4 file: xmlmemory.c
debugmem_list_delete ( p ); location: 351 cross_layer: 4 file: xmlmemory.c
tmp = ( MEMHDR * ) realloc ( p , RESERVE_SIZE + size ); location: 355 cross_layer: 4 file: xmlmemory.c
if ( ! tmp )  location: 356 cross_layer: 4 file: xmlmemory.c
free ( p ); location: 357 cross_layer: 4 file: xmlmemory.c
p = tmp; location: 360 cross_layer: 4 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ptr )  location: 361 cross_layer: 4 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Realloced(%lu -> %lu) Ok\n" ,
xmlMemTraceBlockAt , ( long unsigned ) p -> mh_size ,
( long unsigned ) size ) location: 365 cross_layer: 4 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 368 cross_layer: 4 file: xmlmemory.c
p -> mh_number = number; location: 369 cross_layer: 4 file: xmlmemory.c
p -> mh_type = REALLOC_TYPE; location: 370 cross_layer: 4 file: xmlmemory.c
p -> mh_size = size; location: 371 cross_layer: 4 file: xmlmemory.c
p -> mh_file = file; location: 372 cross_layer: 4 file: xmlmemory.c
p -> mh_line = line; location: 373 cross_layer: 4 file: xmlmemory.c
debugMemSize += size; location: 375 cross_layer: 4 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 377 cross_layer: 4 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 377 cross_layer: 4 file: xmlmemory.c
debugmem_list_add ( p ); location: 379 cross_layer: 4 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Realloced(%d to %d) Ok\n" , oldsize , size ); location: 386 cross_layer: 4 file: xmlmemory.c
return ( HDR_2_CLIENT ( p ) ) ; location: 389 cross_layer: 4 file: xmlmemory.c
------------------------------
3 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_OLD.c @@ xmlMallocLoc @@ 176 @@ ['xmlGenericErrorContext'] @@ {file}
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 1 file: xmlmemory.c
return ( xmlMallocLoc ( size , "none" , 0 ) ) ; location: 306 cross_layer: 2 file: xmlmemory.c    (key_var lines)
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d)\n" , size ); location: 169 cross_layer: 3 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 175 cross_layer: 3 file: xmlmemory.c
if ( ! p )  location: 177 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 183 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 184 cross_layer: 3 file: xmlmemory.c
p -> mh_type = MALLOC_TYPE; location: 185 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 186 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 187 cross_layer: 3 file: xmlmemory.c
p -> mh_number = ++ block; location: 189 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 190 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 192 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 192 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 194 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d) Ok\n" , size ); location: 199 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 203 cross_layer: 3 file: xmlmemory.c
ret = HDR_2_CLIENT ( p ); location: 205 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ret )  location: 207 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Malloc(%lu) Ok\n" , xmlMemTraceBlockAt ,
( long unsigned ) size ) location: 210 cross_layer: 3 file: xmlmemory.c
return ( ret ) ; location: 216 cross_layer: 3 file: xmlmemory.c
------------------------------
4 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_OLD.c @@ xmlMemStrdupLoc @@ 517 @@ ['xmlGenericErrorContext'] @@ {str, str, file}
char *
xmlMemStrdupLoc(const char *str, const char *file, int line) location: 493 cross_layer: 1 file: xmlmemory.c
size_t size = strlen ( str ) + 1 ; location: 496 cross_layer: 1 file: xmlmemory.c
return ( xmlMemStrdupLoc ( str , "none" , 0 ) ) ; location: 552 cross_layer: 2 file: xmlmemory.c    (key_var lines)
char *
xmlMemStrdupLoc(const char *str, const char *file, int line) location: 493 cross_layer: 3 file: xmlmemory.c
size_t size = strlen ( str ) + 1 ; location: 496 cross_layer: 3 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 502 cross_layer: 3 file: xmlmemory.c
if ( ! p )  location: 503 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 506 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 507 cross_layer: 3 file: xmlmemory.c
p -> mh_type = STRDUP_TYPE; location: 508 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 509 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 510 cross_layer: 3 file: xmlmemory.c
p -> mh_number = ++ block; location: 512 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 513 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 515 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 515 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 517 cross_layer: 3 file: xmlmemory.c
s = ( char * ) HDR_2_CLIENT ( p ); location: 521 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 523 cross_layer: 3 file: xmlmemory.c
strcpy ( s , str ); location: 525 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == s )  location: 529 cross_layer: 3 file: xmlmemory.c
return ( s ) ; location: 535 cross_layer: 3 file: xmlmemory.c
------------------------------
5 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_OLD.c @@ xmlMallocLoc @@ 175 @@ ['size'] @@ {file}
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 1 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 175 cross_layer: 1 file: xmlmemory.c    (key_var lines)
if ( ! p )  location: 177 cross_layer: 1 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 183 cross_layer: 1 file: xmlmemory.c
p -> mh_size = size; location: 184 cross_layer: 1 file: xmlmemory.c
p -> mh_type = MALLOC_TYPE; location: 185 cross_layer: 1 file: xmlmemory.c
p -> mh_file = file; location: 186 cross_layer: 1 file: xmlmemory.c
p -> mh_line = line; location: 187 cross_layer: 1 file: xmlmemory.c
p -> mh_number = ++ block; location: 189 cross_layer: 1 file: xmlmemory.c
debugMemSize += size; location: 190 cross_layer: 1 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 192 cross_layer: 1 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 192 cross_layer: 1 file: xmlmemory.c
debugmem_list_add ( p ); location: 194 cross_layer: 1 file: xmlmemory.c
static void debugmem_list_add(MEMHDR *p) location: 808 cross_layer: 2 file: xmlmemory.c
p -> mh_next = memlist; location: 810 cross_layer: 2 file: xmlmemory.c
p -> mh_prev = NULL; location: 811 cross_layer: 2 file: xmlmemory.c
memlist -> mh_prev = p; location: 812 cross_layer: 2 file: xmlmemory.c
memlist = p; location: 813 cross_layer: 2 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d) Ok\n" , size ); location: 199 cross_layer: 1 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 203 cross_layer: 1 file: xmlmemory.c
ret = HDR_2_CLIENT ( p ); location: 205 cross_layer: 1 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ret )  location: 207 cross_layer: 1 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Malloc(%lu) Ok\n" , xmlMemTraceBlockAt ,
( long unsigned ) size ) location: 210 cross_layer: 1 file: xmlmemory.c
return ( ret ) ; location: 216 cross_layer: 1 file: xmlmemory.c
return ( xmlMallocLoc ( size , file , line ) ) ; location: 331 cross_layer: 2 file: xmlmemory.c
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d)\n" , size ); location: 169 cross_layer: 3 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 175 cross_layer: 3 file: xmlmemory.c    (key_var lines)
if ( ! p )  location: 177 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 183 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 184 cross_layer: 3 file: xmlmemory.c
p -> mh_type = MALLOC_TYPE; location: 185 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 186 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 187 cross_layer: 3 file: xmlmemory.c
p -> mh_number = ++ block; location: 189 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 190 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 192 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 192 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 194 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d) Ok\n" , size ); location: 199 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 203 cross_layer: 3 file: xmlmemory.c
ret = HDR_2_CLIENT ( p ); location: 205 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ret )  location: 207 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Malloc(%lu) Ok\n" , xmlMemTraceBlockAt ,
( long unsigned ) size ) location: 210 cross_layer: 3 file: xmlmemory.c
return ( ret ) ; location: 216 cross_layer: 3 file: xmlmemory.c
return ( xmlReallocLoc ( ptr , size , "none" , 0 ) ) ; location: 407 cross_layer: 3 file: xmlmemory.c
void *
xmlReallocLoc(void *ptr,size_t size, const char * file, int line) location: 322 cross_layer: 4 file: xmlmemory.c
if ( ptr == NULL )  location: 330 cross_layer: 4 file: xmlmemory.c
return ( xmlMallocLoc ( size , file , line ) ) ; location: 331 cross_layer: 4 file: xmlmemory.c
TEST_POINT p = CLIENT_2_HDR ( ptr ) ; location: 334 cross_layer: 4 file: xmlmemory.c
number = p -> mh_number; location: 337 cross_layer: 4 file: xmlmemory.c
if ( xmlMemStopAtBlock == number )  location: 338 cross_layer: 4 file: xmlmemory.c
if ( p -> mh_tag != MEMTAG )  location: 339 cross_layer: 4 file: xmlmemory.c
Mem_Tag_Err ( p ); location: 340 cross_layer: 4 file: xmlmemory.c
p -> mh_tag = ~MEMTAG; location: 343 cross_layer: 4 file: xmlmemory.c
debugMemSize -= p -> mh_size; location: 345 cross_layer: 4 file: xmlmemory.c
oldsize = p -> mh_size; location: 348 cross_layer: 4 file: xmlmemory.c
debugmem_list_delete ( p ); location: 351 cross_layer: 4 file: xmlmemory.c
tmp = ( MEMHDR * ) realloc ( p , RESERVE_SIZE + size ); location: 355 cross_layer: 4 file: xmlmemory.c
if ( ! tmp )  location: 356 cross_layer: 4 file: xmlmemory.c
free ( p ); location: 357 cross_layer: 4 file: xmlmemory.c
p = tmp; location: 360 cross_layer: 4 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ptr )  location: 361 cross_layer: 4 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Realloced(%lu -> %lu) Ok\n" ,
xmlMemTraceBlockAt , ( long unsigned ) p -> mh_size ,
( long unsigned ) size ) location: 365 cross_layer: 4 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 368 cross_layer: 4 file: xmlmemory.c
p -> mh_number = number; location: 369 cross_layer: 4 file: xmlmemory.c
p -> mh_type = REALLOC_TYPE; location: 370 cross_layer: 4 file: xmlmemory.c
p -> mh_size = size; location: 371 cross_layer: 4 file: xmlmemory.c
p -> mh_file = file; location: 372 cross_layer: 4 file: xmlmemory.c
p -> mh_line = line; location: 373 cross_layer: 4 file: xmlmemory.c
debugMemSize += size; location: 375 cross_layer: 4 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 377 cross_layer: 4 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 377 cross_layer: 4 file: xmlmemory.c
debugmem_list_add ( p ); location: 379 cross_layer: 4 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Realloced(%d to %d) Ok\n" , oldsize , size ); location: 386 cross_layer: 4 file: xmlmemory.c
return ( HDR_2_CLIENT ( p ) ) ; location: 389 cross_layer: 4 file: xmlmemory.c
------------------------------
6 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_OLD.c @@ xmlMallocLoc @@ 175 @@ ['size'] @@ {file}
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 1 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 175 cross_layer: 1 file: xmlmemory.c    (key_var lines)
if ( ! p )  location: 177 cross_layer: 1 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 183 cross_layer: 1 file: xmlmemory.c
p -> mh_size = size; location: 184 cross_layer: 1 file: xmlmemory.c
p -> mh_type = MALLOC_TYPE; location: 185 cross_layer: 1 file: xmlmemory.c
p -> mh_file = file; location: 186 cross_layer: 1 file: xmlmemory.c
p -> mh_line = line; location: 187 cross_layer: 1 file: xmlmemory.c
p -> mh_number = ++ block; location: 189 cross_layer: 1 file: xmlmemory.c
debugMemSize += size; location: 190 cross_layer: 1 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 192 cross_layer: 1 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 192 cross_layer: 1 file: xmlmemory.c
debugmem_list_add ( p ); location: 194 cross_layer: 1 file: xmlmemory.c
static void debugmem_list_add(MEMHDR *p) location: 808 cross_layer: 2 file: xmlmemory.c
p -> mh_next = memlist; location: 810 cross_layer: 2 file: xmlmemory.c
p -> mh_prev = NULL; location: 811 cross_layer: 2 file: xmlmemory.c
memlist -> mh_prev = p; location: 812 cross_layer: 2 file: xmlmemory.c
memlist = p; location: 813 cross_layer: 2 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d) Ok\n" , size ); location: 199 cross_layer: 1 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 203 cross_layer: 1 file: xmlmemory.c
ret = HDR_2_CLIENT ( p ); location: 205 cross_layer: 1 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ret )  location: 207 cross_layer: 1 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Malloc(%lu) Ok\n" , xmlMemTraceBlockAt ,
( long unsigned ) size ) location: 210 cross_layer: 1 file: xmlmemory.c
return ( ret ) ; location: 216 cross_layer: 1 file: xmlmemory.c
return ( xmlMallocLoc ( size , "none" , 0 ) ) ; location: 306 cross_layer: 2 file: xmlmemory.c
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d)\n" , size ); location: 169 cross_layer: 3 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 175 cross_layer: 3 file: xmlmemory.c    (key_var lines)
if ( ! p )  location: 177 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 183 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 184 cross_layer: 3 file: xmlmemory.c
p -> mh_type = MALLOC_TYPE; location: 185 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 186 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 187 cross_layer: 3 file: xmlmemory.c
p -> mh_number = ++ block; location: 189 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 190 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 192 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 192 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 194 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d) Ok\n" , size ); location: 199 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 203 cross_layer: 3 file: xmlmemory.c
ret = HDR_2_CLIENT ( p ); location: 205 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ret )  location: 207 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Malloc(%lu) Ok\n" , xmlMemTraceBlockAt ,
( long unsigned ) size ) location: 210 cross_layer: 3 file: xmlmemory.c
return ( ret ) ; location: 216 cross_layer: 3 file: xmlmemory.c
------------------------------
7 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_OLD.c @@ xmlMemStrdupLoc @@ 516 @@ ['size'] @@ {str, str, file}
char *
xmlMemStrdupLoc(const char *str, const char *file, int line) location: 493 cross_layer: 1 file: xmlmemory.c
size_t size = strlen ( str ) + 1 ; location: 496 cross_layer: 1 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 502 cross_layer: 1 file: xmlmemory.c    (key_var lines)
if ( ! p )  location: 503 cross_layer: 1 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 506 cross_layer: 1 file: xmlmemory.c
p -> mh_size = size; location: 507 cross_layer: 1 file: xmlmemory.c
p -> mh_type = STRDUP_TYPE; location: 508 cross_layer: 1 file: xmlmemory.c
p -> mh_file = file; location: 509 cross_layer: 1 file: xmlmemory.c
p -> mh_line = line; location: 510 cross_layer: 1 file: xmlmemory.c
p -> mh_number = ++ block; location: 512 cross_layer: 1 file: xmlmemory.c
debugMemSize += size; location: 513 cross_layer: 1 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 515 cross_layer: 1 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 515 cross_layer: 1 file: xmlmemory.c
debugmem_list_add ( p ); location: 517 cross_layer: 1 file: xmlmemory.c
static void debugmem_list_add(MEMHDR *p) location: 808 cross_layer: 2 file: xmlmemory.c
p -> mh_next = memlist; location: 810 cross_layer: 2 file: xmlmemory.c
p -> mh_prev = NULL; location: 811 cross_layer: 2 file: xmlmemory.c
memlist -> mh_prev = p; location: 812 cross_layer: 2 file: xmlmemory.c
memlist = p; location: 813 cross_layer: 2 file: xmlmemory.c
s = ( char * ) HDR_2_CLIENT ( p ); location: 521 cross_layer: 1 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 523 cross_layer: 1 file: xmlmemory.c
strcpy ( s , str ); location: 525 cross_layer: 1 file: xmlmemory.c
if ( xmlMemTraceBlockAt == s )  location: 529 cross_layer: 1 file: xmlmemory.c
return ( s ) ; location: 535 cross_layer: 1 file: xmlmemory.c
return ( xmlMemStrdupLoc ( str , "none" , 0 ) ) ; location: 552 cross_layer: 2 file: xmlmemory.c
char *
xmlMemStrdupLoc(const char *str, const char *file, int line) location: 493 cross_layer: 3 file: xmlmemory.c
size_t size = strlen ( str ) + 1 ; location: 496 cross_layer: 3 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 502 cross_layer: 3 file: xmlmemory.c    (key_var lines)
if ( ! p )  location: 503 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 506 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 507 cross_layer: 3 file: xmlmemory.c
p -> mh_type = STRDUP_TYPE; location: 508 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 509 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 510 cross_layer: 3 file: xmlmemory.c
p -> mh_number = ++ block; location: 512 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 513 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 515 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 515 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 517 cross_layer: 3 file: xmlmemory.c
s = ( char * ) HDR_2_CLIENT ( p ); location: 521 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 523 cross_layer: 3 file: xmlmemory.c
strcpy ( s , str ); location: 525 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == s )  location: 529 cross_layer: 3 file: xmlmemory.c
return ( s ) ; location: 535 cross_layer: 3 file: xmlmemory.c
------------------------------
8 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_OLD.c @@ xmlReallocLoc @@ 363 @@ ['xmlGenericErrorContext'] @@ {ptr, p ,, tmp, ptr, file}
void *
xmlReallocLoc(void *ptr,size_t size, const char * file, int line) location: 322 cross_layer: 1 file: xmlmemory.c
MEMHDR * p , * tmp ; location: 324 cross_layer: 1 file: xmlmemory.c
if ( ptr == NULL )  location: 330 cross_layer: 1 file: xmlmemory.c
TEST_POINT p = CLIENT_2_HDR ( ptr ) ; location: 334 cross_layer: 1 file: xmlmemory.c
if ( p -> mh_tag != MEMTAG )  location: 339 cross_layer: 1 file: xmlmemory.c
return ( xmlReallocLoc ( ptr , size , "none" , 0 ) ) ; location: 407 cross_layer: 2 file: xmlmemory.c    (key_var lines)
void *
xmlReallocLoc(void *ptr,size_t size, const char * file, int line) location: 322 cross_layer: 3 file: xmlmemory.c
if ( ptr == NULL )  location: 330 cross_layer: 3 file: xmlmemory.c
return ( xmlMallocLoc ( size , file , line ) ) ; location: 331 cross_layer: 3 file: xmlmemory.c
TEST_POINT p = CLIENT_2_HDR ( ptr ) ; location: 334 cross_layer: 3 file: xmlmemory.c
number = p -> mh_number; location: 337 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == number )  location: 338 cross_layer: 3 file: xmlmemory.c
if ( p -> mh_tag != MEMTAG )  location: 339 cross_layer: 3 file: xmlmemory.c
Mem_Tag_Err ( p ); location: 340 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = ~MEMTAG; location: 343 cross_layer: 3 file: xmlmemory.c
debugMemSize -= p -> mh_size; location: 345 cross_layer: 3 file: xmlmemory.c
oldsize = p -> mh_size; location: 348 cross_layer: 3 file: xmlmemory.c
debugmem_list_delete ( p ); location: 351 cross_layer: 3 file: xmlmemory.c
tmp = ( MEMHDR * ) realloc ( p , RESERVE_SIZE + size ); location: 355 cross_layer: 3 file: xmlmemory.c
if ( ! tmp )  location: 356 cross_layer: 3 file: xmlmemory.c
free ( p ); location: 357 cross_layer: 3 file: xmlmemory.c
p = tmp; location: 360 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ptr )  location: 361 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Realloced(%lu -> %lu) Ok\n" ,
xmlMemTraceBlockAt , ( long unsigned ) p -> mh_size ,
( long unsigned ) size ) location: 365 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 368 cross_layer: 3 file: xmlmemory.c
p -> mh_number = number; location: 369 cross_layer: 3 file: xmlmemory.c
p -> mh_type = REALLOC_TYPE; location: 370 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 371 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 372 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 373 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 375 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 377 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 377 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 379 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Realloced(%d to %d) Ok\n" , oldsize , size ); location: 386 cross_layer: 3 file: xmlmemory.c
return ( HDR_2_CLIENT ( p ) ) ; location: 389 cross_layer: 3 file: xmlmemory.c
------------------------------
