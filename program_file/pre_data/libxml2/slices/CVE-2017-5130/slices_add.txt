1 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_NEW.c @@ xmlReallocLoc @@ 362 @@ ['size'] @@ {ptr, p ,, tmp, ptr, file}
void *
xmlReallocLoc(void *ptr,size_t size, const char * file, int line) location: 329 cross_layer: 1 file: xmlmemory.c
MEMHDR * p , * tmp ; location: 331 cross_layer: 1 file: xmlmemory.c
if ( ptr == NULL )  location: 337 cross_layer: 1 file: xmlmemory.c
TEST_POINT p = CLIENT_2_HDR ( ptr ) ; location: 341 cross_layer: 1 file: xmlmemory.c
if ( p -> mh_tag != MEMTAG )  location: 346 cross_layer: 1 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 362 cross_layer: 1 file: xmlmemory.c
tmp = ( MEMHDR * ) realloc ( p , RESERVE_SIZE + size ); location: 369 cross_layer: 1 file: xmlmemory.c
if ( ! tmp )  location: 370 cross_layer: 1 file: xmlmemory.c
p = tmp; location: 374 cross_layer: 1 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Realloced(%lu -> %lu) Ok\n" ,
xmlMemTraceBlockAt , ( long unsigned ) p -> mh_size ,
( long unsigned ) size ) location: 379 cross_layer: 1 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 382 cross_layer: 1 file: xmlmemory.c
p -> mh_number = number; location: 383 cross_layer: 1 file: xmlmemory.c
p -> mh_type = REALLOC_TYPE; location: 384 cross_layer: 1 file: xmlmemory.c
p -> mh_size = size; location: 385 cross_layer: 1 file: xmlmemory.c
p -> mh_file = file; location: 386 cross_layer: 1 file: xmlmemory.c
p -> mh_line = line; location: 387 cross_layer: 1 file: xmlmemory.c
debugMemSize += size; location: 389 cross_layer: 1 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 391 cross_layer: 1 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 391 cross_layer: 1 file: xmlmemory.c
debugmem_list_add ( p ); location: 393 cross_layer: 1 file: xmlmemory.c
static void debugmem_list_add(MEMHDR *p) location: 829 cross_layer: 2 file: xmlmemory.c
p -> mh_next = memlist; location: 831 cross_layer: 2 file: xmlmemory.c
p -> mh_prev = NULL; location: 832 cross_layer: 2 file: xmlmemory.c
memlist -> mh_prev = p; location: 833 cross_layer: 2 file: xmlmemory.c
memlist = p; location: 834 cross_layer: 2 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Realloced(%d to %d) Ok\n" , oldsize , size ); location: 400 cross_layer: 1 file: xmlmemory.c
return ( HDR_2_CLIENT ( p ) ) ; location: 403 cross_layer: 1 file: xmlmemory.c
return ( xmlReallocLoc ( ptr , size , "none" , 0 ) ) ; location: 421 cross_layer: 2 file: xmlmemory.c
void *
xmlReallocLoc(void *ptr,size_t size, const char * file, int line) location: 329 cross_layer: 3 file: xmlmemory.c
if ( ptr == NULL )  location: 337 cross_layer: 3 file: xmlmemory.c
return ( xmlMallocLoc ( size , file , line ) ) ; location: 338 cross_layer: 3 file: xmlmemory.c
TEST_POINT p = CLIENT_2_HDR ( ptr ) ; location: 341 cross_layer: 3 file: xmlmemory.c
number = p -> mh_number; location: 344 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == number )  location: 345 cross_layer: 3 file: xmlmemory.c
if ( p -> mh_tag != MEMTAG )  location: 346 cross_layer: 3 file: xmlmemory.c
Mem_Tag_Err ( p ); location: 347 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = ~MEMTAG; location: 350 cross_layer: 3 file: xmlmemory.c
debugMemSize -= p -> mh_size; location: 352 cross_layer: 3 file: xmlmemory.c
oldsize = p -> mh_size; location: 355 cross_layer: 3 file: xmlmemory.c
debugmem_list_delete ( p ); location: 358 cross_layer: 3 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 362 cross_layer: 3 file: xmlmemory.c
tmp = ( MEMHDR * ) realloc ( p , RESERVE_SIZE + size ); location: 369 cross_layer: 3 file: xmlmemory.c
if ( ! tmp )  location: 370 cross_layer: 3 file: xmlmemory.c
free ( p ); location: 371 cross_layer: 3 file: xmlmemory.c
p = tmp; location: 374 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ptr )  location: 375 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Realloced(%lu -> %lu) Ok\n" ,
xmlMemTraceBlockAt , ( long unsigned ) p -> mh_size ,
( long unsigned ) size ) location: 379 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 382 cross_layer: 3 file: xmlmemory.c
p -> mh_number = number; location: 383 cross_layer: 3 file: xmlmemory.c
p -> mh_type = REALLOC_TYPE; location: 384 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 385 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 386 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 387 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 389 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 391 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 391 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 393 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Realloced(%d to %d) Ok\n" , oldsize , size ); location: 400 cross_layer: 3 file: xmlmemory.c
return ( HDR_2_CLIENT ( p ) ) ; location: 403 cross_layer: 3 file: xmlmemory.c
------------------------------
2 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_NEW.c @@ xmlMallocLoc @@ 176 @@ ['xmlGenericErrorContext'] @@ {file}
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 1 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 175 cross_layer: 1 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "xmlMallocLoc : Unsigned overflow\n" ); location: 176 cross_layer: 1 file: xmlmemory.c
return ( xmlMallocLoc ( size , file , line ) ) ; location: 338 cross_layer: 2 file: xmlmemory.c
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d)\n" , size ); location: 169 cross_layer: 3 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 175 cross_layer: 3 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 182 cross_layer: 3 file: xmlmemory.c
if ( ! p )  location: 184 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 190 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 191 cross_layer: 3 file: xmlmemory.c
p -> mh_type = MALLOC_TYPE; location: 192 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 193 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 194 cross_layer: 3 file: xmlmemory.c
p -> mh_number = ++ block; location: 196 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 197 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 199 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 199 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 201 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d) Ok\n" , size ); location: 206 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 210 cross_layer: 3 file: xmlmemory.c
ret = HDR_2_CLIENT ( p ); location: 212 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ret )  location: 214 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Malloc(%lu) Ok\n" , xmlMemTraceBlockAt ,
( long unsigned ) size ) location: 217 cross_layer: 3 file: xmlmemory.c
return ( ret ) ; location: 223 cross_layer: 3 file: xmlmemory.c
return ( xmlReallocLoc ( ptr , size , "none" , 0 ) ) ; location: 421 cross_layer: 3 file: xmlmemory.c
void *
xmlReallocLoc(void *ptr,size_t size, const char * file, int line) location: 329 cross_layer: 4 file: xmlmemory.c
if ( ptr == NULL )  location: 337 cross_layer: 4 file: xmlmemory.c
return ( xmlMallocLoc ( size , file , line ) ) ; location: 338 cross_layer: 4 file: xmlmemory.c
TEST_POINT p = CLIENT_2_HDR ( ptr ) ; location: 341 cross_layer: 4 file: xmlmemory.c
number = p -> mh_number; location: 344 cross_layer: 4 file: xmlmemory.c
if ( xmlMemStopAtBlock == number )  location: 345 cross_layer: 4 file: xmlmemory.c
if ( p -> mh_tag != MEMTAG )  location: 346 cross_layer: 4 file: xmlmemory.c
Mem_Tag_Err ( p ); location: 347 cross_layer: 4 file: xmlmemory.c
p -> mh_tag = ~MEMTAG; location: 350 cross_layer: 4 file: xmlmemory.c
debugMemSize -= p -> mh_size; location: 352 cross_layer: 4 file: xmlmemory.c
oldsize = p -> mh_size; location: 355 cross_layer: 4 file: xmlmemory.c
debugmem_list_delete ( p ); location: 358 cross_layer: 4 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 362 cross_layer: 4 file: xmlmemory.c
tmp = ( MEMHDR * ) realloc ( p , RESERVE_SIZE + size ); location: 369 cross_layer: 4 file: xmlmemory.c
if ( ! tmp )  location: 370 cross_layer: 4 file: xmlmemory.c
free ( p ); location: 371 cross_layer: 4 file: xmlmemory.c
p = tmp; location: 374 cross_layer: 4 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ptr )  location: 375 cross_layer: 4 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Realloced(%lu -> %lu) Ok\n" ,
xmlMemTraceBlockAt , ( long unsigned ) p -> mh_size ,
( long unsigned ) size ) location: 379 cross_layer: 4 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 382 cross_layer: 4 file: xmlmemory.c
p -> mh_number = number; location: 383 cross_layer: 4 file: xmlmemory.c
p -> mh_type = REALLOC_TYPE; location: 384 cross_layer: 4 file: xmlmemory.c
p -> mh_size = size; location: 385 cross_layer: 4 file: xmlmemory.c
p -> mh_file = file; location: 386 cross_layer: 4 file: xmlmemory.c
p -> mh_line = line; location: 387 cross_layer: 4 file: xmlmemory.c
debugMemSize += size; location: 389 cross_layer: 4 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 391 cross_layer: 4 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 391 cross_layer: 4 file: xmlmemory.c
debugmem_list_add ( p ); location: 393 cross_layer: 4 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Realloced(%d to %d) Ok\n" , oldsize , size ); location: 400 cross_layer: 4 file: xmlmemory.c
return ( HDR_2_CLIENT ( p ) ) ; location: 403 cross_layer: 4 file: xmlmemory.c
------------------------------
3 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_NEW.c @@ xmlMallocLoc @@ 176 @@ ['xmlGenericErrorContext'] @@ {file}
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 1 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 175 cross_layer: 1 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "xmlMallocLoc : Unsigned overflow\n" ); location: 176 cross_layer: 1 file: xmlmemory.c
return ( xmlMallocLoc ( size , "none" , 0 ) ) ; location: 313 cross_layer: 2 file: xmlmemory.c
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d)\n" , size ); location: 169 cross_layer: 3 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 175 cross_layer: 3 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 182 cross_layer: 3 file: xmlmemory.c
if ( ! p )  location: 184 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 190 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 191 cross_layer: 3 file: xmlmemory.c
p -> mh_type = MALLOC_TYPE; location: 192 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 193 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 194 cross_layer: 3 file: xmlmemory.c
p -> mh_number = ++ block; location: 196 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 197 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 199 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 199 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 201 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d) Ok\n" , size ); location: 206 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 210 cross_layer: 3 file: xmlmemory.c
ret = HDR_2_CLIENT ( p ); location: 212 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ret )  location: 214 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Malloc(%lu) Ok\n" , xmlMemTraceBlockAt ,
( long unsigned ) size ) location: 217 cross_layer: 3 file: xmlmemory.c
return ( ret ) ; location: 223 cross_layer: 3 file: xmlmemory.c
------------------------------
4 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_NEW.c @@ xmlMemStrdupLoc @@ 517 @@ ['xmlGenericErrorContext'] @@ {str, str, file}
char *
xmlMemStrdupLoc(const char *str, const char *file, int line) location: 507 cross_layer: 1 file: xmlmemory.c
size_t size = strlen ( str ) + 1 ; location: 510 cross_layer: 1 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 516 cross_layer: 1 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "xmlMallocLoc : Unsigned overflow\n" ); location: 517 cross_layer: 1 file: xmlmemory.c
return ( xmlMemStrdupLoc ( str , "none" , 0 ) ) ; location: 573 cross_layer: 2 file: xmlmemory.c
char *
xmlMemStrdupLoc(const char *str, const char *file, int line) location: 507 cross_layer: 3 file: xmlmemory.c
size_t size = strlen ( str ) + 1 ; location: 510 cross_layer: 3 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 516 cross_layer: 3 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 523 cross_layer: 3 file: xmlmemory.c
if ( ! p )  location: 524 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 527 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 528 cross_layer: 3 file: xmlmemory.c
p -> mh_type = STRDUP_TYPE; location: 529 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 530 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 531 cross_layer: 3 file: xmlmemory.c
p -> mh_number = ++ block; location: 533 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 534 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 536 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 536 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 538 cross_layer: 3 file: xmlmemory.c
s = ( char * ) HDR_2_CLIENT ( p ); location: 542 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 544 cross_layer: 3 file: xmlmemory.c
strcpy ( s , str ); location: 546 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == s )  location: 550 cross_layer: 3 file: xmlmemory.c
return ( s ) ; location: 556 cross_layer: 3 file: xmlmemory.c
------------------------------
5 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_NEW.c @@ xmlMallocLoc @@ 175 @@ ['size'] @@ {file}
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 1 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 175 cross_layer: 1 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 182 cross_layer: 1 file: xmlmemory.c
if ( ! p )  location: 184 cross_layer: 1 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 190 cross_layer: 1 file: xmlmemory.c
p -> mh_size = size; location: 191 cross_layer: 1 file: xmlmemory.c
p -> mh_type = MALLOC_TYPE; location: 192 cross_layer: 1 file: xmlmemory.c
p -> mh_file = file; location: 193 cross_layer: 1 file: xmlmemory.c
p -> mh_line = line; location: 194 cross_layer: 1 file: xmlmemory.c
p -> mh_number = ++ block; location: 196 cross_layer: 1 file: xmlmemory.c
debugMemSize += size; location: 197 cross_layer: 1 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 199 cross_layer: 1 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 199 cross_layer: 1 file: xmlmemory.c
debugmem_list_add ( p ); location: 201 cross_layer: 1 file: xmlmemory.c
static void debugmem_list_add(MEMHDR *p) location: 829 cross_layer: 2 file: xmlmemory.c
p -> mh_next = memlist; location: 831 cross_layer: 2 file: xmlmemory.c
p -> mh_prev = NULL; location: 832 cross_layer: 2 file: xmlmemory.c
memlist -> mh_prev = p; location: 833 cross_layer: 2 file: xmlmemory.c
memlist = p; location: 834 cross_layer: 2 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d) Ok\n" , size ); location: 206 cross_layer: 1 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 210 cross_layer: 1 file: xmlmemory.c
ret = HDR_2_CLIENT ( p ); location: 212 cross_layer: 1 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ret )  location: 214 cross_layer: 1 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Malloc(%lu) Ok\n" , xmlMemTraceBlockAt ,
( long unsigned ) size ) location: 217 cross_layer: 1 file: xmlmemory.c
return ( ret ) ; location: 223 cross_layer: 1 file: xmlmemory.c
return ( xmlMallocLoc ( size , file , line ) ) ; location: 338 cross_layer: 2 file: xmlmemory.c
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d)\n" , size ); location: 169 cross_layer: 3 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 175 cross_layer: 3 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 182 cross_layer: 3 file: xmlmemory.c
if ( ! p )  location: 184 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 190 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 191 cross_layer: 3 file: xmlmemory.c
p -> mh_type = MALLOC_TYPE; location: 192 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 193 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 194 cross_layer: 3 file: xmlmemory.c
p -> mh_number = ++ block; location: 196 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 197 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 199 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 199 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 201 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d) Ok\n" , size ); location: 206 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 210 cross_layer: 3 file: xmlmemory.c
ret = HDR_2_CLIENT ( p ); location: 212 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ret )  location: 214 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Malloc(%lu) Ok\n" , xmlMemTraceBlockAt ,
( long unsigned ) size ) location: 217 cross_layer: 3 file: xmlmemory.c
return ( ret ) ; location: 223 cross_layer: 3 file: xmlmemory.c
return ( xmlReallocLoc ( ptr , size , "none" , 0 ) ) ; location: 421 cross_layer: 3 file: xmlmemory.c
void *
xmlReallocLoc(void *ptr,size_t size, const char * file, int line) location: 329 cross_layer: 4 file: xmlmemory.c
if ( ptr == NULL )  location: 337 cross_layer: 4 file: xmlmemory.c
return ( xmlMallocLoc ( size , file , line ) ) ; location: 338 cross_layer: 4 file: xmlmemory.c
TEST_POINT p = CLIENT_2_HDR ( ptr ) ; location: 341 cross_layer: 4 file: xmlmemory.c
number = p -> mh_number; location: 344 cross_layer: 4 file: xmlmemory.c
if ( xmlMemStopAtBlock == number )  location: 345 cross_layer: 4 file: xmlmemory.c
if ( p -> mh_tag != MEMTAG )  location: 346 cross_layer: 4 file: xmlmemory.c
Mem_Tag_Err ( p ); location: 347 cross_layer: 4 file: xmlmemory.c
p -> mh_tag = ~MEMTAG; location: 350 cross_layer: 4 file: xmlmemory.c
debugMemSize -= p -> mh_size; location: 352 cross_layer: 4 file: xmlmemory.c
oldsize = p -> mh_size; location: 355 cross_layer: 4 file: xmlmemory.c
debugmem_list_delete ( p ); location: 358 cross_layer: 4 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 362 cross_layer: 4 file: xmlmemory.c
tmp = ( MEMHDR * ) realloc ( p , RESERVE_SIZE + size ); location: 369 cross_layer: 4 file: xmlmemory.c
if ( ! tmp )  location: 370 cross_layer: 4 file: xmlmemory.c
free ( p ); location: 371 cross_layer: 4 file: xmlmemory.c
p = tmp; location: 374 cross_layer: 4 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ptr )  location: 375 cross_layer: 4 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Realloced(%lu -> %lu) Ok\n" ,
xmlMemTraceBlockAt , ( long unsigned ) p -> mh_size ,
( long unsigned ) size ) location: 379 cross_layer: 4 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 382 cross_layer: 4 file: xmlmemory.c
p -> mh_number = number; location: 383 cross_layer: 4 file: xmlmemory.c
p -> mh_type = REALLOC_TYPE; location: 384 cross_layer: 4 file: xmlmemory.c
p -> mh_size = size; location: 385 cross_layer: 4 file: xmlmemory.c
p -> mh_file = file; location: 386 cross_layer: 4 file: xmlmemory.c
p -> mh_line = line; location: 387 cross_layer: 4 file: xmlmemory.c
debugMemSize += size; location: 389 cross_layer: 4 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 391 cross_layer: 4 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 391 cross_layer: 4 file: xmlmemory.c
debugmem_list_add ( p ); location: 393 cross_layer: 4 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Realloced(%d to %d) Ok\n" , oldsize , size ); location: 400 cross_layer: 4 file: xmlmemory.c
return ( HDR_2_CLIENT ( p ) ) ; location: 403 cross_layer: 4 file: xmlmemory.c
------------------------------
6 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_NEW.c @@ xmlMallocLoc @@ 175 @@ ['size'] @@ {file}
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 1 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 175 cross_layer: 1 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 182 cross_layer: 1 file: xmlmemory.c
if ( ! p )  location: 184 cross_layer: 1 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 190 cross_layer: 1 file: xmlmemory.c
p -> mh_size = size; location: 191 cross_layer: 1 file: xmlmemory.c
p -> mh_type = MALLOC_TYPE; location: 192 cross_layer: 1 file: xmlmemory.c
p -> mh_file = file; location: 193 cross_layer: 1 file: xmlmemory.c
p -> mh_line = line; location: 194 cross_layer: 1 file: xmlmemory.c
p -> mh_number = ++ block; location: 196 cross_layer: 1 file: xmlmemory.c
debugMemSize += size; location: 197 cross_layer: 1 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 199 cross_layer: 1 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 199 cross_layer: 1 file: xmlmemory.c
debugmem_list_add ( p ); location: 201 cross_layer: 1 file: xmlmemory.c
static void debugmem_list_add(MEMHDR *p) location: 829 cross_layer: 2 file: xmlmemory.c
p -> mh_next = memlist; location: 831 cross_layer: 2 file: xmlmemory.c
p -> mh_prev = NULL; location: 832 cross_layer: 2 file: xmlmemory.c
memlist -> mh_prev = p; location: 833 cross_layer: 2 file: xmlmemory.c
memlist = p; location: 834 cross_layer: 2 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d) Ok\n" , size ); location: 206 cross_layer: 1 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 210 cross_layer: 1 file: xmlmemory.c
ret = HDR_2_CLIENT ( p ); location: 212 cross_layer: 1 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ret )  location: 214 cross_layer: 1 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Malloc(%lu) Ok\n" , xmlMemTraceBlockAt ,
( long unsigned ) size ) location: 217 cross_layer: 1 file: xmlmemory.c
return ( ret ) ; location: 223 cross_layer: 1 file: xmlmemory.c
return ( xmlMallocLoc ( size , "none" , 0 ) ) ; location: 313 cross_layer: 2 file: xmlmemory.c
void *
xmlMallocLoc(size_t size, const char * file, int line) location: 162 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d)\n" , size ); location: 169 cross_layer: 3 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 175 cross_layer: 3 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 182 cross_layer: 3 file: xmlmemory.c
if ( ! p )  location: 184 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 190 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 191 cross_layer: 3 file: xmlmemory.c
p -> mh_type = MALLOC_TYPE; location: 192 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 193 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 194 cross_layer: 3 file: xmlmemory.c
p -> mh_number = ++ block; location: 196 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 197 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 199 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 199 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 201 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Malloc(%d) Ok\n" , size ); location: 206 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 210 cross_layer: 3 file: xmlmemory.c
ret = HDR_2_CLIENT ( p ); location: 212 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ret )  location: 214 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Malloc(%lu) Ok\n" , xmlMemTraceBlockAt ,
( long unsigned ) size ) location: 217 cross_layer: 3 file: xmlmemory.c
return ( ret ) ; location: 223 cross_layer: 3 file: xmlmemory.c
------------------------------
7 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_NEW.c @@ xmlMemStrdupLoc @@ 516 @@ ['size'] @@ {str, str, file}
char *
xmlMemStrdupLoc(const char *str, const char *file, int line) location: 507 cross_layer: 1 file: xmlmemory.c
size_t size = strlen ( str ) + 1 ; location: 510 cross_layer: 1 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 516 cross_layer: 1 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 523 cross_layer: 1 file: xmlmemory.c
if ( ! p )  location: 524 cross_layer: 1 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 527 cross_layer: 1 file: xmlmemory.c
p -> mh_size = size; location: 528 cross_layer: 1 file: xmlmemory.c
p -> mh_type = STRDUP_TYPE; location: 529 cross_layer: 1 file: xmlmemory.c
p -> mh_file = file; location: 530 cross_layer: 1 file: xmlmemory.c
p -> mh_line = line; location: 531 cross_layer: 1 file: xmlmemory.c
p -> mh_number = ++ block; location: 533 cross_layer: 1 file: xmlmemory.c
debugMemSize += size; location: 534 cross_layer: 1 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 536 cross_layer: 1 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 536 cross_layer: 1 file: xmlmemory.c
debugmem_list_add ( p ); location: 538 cross_layer: 1 file: xmlmemory.c
static void debugmem_list_add(MEMHDR *p) location: 829 cross_layer: 2 file: xmlmemory.c
p -> mh_next = memlist; location: 831 cross_layer: 2 file: xmlmemory.c
p -> mh_prev = NULL; location: 832 cross_layer: 2 file: xmlmemory.c
memlist -> mh_prev = p; location: 833 cross_layer: 2 file: xmlmemory.c
memlist = p; location: 834 cross_layer: 2 file: xmlmemory.c
s = ( char * ) HDR_2_CLIENT ( p ); location: 542 cross_layer: 1 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 544 cross_layer: 1 file: xmlmemory.c
strcpy ( s , str ); location: 546 cross_layer: 1 file: xmlmemory.c
if ( xmlMemTraceBlockAt == s )  location: 550 cross_layer: 1 file: xmlmemory.c
return ( s ) ; location: 556 cross_layer: 1 file: xmlmemory.c
return ( xmlMemStrdupLoc ( str , "none" , 0 ) ) ; location: 573 cross_layer: 2 file: xmlmemory.c
char *
xmlMemStrdupLoc(const char *str, const char *file, int line) location: 507 cross_layer: 3 file: xmlmemory.c
size_t size = strlen ( str ) + 1 ; location: 510 cross_layer: 3 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 516 cross_layer: 3 file: xmlmemory.c
p = ( MEMHDR * ) malloc ( RESERVE_SIZE + size ); location: 523 cross_layer: 3 file: xmlmemory.c
if ( ! p )  location: 524 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 527 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 528 cross_layer: 3 file: xmlmemory.c
p -> mh_type = STRDUP_TYPE; location: 529 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 530 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 531 cross_layer: 3 file: xmlmemory.c
p -> mh_number = ++ block; location: 533 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 534 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 536 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 536 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 538 cross_layer: 3 file: xmlmemory.c
s = ( char * ) HDR_2_CLIENT ( p ); location: 542 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == p -> mh_number )  location: 544 cross_layer: 3 file: xmlmemory.c
strcpy ( s , str ); location: 546 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == s )  location: 550 cross_layer: 3 file: xmlmemory.c
return ( s ) ; location: 556 cross_layer: 3 file: xmlmemory.c
------------------------------
8 @@ testCode/CVE-2017-5130_CWE-787_897dffbae322b46b83f99a607d527058a72c51ed_xmlmemory.c_NEW.c @@ xmlReallocLoc @@ 363 @@ ['xmlGenericErrorContext'] @@ {ptr, p ,, tmp, ptr, file}
void *
xmlReallocLoc(void *ptr,size_t size, const char * file, int line) location: 329 cross_layer: 1 file: xmlmemory.c
MEMHDR * p , * tmp ; location: 331 cross_layer: 1 file: xmlmemory.c
if ( ptr == NULL )  location: 337 cross_layer: 1 file: xmlmemory.c
TEST_POINT p = CLIENT_2_HDR ( ptr ) ; location: 341 cross_layer: 1 file: xmlmemory.c
if ( p -> mh_tag != MEMTAG )  location: 346 cross_layer: 1 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 362 cross_layer: 1 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "xmlMallocLoc : Unsigned overflow\n" ); location: 363 cross_layer: 1 file: xmlmemory.c
return ( xmlReallocLoc ( ptr , size , "none" , 0 ) ) ; location: 421 cross_layer: 2 file: xmlmemory.c
void *
xmlReallocLoc(void *ptr,size_t size, const char * file, int line) location: 329 cross_layer: 3 file: xmlmemory.c
if ( ptr == NULL )  location: 337 cross_layer: 3 file: xmlmemory.c
return ( xmlMallocLoc ( size , file , line ) ) ; location: 338 cross_layer: 3 file: xmlmemory.c
TEST_POINT p = CLIENT_2_HDR ( ptr ) ; location: 341 cross_layer: 3 file: xmlmemory.c
number = p -> mh_number; location: 344 cross_layer: 3 file: xmlmemory.c
if ( xmlMemStopAtBlock == number )  location: 345 cross_layer: 3 file: xmlmemory.c
if ( p -> mh_tag != MEMTAG )  location: 346 cross_layer: 3 file: xmlmemory.c
Mem_Tag_Err ( p ); location: 347 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = ~MEMTAG; location: 350 cross_layer: 3 file: xmlmemory.c
debugMemSize -= p -> mh_size; location: 352 cross_layer: 3 file: xmlmemory.c
oldsize = p -> mh_size; location: 355 cross_layer: 3 file: xmlmemory.c
debugmem_list_delete ( p ); location: 358 cross_layer: 3 file: xmlmemory.c
if ( size > ( MAX_SIZE_T - RESERVE_SIZE ) )  location: 362 cross_layer: 3 file: xmlmemory.c
tmp = ( MEMHDR * ) realloc ( p , RESERVE_SIZE + size ); location: 369 cross_layer: 3 file: xmlmemory.c
if ( ! tmp )  location: 370 cross_layer: 3 file: xmlmemory.c
free ( p ); location: 371 cross_layer: 3 file: xmlmemory.c
p = tmp; location: 374 cross_layer: 3 file: xmlmemory.c
if ( xmlMemTraceBlockAt == ptr )  location: 375 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext ,
"%p : Realloced(%lu -> %lu) Ok\n" ,
xmlMemTraceBlockAt , ( long unsigned ) p -> mh_size ,
( long unsigned ) size ) location: 379 cross_layer: 3 file: xmlmemory.c
p -> mh_tag = MEMTAG; location: 382 cross_layer: 3 file: xmlmemory.c
p -> mh_number = number; location: 383 cross_layer: 3 file: xmlmemory.c
p -> mh_type = REALLOC_TYPE; location: 384 cross_layer: 3 file: xmlmemory.c
p -> mh_size = size; location: 385 cross_layer: 3 file: xmlmemory.c
p -> mh_file = file; location: 386 cross_layer: 3 file: xmlmemory.c
p -> mh_line = line; location: 387 cross_layer: 3 file: xmlmemory.c
debugMemSize += size; location: 389 cross_layer: 3 file: xmlmemory.c
if ( debugMemSize > debugMaxMemSize )  location: 391 cross_layer: 3 file: xmlmemory.c
debugMaxMemSize = debugMemSize; location: 391 cross_layer: 3 file: xmlmemory.c
debugmem_list_add ( p ); location: 393 cross_layer: 3 file: xmlmemory.c
xmlGenericError ( xmlGenericErrorContext , "Realloced(%d to %d) Ok\n" , oldsize , size ); location: 400 cross_layer: 3 file: xmlmemory.c
return ( HDR_2_CLIENT ( p ) ) ; location: 403 cross_layer: 3 file: xmlmemory.c
------------------------------
