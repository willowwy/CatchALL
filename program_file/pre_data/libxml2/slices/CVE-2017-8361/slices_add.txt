1 @@ testCode/CVE-2017-8361_CWE-119_fd0484aba8e51d16af1e3a880f9b8b857b385eb3_flac.c_NEW.c @@ sf_flac_meta_callback @@ 445 @@ ['psf->sf.channels', 'psf->sf.samplerate'] @@ {metadata, client_data, psf}
static void
sf_flac_meta_callback (const FLAC__StreamDecoder * UNUSED (decoder), const FLAC__StreamMetadata *metadata, void *client_data) location: 431 cross_layer: 1 file: flac.c
SF_PRIVATE * psf = ( SF_PRIVATE * ) client_data ; location: 432 cross_layer: 1 file: flac.c
switch ( metadata -> type )  location: 435 cross_layer: 1 file: flac.c
if ( psf -> sf . channels > 0 && psf -> sf . channels != ( int ) metadata -> data . stream_info . channels )  location: 437 cross_layer: 1 file: flac.c
psf -> error = SFE_FLAC_CHANNEL_COUNT_CHANGED; location: 441 cross_layer: 1 file: flac.c
if ( psf -> sf . channels > 0 && psf -> sf . samplerate != ( int ) metadata -> data . stream_info . sample_rate )  location: 445 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Warning: FLAC stream changed sample rates from %d to %d.\n"
"Carrying on as if nothing happened." ,
psf -> sf . samplerate , metadata -> data . stream_info . sample_rate ) location: 448 cross_layer: 1 file: flac.c
psf -> sf . channels = metadata -> data . stream_info . channels; location: 450 cross_layer: 1 file: flac.c
psf -> sf . samplerate = metadata -> data . stream_info . sample_rate; location: 451 cross_layer: 1 file: flac.c
psf -> sf . frames = metadata -> data . stream_info . total_samples; location: 452 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "FLAC Stream Metadata\n  Channels    : %d\n  Sample rate : %d\n" , psf -> sf . channels , psf -> sf . samplerate ); location: 454 cross_layer: 1 file: flac.c
if ( psf -> sf . frames == 0 )  location: 456 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "  Frames      : 0 (bumping to SF_COUNT_MAX)\n" ); location: 457 cross_layer: 1 file: flac.c
psf -> sf . frames = SF_COUNT_MAX; location: 458 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "  Frames      : %D\n" , psf -> sf . frames ); location: 461 cross_layer: 1 file: flac.c
psf -> sf . format |= SF_FORMAT_PCM_S8; location: 465 cross_layer: 1 file: flac.c
psf -> sf . format |= SF_FORMAT_PCM_16; location: 469 cross_layer: 1 file: flac.c
psf -> sf . format |= SF_FORMAT_PCM_24; location: 473 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "sf_flac_meta_callback : bits_per_sample %d not yet implemented.\n" , metadata -> data . stream_info . bits_per_sample ); location: 477 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "  Bit width   : %d\n" , bitwidth ); location: 482 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Vorbis Comment Metadata\n" ); location: 486 cross_layer: 1 file: flac.c
sf_flac_meta_get_vorbiscomments ( psf , metadata ); location: 487 cross_layer: 1 file: flac.c
static void
sf_flac_meta_get_vorbiscomments (SF_PRIVATE *psf, const FLAC__StreamMetadata *metadata) location: 396 cross_layer: 2 file: flac.c
tag_num = FLAC__metadata_object_vorbiscomment_find_entry_from ( metadata , 0 , tags [ k ] . tag ); location: 414 cross_layer: 2 file: flac.c
if ( tag_num < 0 )  location: 416 cross_layer: 2 file: flac.c
value = ( const char * ) metadata -> data . vorbis_comment . comments [ tag_num ] . entry; location: 419 cross_layer: 2 file: flac.c
if ( ( cptr = strchr ( value , '=' ) ) != NULL )  location: 420 cross_layer: 2 file: flac.c
value = cptr + 1; location: 421 cross_layer: 2 file: flac.c
psf_log_printf ( psf , "  %-12s : %s\n" , tags [ k ] . tag , value ); location: 423 cross_layer: 2 file: flac.c
psf_store_string ( psf , tags [ k ] . type , value ); location: 424 cross_layer: 2 file: flac.c
psf_log_printf ( psf , "Padding Metadata\n" ); location: 491 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Application Metadata\n" ); location: 495 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Seektable Metadata\n" ); location: 499 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Cuesheet Metadata\n" ); location: 503 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Picture Metadata\n" ); location: 507 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Undefined Metadata\n" ); location: 511 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "sf_flac_meta_callback : metadata-type %d not yet implemented.\n" , metadata -> type ); location: 515 cross_layer: 1 file: flac.c
------------------------------
2 @@ testCode/CVE-2017-8361_CWE-119_fd0484aba8e51d16af1e3a880f9b8b857b385eb3_flac.c_NEW.c @@ sf_flac_meta_callback @@ 441 @@ ['psf->error'] @@ {metadata, client_data, psf}
static void
sf_flac_meta_callback (const FLAC__StreamDecoder * UNUSED (decoder), const FLAC__StreamMetadata *metadata, void *client_data) location: 431 cross_layer: 1 file: flac.c
SF_PRIVATE * psf = ( SF_PRIVATE * ) client_data ; location: 432 cross_layer: 1 file: flac.c
switch ( metadata -> type )  location: 435 cross_layer: 1 file: flac.c
if ( psf -> sf . channels > 0 && psf -> sf . channels != ( int ) metadata -> data . stream_info . channels )  location: 437 cross_layer: 1 file: flac.c
psf -> error = SFE_FLAC_CHANNEL_COUNT_CHANGED; location: 441 cross_layer: 1 file: flac.c
if ( psf -> sf . channels > 0 && psf -> sf . samplerate != ( int ) metadata -> data . stream_info . sample_rate )  location: 445 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Warning: FLAC stream changed sample rates from %d to %d.\n"
"Carrying on as if nothing happened." ,
psf -> sf . samplerate , metadata -> data . stream_info . sample_rate ) location: 448 cross_layer: 1 file: flac.c
psf -> sf . channels = metadata -> data . stream_info . channels; location: 450 cross_layer: 1 file: flac.c
psf -> sf . samplerate = metadata -> data . stream_info . sample_rate; location: 451 cross_layer: 1 file: flac.c
psf -> sf . frames = metadata -> data . stream_info . total_samples; location: 452 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "FLAC Stream Metadata\n  Channels    : %d\n  Sample rate : %d\n" , psf -> sf . channels , psf -> sf . samplerate ); location: 454 cross_layer: 1 file: flac.c
if ( psf -> sf . frames == 0 )  location: 456 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "  Frames      : 0 (bumping to SF_COUNT_MAX)\n" ); location: 457 cross_layer: 1 file: flac.c
psf -> sf . frames = SF_COUNT_MAX; location: 458 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "  Frames      : %D\n" , psf -> sf . frames ); location: 461 cross_layer: 1 file: flac.c
psf -> sf . format |= SF_FORMAT_PCM_S8; location: 465 cross_layer: 1 file: flac.c
psf -> sf . format |= SF_FORMAT_PCM_16; location: 469 cross_layer: 1 file: flac.c
psf -> sf . format |= SF_FORMAT_PCM_24; location: 473 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "sf_flac_meta_callback : bits_per_sample %d not yet implemented.\n" , metadata -> data . stream_info . bits_per_sample ); location: 477 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "  Bit width   : %d\n" , bitwidth ); location: 482 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Vorbis Comment Metadata\n" ); location: 486 cross_layer: 1 file: flac.c
sf_flac_meta_get_vorbiscomments ( psf , metadata ); location: 487 cross_layer: 1 file: flac.c
static void
sf_flac_meta_get_vorbiscomments (SF_PRIVATE *psf, const FLAC__StreamMetadata *metadata) location: 396 cross_layer: 2 file: flac.c
tag_num = FLAC__metadata_object_vorbiscomment_find_entry_from ( metadata , 0 , tags [ k ] . tag ); location: 414 cross_layer: 2 file: flac.c
if ( tag_num < 0 )  location: 416 cross_layer: 2 file: flac.c
value = ( const char * ) metadata -> data . vorbis_comment . comments [ tag_num ] . entry; location: 419 cross_layer: 2 file: flac.c
if ( ( cptr = strchr ( value , '=' ) ) != NULL )  location: 420 cross_layer: 2 file: flac.c
value = cptr + 1; location: 421 cross_layer: 2 file: flac.c
psf_log_printf ( psf , "  %-12s : %s\n" , tags [ k ] . tag , value ); location: 423 cross_layer: 2 file: flac.c
psf_store_string ( psf , tags [ k ] . type , value ); location: 424 cross_layer: 2 file: flac.c
psf_log_printf ( psf , "Padding Metadata\n" ); location: 491 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Application Metadata\n" ); location: 495 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Seektable Metadata\n" ); location: 499 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Cuesheet Metadata\n" ); location: 503 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Picture Metadata\n" ); location: 507 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Undefined Metadata\n" ); location: 511 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "sf_flac_meta_callback : metadata-type %d not yet implemented.\n" , metadata -> type ); location: 515 cross_layer: 1 file: flac.c
------------------------------
3 @@ testCode/CVE-2017-8361_CWE-119_fd0484aba8e51d16af1e3a880f9b8b857b385eb3_flac.c_NEW.c @@ sf_flac_meta_callback @@ 437 @@ ['psf->sf.channels'] @@ {metadata, client_data, psf}
static void
sf_flac_meta_callback (const FLAC__StreamDecoder * UNUSED (decoder), const FLAC__StreamMetadata *metadata, void *client_data) location: 431 cross_layer: 1 file: flac.c
SF_PRIVATE * psf = ( SF_PRIVATE * ) client_data ; location: 432 cross_layer: 1 file: flac.c
switch ( metadata -> type )  location: 435 cross_layer: 1 file: flac.c
if ( psf -> sf . channels > 0 && psf -> sf . channels != ( int ) metadata -> data . stream_info . channels )  location: 437 cross_layer: 1 file: flac.c
psf -> error = SFE_FLAC_CHANNEL_COUNT_CHANGED; location: 441 cross_layer: 1 file: flac.c
if ( psf -> sf . channels > 0 && psf -> sf . samplerate != ( int ) metadata -> data . stream_info . sample_rate )  location: 445 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Warning: FLAC stream changed sample rates from %d to %d.\n"
"Carrying on as if nothing happened." ,
psf -> sf . samplerate , metadata -> data . stream_info . sample_rate ) location: 448 cross_layer: 1 file: flac.c
psf -> sf . channels = metadata -> data . stream_info . channels; location: 450 cross_layer: 1 file: flac.c
psf -> sf . samplerate = metadata -> data . stream_info . sample_rate; location: 451 cross_layer: 1 file: flac.c
psf -> sf . frames = metadata -> data . stream_info . total_samples; location: 452 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "FLAC Stream Metadata\n  Channels    : %d\n  Sample rate : %d\n" , psf -> sf . channels , psf -> sf . samplerate ); location: 454 cross_layer: 1 file: flac.c
if ( psf -> sf . frames == 0 )  location: 456 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "  Frames      : 0 (bumping to SF_COUNT_MAX)\n" ); location: 457 cross_layer: 1 file: flac.c
psf -> sf . frames = SF_COUNT_MAX; location: 458 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "  Frames      : %D\n" , psf -> sf . frames ); location: 461 cross_layer: 1 file: flac.c
psf -> sf . format |= SF_FORMAT_PCM_S8; location: 465 cross_layer: 1 file: flac.c
psf -> sf . format |= SF_FORMAT_PCM_16; location: 469 cross_layer: 1 file: flac.c
psf -> sf . format |= SF_FORMAT_PCM_24; location: 473 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "sf_flac_meta_callback : bits_per_sample %d not yet implemented.\n" , metadata -> data . stream_info . bits_per_sample ); location: 477 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "  Bit width   : %d\n" , bitwidth ); location: 482 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Vorbis Comment Metadata\n" ); location: 486 cross_layer: 1 file: flac.c
sf_flac_meta_get_vorbiscomments ( psf , metadata ); location: 487 cross_layer: 1 file: flac.c
static void
sf_flac_meta_get_vorbiscomments (SF_PRIVATE *psf, const FLAC__StreamMetadata *metadata) location: 396 cross_layer: 2 file: flac.c
tag_num = FLAC__metadata_object_vorbiscomment_find_entry_from ( metadata , 0 , tags [ k ] . tag ); location: 414 cross_layer: 2 file: flac.c
if ( tag_num < 0 )  location: 416 cross_layer: 2 file: flac.c
value = ( const char * ) metadata -> data . vorbis_comment . comments [ tag_num ] . entry; location: 419 cross_layer: 2 file: flac.c
if ( ( cptr = strchr ( value , '=' ) ) != NULL )  location: 420 cross_layer: 2 file: flac.c
value = cptr + 1; location: 421 cross_layer: 2 file: flac.c
psf_log_printf ( psf , "  %-12s : %s\n" , tags [ k ] . tag , value ); location: 423 cross_layer: 2 file: flac.c
psf_store_string ( psf , tags [ k ] . type , value ); location: 424 cross_layer: 2 file: flac.c
psf_log_printf ( psf , "Padding Metadata\n" ); location: 491 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Application Metadata\n" ); location: 495 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Seektable Metadata\n" ); location: 499 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Cuesheet Metadata\n" ); location: 503 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Picture Metadata\n" ); location: 507 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "Undefined Metadata\n" ); location: 511 cross_layer: 1 file: flac.c
psf_log_printf ( psf , "sf_flac_meta_callback : metadata-type %d not yet implemented.\n" , metadata -> type ); location: 515 cross_layer: 1 file: flac.c
------------------------------
