1 @@ testCode/CVE-2018-14567_CWE-835_2240fbf5912054af025fb6e01e26375100275e74_xzlib.c_NEW.c @@ xz_decomp @@ 594 @@ ['state->how', 'ret'] @@ {strm}
static int
xz_decomp(xz_statep state) location: 530 cross_layer: 1 file: xzlib.c
int ret ; location: 532 cross_layer: 1 file: xzlib.c
lzma_stream * strm = & ( state -> strm ) ; location: 535 cross_layer: 1 file: xzlib.c
lzma_action action = LZMA_RUN ; location: 537 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in == 0 && xz_avail ( state ) == - 1 )  location: 543 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in == 0 )  location: 545 cross_layer: 1 file: xzlib.c
if ( state -> eof )  location: 549 cross_layer: 1 file: xzlib.c
action = LZMA_FINISH; location: 550 cross_layer: 1 file: xzlib.c
if ( state -> how == GZIP )  location: 554 cross_layer: 1 file: xzlib.c
state -> zstrm . avail_in = ( uInt ) state -> strm . avail_in; location: 555 cross_layer: 1 file: xzlib.c
state -> zstrm . next_in = ( Bytef * ) state -> strm . next_in; location: 556 cross_layer: 1 file: xzlib.c
state -> zstrm . avail_out = ( uInt ) state -> strm . avail_out; location: 557 cross_layer: 1 file: xzlib.c
state -> zstrm . next_out = ( Bytef * ) state -> strm . next_out; location: 558 cross_layer: 1 file: xzlib.c
ret = inflate ( & state -> zstrm , Z_NO_FLUSH ); location: 559 cross_layer: 1 file: xzlib.c
if ( ret == Z_STREAM_ERROR || ret == Z_NEED_DICT )  location: 560 cross_layer: 1 file: xzlib.c
if ( ret == Z_MEM_ERROR )  location: 569 cross_layer: 1 file: xzlib.c
ret = LZMA_MEM_ERROR; location: 570 cross_layer: 1 file: xzlib.c
if ( ret == Z_DATA_ERROR )  location: 571 cross_layer: 1 file: xzlib.c
ret = LZMA_DATA_ERROR; location: 572 cross_layer: 1 file: xzlib.c
if ( ret == Z_STREAM_END )  location: 573 cross_layer: 1 file: xzlib.c
ret = LZMA_STREAM_END; location: 574 cross_layer: 1 file: xzlib.c
state -> strm . avail_in = state -> zstrm . avail_in; location: 575 cross_layer: 1 file: xzlib.c
state -> strm . next_in = state -> zstrm . next_in; location: 576 cross_layer: 1 file: xzlib.c
state -> strm . avail_out = state -> zstrm . avail_out; location: 577 cross_layer: 1 file: xzlib.c
state -> strm . next_out = state -> zstrm . next_out; location: 578 cross_layer: 1 file: xzlib.c
ret = lzma_code ( strm , action ); location: 581 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_MEM_ERROR )  location: 582 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_DATA_ERROR )  location: 586 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_PROG_ERROR )  location: 590 cross_layer: 1 file: xzlib.c
if ( ( state -> how != GZIP ) && ( ret != LZMA_OK ) && ( ret != LZMA_STREAM_END ) )  location: 594 cross_layer: 1 file: xzlib.c
xz_error ( state , ret , "lzma error" ); location: 596 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
while ( strm -> avail_out && ret != LZMA_STREAM_END )  location: 599 cross_layer: 1 file: xzlib.c
state -> have = had - strm -> avail_out; location: 602 cross_layer: 1 file: xzlib.c
state -> next = strm -> next_out - state -> have; location: 603 cross_layer: 1 file: xzlib.c
state -> zstrm . adler = crc32 ( state -> zstrm . adler , state -> next , state -> have ); location: 605 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_STREAM_END )  location: 609 cross_layer: 1 file: xzlib.c
if ( state -> how == GZIP )  location: 611 cross_layer: 1 file: xzlib.c
if ( gz_next4 ( state , & crc ) == - 1 || gz_next4 ( state , & len ) == - 1 )  location: 612 cross_layer: 1 file: xzlib.c
static int
gz_next4(xz_statep state, unsigned long *ret) location: 366 cross_layer: 2 file: xzlib.c
z_streamp strm = & ( state -> zstrm ) ; location: 370 cross_layer: 2 file: xzlib.c
* ret = val; location: 379 cross_layer: 2 file: xzlib.c
static int
gz_next4(xz_statep state, unsigned long *ret) location: 366 cross_layer: 2 file: xzlib.c
z_streamp strm = & ( state -> zstrm ) ; location: 370 cross_layer: 2 file: xzlib.c
* ret = val; location: 379 cross_layer: 2 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "unexpected end of file" ); location: 613 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
if ( crc != state -> zstrm . adler )  location: 616 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "incorrect data check" ); location: 617 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
if ( len != ( state -> zstrm . total_out & 0xffffffffL ) )  location: 620 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "incorrect length check" ); location: 621 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
state -> strm . avail_in = 0; location: 624 cross_layer: 1 file: xzlib.c
state -> strm . next_in = NULL; location: 625 cross_layer: 1 file: xzlib.c
state -> strm . avail_out = 0; location: 626 cross_layer: 1 file: xzlib.c
state -> strm . next_out = NULL; location: 627 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in != 0 || ! state -> eof )  location: 630 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "trailing garbage" ); location: 631 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
state -> how = LOOK; location: 634 cross_layer: 1 file: xzlib.c
if ( xz_decomp ( state ) == - 1 )  location: 661 cross_layer: 2 file: xzlib.c
if ( xz_make ( state ) == - 1 )  location: 752 cross_layer: 3 file: xzlib.c
------------------------------
2 @@ testCode/CVE-2018-14567_CWE-835_2240fbf5912054af025fb6e01e26375100275e74_xzlib.c_NEW.c @@ xz_decomp @@ 594 @@ ['state->how', 'ret'] @@ {strm}
static int
xz_decomp(xz_statep state) location: 530 cross_layer: 1 file: xzlib.c
int ret ; location: 532 cross_layer: 1 file: xzlib.c
lzma_stream * strm = & ( state -> strm ) ; location: 535 cross_layer: 1 file: xzlib.c
lzma_action action = LZMA_RUN ; location: 537 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in == 0 && xz_avail ( state ) == - 1 )  location: 543 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in == 0 )  location: 545 cross_layer: 1 file: xzlib.c
if ( state -> eof )  location: 549 cross_layer: 1 file: xzlib.c
action = LZMA_FINISH; location: 550 cross_layer: 1 file: xzlib.c
if ( state -> how == GZIP )  location: 554 cross_layer: 1 file: xzlib.c
state -> zstrm . avail_in = ( uInt ) state -> strm . avail_in; location: 555 cross_layer: 1 file: xzlib.c
state -> zstrm . next_in = ( Bytef * ) state -> strm . next_in; location: 556 cross_layer: 1 file: xzlib.c
state -> zstrm . avail_out = ( uInt ) state -> strm . avail_out; location: 557 cross_layer: 1 file: xzlib.c
state -> zstrm . next_out = ( Bytef * ) state -> strm . next_out; location: 558 cross_layer: 1 file: xzlib.c
ret = inflate ( & state -> zstrm , Z_NO_FLUSH ); location: 559 cross_layer: 1 file: xzlib.c
if ( ret == Z_STREAM_ERROR || ret == Z_NEED_DICT )  location: 560 cross_layer: 1 file: xzlib.c
if ( ret == Z_MEM_ERROR )  location: 569 cross_layer: 1 file: xzlib.c
ret = LZMA_MEM_ERROR; location: 570 cross_layer: 1 file: xzlib.c
if ( ret == Z_DATA_ERROR )  location: 571 cross_layer: 1 file: xzlib.c
ret = LZMA_DATA_ERROR; location: 572 cross_layer: 1 file: xzlib.c
if ( ret == Z_STREAM_END )  location: 573 cross_layer: 1 file: xzlib.c
ret = LZMA_STREAM_END; location: 574 cross_layer: 1 file: xzlib.c
state -> strm . avail_in = state -> zstrm . avail_in; location: 575 cross_layer: 1 file: xzlib.c
state -> strm . next_in = state -> zstrm . next_in; location: 576 cross_layer: 1 file: xzlib.c
state -> strm . avail_out = state -> zstrm . avail_out; location: 577 cross_layer: 1 file: xzlib.c
state -> strm . next_out = state -> zstrm . next_out; location: 578 cross_layer: 1 file: xzlib.c
ret = lzma_code ( strm , action ); location: 581 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_MEM_ERROR )  location: 582 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_DATA_ERROR )  location: 586 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_PROG_ERROR )  location: 590 cross_layer: 1 file: xzlib.c
if ( ( state -> how != GZIP ) && ( ret != LZMA_OK ) && ( ret != LZMA_STREAM_END ) )  location: 594 cross_layer: 1 file: xzlib.c
xz_error ( state , ret , "lzma error" ); location: 596 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
while ( strm -> avail_out && ret != LZMA_STREAM_END )  location: 599 cross_layer: 1 file: xzlib.c
state -> have = had - strm -> avail_out; location: 602 cross_layer: 1 file: xzlib.c
state -> next = strm -> next_out - state -> have; location: 603 cross_layer: 1 file: xzlib.c
state -> zstrm . adler = crc32 ( state -> zstrm . adler , state -> next , state -> have ); location: 605 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_STREAM_END )  location: 609 cross_layer: 1 file: xzlib.c
if ( state -> how == GZIP )  location: 611 cross_layer: 1 file: xzlib.c
if ( gz_next4 ( state , & crc ) == - 1 || gz_next4 ( state , & len ) == - 1 )  location: 612 cross_layer: 1 file: xzlib.c
static int
gz_next4(xz_statep state, unsigned long *ret) location: 366 cross_layer: 2 file: xzlib.c
z_streamp strm = & ( state -> zstrm ) ; location: 370 cross_layer: 2 file: xzlib.c
* ret = val; location: 379 cross_layer: 2 file: xzlib.c
static int
gz_next4(xz_statep state, unsigned long *ret) location: 366 cross_layer: 2 file: xzlib.c
z_streamp strm = & ( state -> zstrm ) ; location: 370 cross_layer: 2 file: xzlib.c
* ret = val; location: 379 cross_layer: 2 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "unexpected end of file" ); location: 613 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
if ( crc != state -> zstrm . adler )  location: 616 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "incorrect data check" ); location: 617 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
if ( len != ( state -> zstrm . total_out & 0xffffffffL ) )  location: 620 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "incorrect length check" ); location: 621 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
state -> strm . avail_in = 0; location: 624 cross_layer: 1 file: xzlib.c
state -> strm . next_in = NULL; location: 625 cross_layer: 1 file: xzlib.c
state -> strm . avail_out = 0; location: 626 cross_layer: 1 file: xzlib.c
state -> strm . next_out = NULL; location: 627 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in != 0 || ! state -> eof )  location: 630 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "trailing garbage" ); location: 631 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
state -> how = LOOK; location: 634 cross_layer: 1 file: xzlib.c
if ( xz_decomp ( state ) == - 1 )  location: 661 cross_layer: 2 file: xzlib.c
if ( xz_make ( state ) == - 1 )  location: 691 cross_layer: 3 file: xzlib.c
if ( xz_skip ( state , state -> skip ) == - 1 )  location: 729 cross_layer: 4 file: xzlib.c
------------------------------
3 @@ testCode/CVE-2018-14567_CWE-835_2240fbf5912054af025fb6e01e26375100275e74_xzlib.c_NEW.c @@ xz_decomp @@ 594 @@ ['state->how', 'ret'] @@ {strm}
static int
xz_decomp(xz_statep state) location: 530 cross_layer: 1 file: xzlib.c
int ret ; location: 532 cross_layer: 1 file: xzlib.c
lzma_stream * strm = & ( state -> strm ) ; location: 535 cross_layer: 1 file: xzlib.c
lzma_action action = LZMA_RUN ; location: 537 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in == 0 && xz_avail ( state ) == - 1 )  location: 543 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in == 0 )  location: 545 cross_layer: 1 file: xzlib.c
if ( state -> eof )  location: 549 cross_layer: 1 file: xzlib.c
action = LZMA_FINISH; location: 550 cross_layer: 1 file: xzlib.c
if ( state -> how == GZIP )  location: 554 cross_layer: 1 file: xzlib.c
state -> zstrm . avail_in = ( uInt ) state -> strm . avail_in; location: 555 cross_layer: 1 file: xzlib.c
state -> zstrm . next_in = ( Bytef * ) state -> strm . next_in; location: 556 cross_layer: 1 file: xzlib.c
state -> zstrm . avail_out = ( uInt ) state -> strm . avail_out; location: 557 cross_layer: 1 file: xzlib.c
state -> zstrm . next_out = ( Bytef * ) state -> strm . next_out; location: 558 cross_layer: 1 file: xzlib.c
ret = inflate ( & state -> zstrm , Z_NO_FLUSH ); location: 559 cross_layer: 1 file: xzlib.c
if ( ret == Z_STREAM_ERROR || ret == Z_NEED_DICT )  location: 560 cross_layer: 1 file: xzlib.c
if ( ret == Z_MEM_ERROR )  location: 569 cross_layer: 1 file: xzlib.c
ret = LZMA_MEM_ERROR; location: 570 cross_layer: 1 file: xzlib.c
if ( ret == Z_DATA_ERROR )  location: 571 cross_layer: 1 file: xzlib.c
ret = LZMA_DATA_ERROR; location: 572 cross_layer: 1 file: xzlib.c
if ( ret == Z_STREAM_END )  location: 573 cross_layer: 1 file: xzlib.c
ret = LZMA_STREAM_END; location: 574 cross_layer: 1 file: xzlib.c
state -> strm . avail_in = state -> zstrm . avail_in; location: 575 cross_layer: 1 file: xzlib.c
state -> strm . next_in = state -> zstrm . next_in; location: 576 cross_layer: 1 file: xzlib.c
state -> strm . avail_out = state -> zstrm . avail_out; location: 577 cross_layer: 1 file: xzlib.c
state -> strm . next_out = state -> zstrm . next_out; location: 578 cross_layer: 1 file: xzlib.c
ret = lzma_code ( strm , action ); location: 581 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_MEM_ERROR )  location: 582 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_DATA_ERROR )  location: 586 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_PROG_ERROR )  location: 590 cross_layer: 1 file: xzlib.c
if ( ( state -> how != GZIP ) && ( ret != LZMA_OK ) && ( ret != LZMA_STREAM_END ) )  location: 594 cross_layer: 1 file: xzlib.c
xz_error ( state , ret , "lzma error" ); location: 596 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
while ( strm -> avail_out && ret != LZMA_STREAM_END )  location: 599 cross_layer: 1 file: xzlib.c
state -> have = had - strm -> avail_out; location: 602 cross_layer: 1 file: xzlib.c
state -> next = strm -> next_out - state -> have; location: 603 cross_layer: 1 file: xzlib.c
state -> zstrm . adler = crc32 ( state -> zstrm . adler , state -> next , state -> have ); location: 605 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_STREAM_END )  location: 609 cross_layer: 1 file: xzlib.c
if ( state -> how == GZIP )  location: 611 cross_layer: 1 file: xzlib.c
if ( gz_next4 ( state , & crc ) == - 1 || gz_next4 ( state , & len ) == - 1 )  location: 612 cross_layer: 1 file: xzlib.c
static int
gz_next4(xz_statep state, unsigned long *ret) location: 366 cross_layer: 2 file: xzlib.c
z_streamp strm = & ( state -> zstrm ) ; location: 370 cross_layer: 2 file: xzlib.c
* ret = val; location: 379 cross_layer: 2 file: xzlib.c
static int
gz_next4(xz_statep state, unsigned long *ret) location: 366 cross_layer: 2 file: xzlib.c
z_streamp strm = & ( state -> zstrm ) ; location: 370 cross_layer: 2 file: xzlib.c
* ret = val; location: 379 cross_layer: 2 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "unexpected end of file" ); location: 613 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
if ( crc != state -> zstrm . adler )  location: 616 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "incorrect data check" ); location: 617 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
if ( len != ( state -> zstrm . total_out & 0xffffffffL ) )  location: 620 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "incorrect length check" ); location: 621 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
state -> strm . avail_in = 0; location: 624 cross_layer: 1 file: xzlib.c
state -> strm . next_in = NULL; location: 625 cross_layer: 1 file: xzlib.c
state -> strm . avail_out = 0; location: 626 cross_layer: 1 file: xzlib.c
state -> strm . next_out = NULL; location: 627 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in != 0 || ! state -> eof )  location: 630 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "trailing garbage" ); location: 631 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
state -> how = LOOK; location: 634 cross_layer: 1 file: xzlib.c
if ( xz_decomp ( state ) == - 1 )  location: 769 cross_layer: 2 file: xzlib.c
------------------------------
4 @@ testCode/CVE-2018-14567_CWE-835_2240fbf5912054af025fb6e01e26375100275e74_xzlib.c_NEW.c @@ xz_decomp @@ 596 @@ ['ret', 'state'] @@ {strm}
static int
xz_decomp(xz_statep state) location: 530 cross_layer: 1 file: xzlib.c
int ret ; location: 532 cross_layer: 1 file: xzlib.c
lzma_stream * strm = & ( state -> strm ) ; location: 535 cross_layer: 1 file: xzlib.c
lzma_action action = LZMA_RUN ; location: 537 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in == 0 && xz_avail ( state ) == - 1 )  location: 543 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in == 0 )  location: 545 cross_layer: 1 file: xzlib.c
if ( state -> eof )  location: 549 cross_layer: 1 file: xzlib.c
action = LZMA_FINISH; location: 550 cross_layer: 1 file: xzlib.c
if ( state -> how == GZIP )  location: 554 cross_layer: 1 file: xzlib.c
state -> zstrm . avail_in = ( uInt ) state -> strm . avail_in; location: 555 cross_layer: 1 file: xzlib.c
state -> zstrm . next_in = ( Bytef * ) state -> strm . next_in; location: 556 cross_layer: 1 file: xzlib.c
state -> zstrm . avail_out = ( uInt ) state -> strm . avail_out; location: 557 cross_layer: 1 file: xzlib.c
state -> zstrm . next_out = ( Bytef * ) state -> strm . next_out; location: 558 cross_layer: 1 file: xzlib.c
ret = inflate ( & state -> zstrm , Z_NO_FLUSH ); location: 559 cross_layer: 1 file: xzlib.c
if ( ret == Z_STREAM_ERROR || ret == Z_NEED_DICT )  location: 560 cross_layer: 1 file: xzlib.c
if ( ret == Z_MEM_ERROR )  location: 569 cross_layer: 1 file: xzlib.c
ret = LZMA_MEM_ERROR; location: 570 cross_layer: 1 file: xzlib.c
if ( ret == Z_DATA_ERROR )  location: 571 cross_layer: 1 file: xzlib.c
ret = LZMA_DATA_ERROR; location: 572 cross_layer: 1 file: xzlib.c
if ( ret == Z_STREAM_END )  location: 573 cross_layer: 1 file: xzlib.c
ret = LZMA_STREAM_END; location: 574 cross_layer: 1 file: xzlib.c
state -> strm . avail_in = state -> zstrm . avail_in; location: 575 cross_layer: 1 file: xzlib.c
state -> strm . next_in = state -> zstrm . next_in; location: 576 cross_layer: 1 file: xzlib.c
state -> strm . avail_out = state -> zstrm . avail_out; location: 577 cross_layer: 1 file: xzlib.c
state -> strm . next_out = state -> zstrm . next_out; location: 578 cross_layer: 1 file: xzlib.c
ret = lzma_code ( strm , action ); location: 581 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_MEM_ERROR )  location: 582 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_DATA_ERROR )  location: 586 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_PROG_ERROR )  location: 590 cross_layer: 1 file: xzlib.c
if ( ( state -> how != GZIP ) && ( ret != LZMA_OK ) && ( ret != LZMA_STREAM_END ) )  location: 594 cross_layer: 1 file: xzlib.c
xz_error ( state , ret , "lzma error" ); location: 596 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
while ( strm -> avail_out && ret != LZMA_STREAM_END )  location: 599 cross_layer: 1 file: xzlib.c
state -> have = had - strm -> avail_out; location: 602 cross_layer: 1 file: xzlib.c
state -> next = strm -> next_out - state -> have; location: 603 cross_layer: 1 file: xzlib.c
state -> zstrm . adler = crc32 ( state -> zstrm . adler , state -> next , state -> have ); location: 605 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_STREAM_END )  location: 609 cross_layer: 1 file: xzlib.c
if ( state -> how == GZIP )  location: 611 cross_layer: 1 file: xzlib.c
if ( gz_next4 ( state , & crc ) == - 1 || gz_next4 ( state , & len ) == - 1 )  location: 612 cross_layer: 1 file: xzlib.c
static int
gz_next4(xz_statep state, unsigned long *ret) location: 366 cross_layer: 2 file: xzlib.c
z_streamp strm = & ( state -> zstrm ) ; location: 370 cross_layer: 2 file: xzlib.c
* ret = val; location: 379 cross_layer: 2 file: xzlib.c
static int
gz_next4(xz_statep state, unsigned long *ret) location: 366 cross_layer: 2 file: xzlib.c
z_streamp strm = & ( state -> zstrm ) ; location: 370 cross_layer: 2 file: xzlib.c
* ret = val; location: 379 cross_layer: 2 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "unexpected end of file" ); location: 613 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
if ( crc != state -> zstrm . adler )  location: 616 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "incorrect data check" ); location: 617 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
if ( len != ( state -> zstrm . total_out & 0xffffffffL ) )  location: 620 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "incorrect length check" ); location: 621 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
state -> strm . avail_in = 0; location: 624 cross_layer: 1 file: xzlib.c
state -> strm . next_in = NULL; location: 625 cross_layer: 1 file: xzlib.c
state -> strm . avail_out = 0; location: 626 cross_layer: 1 file: xzlib.c
state -> strm . next_out = NULL; location: 627 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in != 0 || ! state -> eof )  location: 630 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "trailing garbage" ); location: 631 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
state -> how = LOOK; location: 634 cross_layer: 1 file: xzlib.c
if ( xz_decomp ( state ) == - 1 )  location: 661 cross_layer: 2 file: xzlib.c
if ( xz_make ( state ) == - 1 )  location: 752 cross_layer: 3 file: xzlib.c
------------------------------
5 @@ testCode/CVE-2018-14567_CWE-835_2240fbf5912054af025fb6e01e26375100275e74_xzlib.c_NEW.c @@ xz_decomp @@ 596 @@ ['ret', 'state'] @@ {strm}
static int
xz_decomp(xz_statep state) location: 530 cross_layer: 1 file: xzlib.c
int ret ; location: 532 cross_layer: 1 file: xzlib.c
lzma_stream * strm = & ( state -> strm ) ; location: 535 cross_layer: 1 file: xzlib.c
lzma_action action = LZMA_RUN ; location: 537 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in == 0 && xz_avail ( state ) == - 1 )  location: 543 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in == 0 )  location: 545 cross_layer: 1 file: xzlib.c
if ( state -> eof )  location: 549 cross_layer: 1 file: xzlib.c
action = LZMA_FINISH; location: 550 cross_layer: 1 file: xzlib.c
if ( state -> how == GZIP )  location: 554 cross_layer: 1 file: xzlib.c
state -> zstrm . avail_in = ( uInt ) state -> strm . avail_in; location: 555 cross_layer: 1 file: xzlib.c
state -> zstrm . next_in = ( Bytef * ) state -> strm . next_in; location: 556 cross_layer: 1 file: xzlib.c
state -> zstrm . avail_out = ( uInt ) state -> strm . avail_out; location: 557 cross_layer: 1 file: xzlib.c
state -> zstrm . next_out = ( Bytef * ) state -> strm . next_out; location: 558 cross_layer: 1 file: xzlib.c
ret = inflate ( & state -> zstrm , Z_NO_FLUSH ); location: 559 cross_layer: 1 file: xzlib.c
if ( ret == Z_STREAM_ERROR || ret == Z_NEED_DICT )  location: 560 cross_layer: 1 file: xzlib.c
if ( ret == Z_MEM_ERROR )  location: 569 cross_layer: 1 file: xzlib.c
ret = LZMA_MEM_ERROR; location: 570 cross_layer: 1 file: xzlib.c
if ( ret == Z_DATA_ERROR )  location: 571 cross_layer: 1 file: xzlib.c
ret = LZMA_DATA_ERROR; location: 572 cross_layer: 1 file: xzlib.c
if ( ret == Z_STREAM_END )  location: 573 cross_layer: 1 file: xzlib.c
ret = LZMA_STREAM_END; location: 574 cross_layer: 1 file: xzlib.c
state -> strm . avail_in = state -> zstrm . avail_in; location: 575 cross_layer: 1 file: xzlib.c
state -> strm . next_in = state -> zstrm . next_in; location: 576 cross_layer: 1 file: xzlib.c
state -> strm . avail_out = state -> zstrm . avail_out; location: 577 cross_layer: 1 file: xzlib.c
state -> strm . next_out = state -> zstrm . next_out; location: 578 cross_layer: 1 file: xzlib.c
ret = lzma_code ( strm , action ); location: 581 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_MEM_ERROR )  location: 582 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_DATA_ERROR )  location: 586 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_PROG_ERROR )  location: 590 cross_layer: 1 file: xzlib.c
if ( ( state -> how != GZIP ) && ( ret != LZMA_OK ) && ( ret != LZMA_STREAM_END ) )  location: 594 cross_layer: 1 file: xzlib.c
xz_error ( state , ret , "lzma error" ); location: 596 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
while ( strm -> avail_out && ret != LZMA_STREAM_END )  location: 599 cross_layer: 1 file: xzlib.c
state -> have = had - strm -> avail_out; location: 602 cross_layer: 1 file: xzlib.c
state -> next = strm -> next_out - state -> have; location: 603 cross_layer: 1 file: xzlib.c
state -> zstrm . adler = crc32 ( state -> zstrm . adler , state -> next , state -> have ); location: 605 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_STREAM_END )  location: 609 cross_layer: 1 file: xzlib.c
if ( state -> how == GZIP )  location: 611 cross_layer: 1 file: xzlib.c
if ( gz_next4 ( state , & crc ) == - 1 || gz_next4 ( state , & len ) == - 1 )  location: 612 cross_layer: 1 file: xzlib.c
static int
gz_next4(xz_statep state, unsigned long *ret) location: 366 cross_layer: 2 file: xzlib.c
z_streamp strm = & ( state -> zstrm ) ; location: 370 cross_layer: 2 file: xzlib.c
* ret = val; location: 379 cross_layer: 2 file: xzlib.c
static int
gz_next4(xz_statep state, unsigned long *ret) location: 366 cross_layer: 2 file: xzlib.c
z_streamp strm = & ( state -> zstrm ) ; location: 370 cross_layer: 2 file: xzlib.c
* ret = val; location: 379 cross_layer: 2 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "unexpected end of file" ); location: 613 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
if ( crc != state -> zstrm . adler )  location: 616 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "incorrect data check" ); location: 617 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
if ( len != ( state -> zstrm . total_out & 0xffffffffL ) )  location: 620 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "incorrect length check" ); location: 621 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
state -> strm . avail_in = 0; location: 624 cross_layer: 1 file: xzlib.c
state -> strm . next_in = NULL; location: 625 cross_layer: 1 file: xzlib.c
state -> strm . avail_out = 0; location: 626 cross_layer: 1 file: xzlib.c
state -> strm . next_out = NULL; location: 627 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in != 0 || ! state -> eof )  location: 630 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "trailing garbage" ); location: 631 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
state -> how = LOOK; location: 634 cross_layer: 1 file: xzlib.c
if ( xz_decomp ( state ) == - 1 )  location: 661 cross_layer: 2 file: xzlib.c
if ( xz_make ( state ) == - 1 )  location: 691 cross_layer: 3 file: xzlib.c
if ( xz_skip ( state , state -> skip ) == - 1 )  location: 729 cross_layer: 4 file: xzlib.c
------------------------------
6 @@ testCode/CVE-2018-14567_CWE-835_2240fbf5912054af025fb6e01e26375100275e74_xzlib.c_NEW.c @@ xz_decomp @@ 596 @@ ['ret', 'state'] @@ {strm}
static int
xz_decomp(xz_statep state) location: 530 cross_layer: 1 file: xzlib.c
int ret ; location: 532 cross_layer: 1 file: xzlib.c
lzma_stream * strm = & ( state -> strm ) ; location: 535 cross_layer: 1 file: xzlib.c
lzma_action action = LZMA_RUN ; location: 537 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in == 0 && xz_avail ( state ) == - 1 )  location: 543 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in == 0 )  location: 545 cross_layer: 1 file: xzlib.c
if ( state -> eof )  location: 549 cross_layer: 1 file: xzlib.c
action = LZMA_FINISH; location: 550 cross_layer: 1 file: xzlib.c
if ( state -> how == GZIP )  location: 554 cross_layer: 1 file: xzlib.c
state -> zstrm . avail_in = ( uInt ) state -> strm . avail_in; location: 555 cross_layer: 1 file: xzlib.c
state -> zstrm . next_in = ( Bytef * ) state -> strm . next_in; location: 556 cross_layer: 1 file: xzlib.c
state -> zstrm . avail_out = ( uInt ) state -> strm . avail_out; location: 557 cross_layer: 1 file: xzlib.c
state -> zstrm . next_out = ( Bytef * ) state -> strm . next_out; location: 558 cross_layer: 1 file: xzlib.c
ret = inflate ( & state -> zstrm , Z_NO_FLUSH ); location: 559 cross_layer: 1 file: xzlib.c
if ( ret == Z_STREAM_ERROR || ret == Z_NEED_DICT )  location: 560 cross_layer: 1 file: xzlib.c
if ( ret == Z_MEM_ERROR )  location: 569 cross_layer: 1 file: xzlib.c
ret = LZMA_MEM_ERROR; location: 570 cross_layer: 1 file: xzlib.c
if ( ret == Z_DATA_ERROR )  location: 571 cross_layer: 1 file: xzlib.c
ret = LZMA_DATA_ERROR; location: 572 cross_layer: 1 file: xzlib.c
if ( ret == Z_STREAM_END )  location: 573 cross_layer: 1 file: xzlib.c
ret = LZMA_STREAM_END; location: 574 cross_layer: 1 file: xzlib.c
state -> strm . avail_in = state -> zstrm . avail_in; location: 575 cross_layer: 1 file: xzlib.c
state -> strm . next_in = state -> zstrm . next_in; location: 576 cross_layer: 1 file: xzlib.c
state -> strm . avail_out = state -> zstrm . avail_out; location: 577 cross_layer: 1 file: xzlib.c
state -> strm . next_out = state -> zstrm . next_out; location: 578 cross_layer: 1 file: xzlib.c
ret = lzma_code ( strm , action ); location: 581 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_MEM_ERROR )  location: 582 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_DATA_ERROR )  location: 586 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_PROG_ERROR )  location: 590 cross_layer: 1 file: xzlib.c
if ( ( state -> how != GZIP ) && ( ret != LZMA_OK ) && ( ret != LZMA_STREAM_END ) )  location: 594 cross_layer: 1 file: xzlib.c
xz_error ( state , ret , "lzma error" ); location: 596 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
while ( strm -> avail_out && ret != LZMA_STREAM_END )  location: 599 cross_layer: 1 file: xzlib.c
state -> have = had - strm -> avail_out; location: 602 cross_layer: 1 file: xzlib.c
state -> next = strm -> next_out - state -> have; location: 603 cross_layer: 1 file: xzlib.c
state -> zstrm . adler = crc32 ( state -> zstrm . adler , state -> next , state -> have ); location: 605 cross_layer: 1 file: xzlib.c
if ( ret == LZMA_STREAM_END )  location: 609 cross_layer: 1 file: xzlib.c
if ( state -> how == GZIP )  location: 611 cross_layer: 1 file: xzlib.c
if ( gz_next4 ( state , & crc ) == - 1 || gz_next4 ( state , & len ) == - 1 )  location: 612 cross_layer: 1 file: xzlib.c
static int
gz_next4(xz_statep state, unsigned long *ret) location: 366 cross_layer: 2 file: xzlib.c
z_streamp strm = & ( state -> zstrm ) ; location: 370 cross_layer: 2 file: xzlib.c
* ret = val; location: 379 cross_layer: 2 file: xzlib.c
static int
gz_next4(xz_statep state, unsigned long *ret) location: 366 cross_layer: 2 file: xzlib.c
z_streamp strm = & ( state -> zstrm ) ; location: 370 cross_layer: 2 file: xzlib.c
* ret = val; location: 379 cross_layer: 2 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "unexpected end of file" ); location: 613 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
if ( crc != state -> zstrm . adler )  location: 616 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "incorrect data check" ); location: 617 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
if ( len != ( state -> zstrm . total_out & 0xffffffffL ) )  location: 620 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "incorrect length check" ); location: 621 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
state -> strm . avail_in = 0; location: 624 cross_layer: 1 file: xzlib.c
state -> strm . next_in = NULL; location: 625 cross_layer: 1 file: xzlib.c
state -> strm . avail_out = 0; location: 626 cross_layer: 1 file: xzlib.c
state -> strm . next_out = NULL; location: 627 cross_layer: 1 file: xzlib.c
if ( strm -> avail_in != 0 || ! state -> eof )  location: 630 cross_layer: 1 file: xzlib.c
xz_error ( state , LZMA_DATA_ERROR , "trailing garbage" ); location: 631 cross_layer: 1 file: xzlib.c
static void
xz_error(xz_statep state, int err, const char *msg) location: 89 cross_layer: 2 file: xzlib.c
if ( state -> msg != NULL )  location: 92 cross_layer: 2 file: xzlib.c
if ( state -> err != LZMA_MEM_ERROR )  location: 93 cross_layer: 2 file: xzlib.c
xmlFree ( state -> msg ); location: 94 cross_layer: 2 file: xzlib.c
state -> msg = NULL; location: 95 cross_layer: 2 file: xzlib.c
state -> err = err; location: 99 cross_layer: 2 file: xzlib.c
if ( msg == NULL )  location: 100 cross_layer: 2 file: xzlib.c
if ( err == LZMA_MEM_ERROR )  location: 104 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) msg; location: 105 cross_layer: 2 file: xzlib.c
if ( ( state -> msg = xmlMalloc ( strlen ( state -> path ) + strlen ( msg ) + 3 ) ) == NULL )  location: 110 cross_layer: 2 file: xzlib.c
state -> err = LZMA_MEM_ERROR; location: 112 cross_layer: 2 file: xzlib.c
state -> msg = ( char * ) "out of memory"; location: 113 cross_layer: 2 file: xzlib.c
strcpy ( state -> msg , state -> path ); location: 116 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , ": " ); location: 117 cross_layer: 2 file: xzlib.c
strcat ( state -> msg , msg ); location: 118 cross_layer: 2 file: xzlib.c
state -> how = LOOK; location: 634 cross_layer: 1 file: xzlib.c
if ( xz_decomp ( state ) == - 1 )  location: 769 cross_layer: 2 file: xzlib.c
------------------------------
