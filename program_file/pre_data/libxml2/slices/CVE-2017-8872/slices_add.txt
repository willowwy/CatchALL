1 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11351 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
2 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11351 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
3 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
4 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
5 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
6 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
7 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
8 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
9 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
10 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11263 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
11 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11263 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
12 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12221 cross_layer: 2 file: parser.c
------------------------------
13 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
14 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
15 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
16 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
17 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
18 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
19 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
20 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12199 cross_layer: 2 file: parser.c
------------------------------
21 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 2093 cross_layer: 2 file: parser.c
------------------------------
22 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 2087 cross_layer: 2 file: parser.c
------------------------------
23 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 10845 cross_layer: 4 file: parser.c
------------------------------
24 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 10014 cross_layer: 4 file: parser.c
------------------------------
25 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13680 cross_layer: 4 file: parser.c
------------------------------
26 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13006 cross_layer: 4 file: parser.c
------------------------------
27 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13855 cross_layer: 4 file: parser.c
------------------------------
28 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 4 file: parser.c
------------------------------
29 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 4 file: parser.c
------------------------------
30 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13859 cross_layer: 4 file: parser.c
------------------------------
31 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14614 cross_layer: 4 file: parser.c
------------------------------
32 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14447 cross_layer: 4 file: parser.c
------------------------------
33 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14541 cross_layer: 4 file: parser.c
------------------------------
34 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14175 cross_layer: 4 file: parser.c
------------------------------
35 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14331 cross_layer: 4 file: parser.c
------------------------------
36 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 15196 cross_layer: 4 file: parser.c
------------------------------
37 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11230 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
38 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11230 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
39 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11319 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
40 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11319 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
41 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12486 cross_layer: 2 file: parser.c
------------------------------
42 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , node ); location: 13640 cross_layer: 3 file: parser.c
------------------------------
43 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 12926 cross_layer: 3 file: parser.c
------------------------------
44 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , & list ); location: 7110 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7112 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7114 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7115 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
45 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
46 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
47 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseBalancedChunkMemoryInternal(xmlParserCtxtPtr oldctxt,
const xmlChar *string, void *user_data, xmlNodePtr *lst) location: 13341 cross_layer: 5 file: parser.c
if ( ( ( oldctxt -> depth > 40 ) && ( ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( oldctxt -> depth > 1024 ) )  location: 13354 cross_layer: 5 file: parser.c
if ( lst != NULL )  location: 13360 cross_layer: 5 file: parser.c
* lst = NULL; location: 13361 cross_layer: 5 file: parser.c
if ( string == NULL )  location: 13362 cross_layer: 5 file: parser.c
size = xmlStrlen ( string ); location: 13365 cross_layer: 5 file: parser.c
ctxt = xmlCreateMemoryParserCtxt ( ( char * ) string , size ); location: 13367 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13368 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13369 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13370 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13372 cross_layer: 5 file: parser.c
if ( ctxt -> dict != NULL )  location: 13373 cross_layer: 5 file: parser.c
xmlDictFree ( ctxt -> dict ); location: 13373 cross_layer: 5 file: parser.c
ctxt -> dict = oldctxt -> dict; location: 13374 cross_layer: 5 file: parser.c
ctxt -> input_id = oldctxt -> input_id + 1; location: 13375 cross_layer: 5 file: parser.c
ctxt -> str_xml = xmlDictLookup ( ctxt -> dict , BAD_CAST "xml" , 3 )
ctxt -> str_xmlns = xmlDictLookup ( ctxt -> dict , BAD_CAST "xmlns" , 5 ) location: 13377 cross_layer: 5 file: parser.c
ctxt -> str_xml_ns = xmlDictLookup ( ctxt -> dict , XML_XML_NAMESPACE , 36 ); location: 13378 cross_layer: 5 file: parser.c
for (i = 0;i < oldctxt->nsNr;i += 2) location: 13382 cross_layer: 5 file: parser.c
nsPush ( ctxt , oldctxt -> nsTab [ i ] , oldctxt -> nsTab [ i + 1 ] ); location: 13383 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13387 cross_layer: 5 file: parser.c
ctxt -> sax = oldctxt -> sax; location: 13388 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13389 cross_layer: 5 file: parser.c
ctxt -> replaceEntities = oldctxt -> replaceEntities; location: 13390 cross_layer: 5 file: parser.c
ctxt -> options = oldctxt -> options; location: 13391 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13393 cross_layer: 5 file: parser.c
if ( oldctxt -> myDoc == NULL )  location: 13394 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13397 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13398 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13399 cross_layer: 5 file: parser.c
newDoc -> dict = ctxt -> dict; location: 13403 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13404 cross_layer: 5 file: parser.c
ctxt -> myDoc = newDoc; location: 13405 cross_layer: 5 file: parser.c
ctxt -> myDoc = oldctxt -> myDoc; location: 13407 cross_layer: 5 file: parser.c
content = ctxt -> myDoc -> children; location: 13408 cross_layer: 5 file: parser.c
last = ctxt -> myDoc -> last; location: 13409 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( ctxt -> myDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13411 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13412 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13413 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13414 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13415 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13416 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13417 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = NULL; location: 13421 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = NULL; location: 13422 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ctxt -> myDoc , newRoot ); location: 13423 cross_layer: 5 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13425 cross_layer: 5 file: parser.c
ctxt -> depth = oldctxt -> depth + 1; location: 13426 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13428 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13429 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) || ( oldctxt -> replaceEntities != 0 ) )  location: 13430 cross_layer: 5 file: parser.c
ctxt -> loadsubset |= XML_SKIP_IDS; location: 13434 cross_layer: 5 file: parser.c
ctxt -> dictNames = oldctxt -> dictNames; location: 13436 cross_layer: 5 file: parser.c
ctxt -> attsDefault = oldctxt -> attsDefault; location: 13437 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = oldctxt -> attsSpecial; location: 13438 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13442 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13444 cross_layer: 5 file: parser.c
if ( ctxt -> node != ctxt -> myDoc -> children )  location: 13446 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13447 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13450 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13451 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13454 cross_layer: 5 file: parser.c
if ( ( lst != NULL ) && ( ret == XML_ERR_OK ) )  location: 13459 cross_layer: 5 file: parser.c
cur = ctxt -> myDoc -> children -> children; location: 13466 cross_layer: 5 file: parser.c
* lst = cur; location: 13467 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13468 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) && ( oldctxt -> wellFormed ) && ( oldctxt -> myDoc ) && ( oldctxt -> myDoc -> intSubset ) && ( cur -> type == XML_ELEMENT_NODE ) )  location: 13470 cross_layer: 5 file: parser.c
oldctxt -> valid &= xmlValidateElement ( & oldctxt -> vctxt , oldctxt -> myDoc , cur ); location: 13473 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13477 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13478 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children -> children = NULL; location: 13480 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 13482 cross_layer: 5 file: parser.c
xmlFreeNode ( ctxt -> myDoc -> children ); location: 13483 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = content; location: 13484 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = last; location: 13485 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13492 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13493 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code != XML_ERR_OK )  location: 13498 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13499 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13501 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13502 cross_layer: 5 file: parser.c
ctxt -> attsDefault = NULL; location: 13503 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = NULL; location: 13504 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13505 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13506 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13507 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13510 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
48 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 3 file: parser.c
return ( xmlParseExternalEntityPrivate ( doc , NULL , sax , user_data , depth , URL , ID , lst ) ) ; location: 13286 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
------------------------------
49 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newRoot ); location: 13831 cross_layer: 3 file: parser.c
return xmlParseBalancedChunkMemoryRecover ( doc , sax , user_data , depth , string , lst , 0 ) ; location: 13313 cross_layer: 4 file: parser.c
------------------------------
50 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6941 cross_layer: 2 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 3 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 3 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 3 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 3 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 3 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 3 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 3 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 3 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 3 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 3 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 3 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 3 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 3 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 3 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 3 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 3 file: parser.c
return ( xmlSAXParseDTD ( NULL , ExternalID , SystemID ) ) ; location: 12839 cross_layer: 4 file: parser.c
xmlDtdPtr
xmlSAXParseDTD(xmlSAXHandlerPtr sax, const xmlChar *ExternalID,
const xmlChar *SystemID) location: 12708 cross_layer: 5 file: parser.c
if ( ( ExternalID == NULL ) && ( SystemID == NULL ) )  location: 12715 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12728 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 12731 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 12732 cross_layer: 5 file: parser.c
systemIdCanonic = xmlCanonicPath ( SystemID ); location: 12738 cross_layer: 5 file: parser.c
if ( ( SystemID != NULL ) && ( systemIdCanonic == NULL ) )  location: 12739 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12740 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> resolveEntity != NULL ) )  location: 12748 cross_layer: 5 file: parser.c
input = ctxt -> sax -> resolveEntity ( ctxt -> userData , ExternalID , systemIdCanonic ); location: 12749 cross_layer: 5 file: parser.c
if ( input == NULL )  location: 12751 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12752 cross_layer: 5 file: parser.c
ctxt -> sax = NULL; location: 12752 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12753 cross_layer: 5 file: parser.c
if ( systemIdCanonic != NULL )  location: 12754 cross_layer: 5 file: parser.c
xmlFree ( systemIdCanonic ); location: 12755 cross_layer: 5 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 12762 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12763 cross_layer: 5 file: parser.c
if ( systemIdCanonic != NULL )  location: 12765 cross_layer: 5 file: parser.c
xmlFree ( systemIdCanonic ); location: 12766 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 12769 cross_layer: 5 file: parser.c
enc = xmlDetectCharEncoding ( ctxt -> input -> cur , 4 ); location: 12770 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 12771 cross_layer: 5 file: parser.c
if ( input -> filename == NULL )  location: 12774 cross_layer: 5 file: parser.c
input -> filename = ( char * ) systemIdCanonic; location: 12775 cross_layer: 5 file: parser.c
xmlFree ( systemIdCanonic ); location: 12777 cross_layer: 5 file: parser.c
input -> line = 1; location: 12778 cross_layer: 5 file: parser.c
input -> col = 1; location: 12779 cross_layer: 5 file: parser.c
input -> base = ctxt -> input -> cur; location: 12780 cross_layer: 5 file: parser.c
input -> cur = ctxt -> input -> cur; location: 12781 cross_layer: 5 file: parser.c
input -> free = NULL; location: 12782 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12791 cross_layer: 5 file: parser.c
ctxt -> myDoc -> extSubset = xmlNewDtd ( ctxt -> myDoc , BAD_CAST "none" ,
ExternalID , SystemID ) location: 12797 cross_layer: 5 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 5 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 5 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 5 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 5 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 5 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 5 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 5 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 5 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 5 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 5 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 5 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12820 cross_layer: 5 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 5 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 5 file: parser.c
------------------------------
51 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 5534 cross_layer: 2 file: parser.c
xmlParseEntityDecl ( ctxt ); location: 6791 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
52 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 5534 cross_layer: 2 file: parser.c
xmlParseEntityDecl ( ctxt ); location: 6791 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
53 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 5534 cross_layer: 2 file: parser.c
xmlParseEntityDecl ( ctxt ); location: 6791 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
54 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 10845 cross_layer: 3 file: parser.c
xmlParseExtParsedEnt ( ctxt ); location: 13939 cross_layer: 4 file: parser.c
------------------------------
55 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 10014 cross_layer: 3 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 4 file: parser.c
------------------------------
56 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 10014 cross_layer: 3 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 4 file: parser.c
------------------------------
57 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13680 cross_layer: 3 file: parser.c
------------------------------
58 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13006 cross_layer: 3 file: parser.c
------------------------------
59 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13855 cross_layer: 3 file: parser.c
return xmlParseBalancedChunkMemoryRecover ( doc , sax , user_data , depth , string , lst , 0 ) ; location: 13313 cross_layer: 4 file: parser.c
------------------------------
60 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , & list ); location: 7110 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7112 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7114 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7115 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
61 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
62 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
63 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseBalancedChunkMemoryInternal(xmlParserCtxtPtr oldctxt,
const xmlChar *string, void *user_data, xmlNodePtr *lst) location: 13341 cross_layer: 5 file: parser.c
if ( ( ( oldctxt -> depth > 40 ) && ( ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( oldctxt -> depth > 1024 ) )  location: 13354 cross_layer: 5 file: parser.c
if ( lst != NULL )  location: 13360 cross_layer: 5 file: parser.c
* lst = NULL; location: 13361 cross_layer: 5 file: parser.c
if ( string == NULL )  location: 13362 cross_layer: 5 file: parser.c
size = xmlStrlen ( string ); location: 13365 cross_layer: 5 file: parser.c
ctxt = xmlCreateMemoryParserCtxt ( ( char * ) string , size ); location: 13367 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13368 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13369 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13370 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13372 cross_layer: 5 file: parser.c
if ( ctxt -> dict != NULL )  location: 13373 cross_layer: 5 file: parser.c
xmlDictFree ( ctxt -> dict ); location: 13373 cross_layer: 5 file: parser.c
ctxt -> dict = oldctxt -> dict; location: 13374 cross_layer: 5 file: parser.c
ctxt -> input_id = oldctxt -> input_id + 1; location: 13375 cross_layer: 5 file: parser.c
ctxt -> str_xml = xmlDictLookup ( ctxt -> dict , BAD_CAST "xml" , 3 )
ctxt -> str_xmlns = xmlDictLookup ( ctxt -> dict , BAD_CAST "xmlns" , 5 ) location: 13377 cross_layer: 5 file: parser.c
ctxt -> str_xml_ns = xmlDictLookup ( ctxt -> dict , XML_XML_NAMESPACE , 36 ); location: 13378 cross_layer: 5 file: parser.c
for (i = 0;i < oldctxt->nsNr;i += 2) location: 13382 cross_layer: 5 file: parser.c
nsPush ( ctxt , oldctxt -> nsTab [ i ] , oldctxt -> nsTab [ i + 1 ] ); location: 13383 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13387 cross_layer: 5 file: parser.c
ctxt -> sax = oldctxt -> sax; location: 13388 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13389 cross_layer: 5 file: parser.c
ctxt -> replaceEntities = oldctxt -> replaceEntities; location: 13390 cross_layer: 5 file: parser.c
ctxt -> options = oldctxt -> options; location: 13391 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13393 cross_layer: 5 file: parser.c
if ( oldctxt -> myDoc == NULL )  location: 13394 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13397 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13398 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13399 cross_layer: 5 file: parser.c
newDoc -> dict = ctxt -> dict; location: 13403 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13404 cross_layer: 5 file: parser.c
ctxt -> myDoc = newDoc; location: 13405 cross_layer: 5 file: parser.c
ctxt -> myDoc = oldctxt -> myDoc; location: 13407 cross_layer: 5 file: parser.c
content = ctxt -> myDoc -> children; location: 13408 cross_layer: 5 file: parser.c
last = ctxt -> myDoc -> last; location: 13409 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( ctxt -> myDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13411 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13412 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13413 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13414 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13415 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13416 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13417 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = NULL; location: 13421 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = NULL; location: 13422 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ctxt -> myDoc , newRoot ); location: 13423 cross_layer: 5 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13425 cross_layer: 5 file: parser.c
ctxt -> depth = oldctxt -> depth + 1; location: 13426 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13428 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13429 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) || ( oldctxt -> replaceEntities != 0 ) )  location: 13430 cross_layer: 5 file: parser.c
ctxt -> loadsubset |= XML_SKIP_IDS; location: 13434 cross_layer: 5 file: parser.c
ctxt -> dictNames = oldctxt -> dictNames; location: 13436 cross_layer: 5 file: parser.c
ctxt -> attsDefault = oldctxt -> attsDefault; location: 13437 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = oldctxt -> attsSpecial; location: 13438 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13442 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13444 cross_layer: 5 file: parser.c
if ( ctxt -> node != ctxt -> myDoc -> children )  location: 13446 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13447 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13450 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13451 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13454 cross_layer: 5 file: parser.c
if ( ( lst != NULL ) && ( ret == XML_ERR_OK ) )  location: 13459 cross_layer: 5 file: parser.c
cur = ctxt -> myDoc -> children -> children; location: 13466 cross_layer: 5 file: parser.c
* lst = cur; location: 13467 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13468 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) && ( oldctxt -> wellFormed ) && ( oldctxt -> myDoc ) && ( oldctxt -> myDoc -> intSubset ) && ( cur -> type == XML_ELEMENT_NODE ) )  location: 13470 cross_layer: 5 file: parser.c
oldctxt -> valid &= xmlValidateElement ( & oldctxt -> vctxt , oldctxt -> myDoc , cur ); location: 13473 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13477 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13478 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children -> children = NULL; location: 13480 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 13482 cross_layer: 5 file: parser.c
xmlFreeNode ( ctxt -> myDoc -> children ); location: 13483 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = content; location: 13484 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = last; location: 13485 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13492 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13493 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code != XML_ERR_OK )  location: 13498 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13499 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13501 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13502 cross_layer: 5 file: parser.c
ctxt -> attsDefault = NULL; location: 13503 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = NULL; location: 13504 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13505 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13506 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13507 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13510 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
64 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 3 file: parser.c
return ( xmlParseExternalEntityPrivate ( doc , NULL , sax , user_data , depth , URL , ID , lst ) ) ; location: 13286 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
------------------------------
65 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13859 cross_layer: 3 file: parser.c
return xmlParseBalancedChunkMemoryRecover ( doc , sax , user_data , depth , string , lst , 0 ) ; location: 13313 cross_layer: 4 file: parser.c
------------------------------
66 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
67 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
68 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
69 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
70 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
71 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
72 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
73 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12254 cross_layer: 2 file: parser.c
------------------------------
74 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11513 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
75 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11513 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
76 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11835 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
77 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11835 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
78 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
79 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
80 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
81 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
82 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
83 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
84 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12465 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
85 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11351 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
86 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11351 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
87 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
88 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
89 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
90 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
91 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
92 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
93 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
94 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11263 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
95 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11263 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
96 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12221 cross_layer: 2 file: parser.c
------------------------------
97 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
98 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
99 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
100 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
101 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
102 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
103 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
104 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12199 cross_layer: 2 file: parser.c
------------------------------
105 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 2093 cross_layer: 2 file: parser.c
------------------------------
106 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 2087 cross_layer: 2 file: parser.c
------------------------------
107 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 10845 cross_layer: 4 file: parser.c
------------------------------
108 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 10014 cross_layer: 4 file: parser.c
------------------------------
109 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13680 cross_layer: 4 file: parser.c
------------------------------
110 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13006 cross_layer: 4 file: parser.c
------------------------------
111 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13855 cross_layer: 4 file: parser.c
------------------------------
112 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 4 file: parser.c
------------------------------
113 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 4 file: parser.c
------------------------------
114 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13859 cross_layer: 4 file: parser.c
------------------------------
115 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14614 cross_layer: 4 file: parser.c
------------------------------
116 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14447 cross_layer: 4 file: parser.c
------------------------------
117 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14541 cross_layer: 4 file: parser.c
------------------------------
118 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14175 cross_layer: 4 file: parser.c
------------------------------
119 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14331 cross_layer: 4 file: parser.c
------------------------------
120 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 15196 cross_layer: 4 file: parser.c
------------------------------
121 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11230 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
122 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11230 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
123 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11319 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
124 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11319 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
125 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12486 cross_layer: 2 file: parser.c
------------------------------
126 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , node ); location: 13640 cross_layer: 3 file: parser.c
------------------------------
127 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 12926 cross_layer: 3 file: parser.c
------------------------------
128 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , & list ); location: 7110 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7112 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7114 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7115 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
129 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
130 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
131 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseBalancedChunkMemoryInternal(xmlParserCtxtPtr oldctxt,
const xmlChar *string, void *user_data, xmlNodePtr *lst) location: 13341 cross_layer: 5 file: parser.c
if ( ( ( oldctxt -> depth > 40 ) && ( ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( oldctxt -> depth > 1024 ) )  location: 13354 cross_layer: 5 file: parser.c
if ( lst != NULL )  location: 13360 cross_layer: 5 file: parser.c
* lst = NULL; location: 13361 cross_layer: 5 file: parser.c
if ( string == NULL )  location: 13362 cross_layer: 5 file: parser.c
size = xmlStrlen ( string ); location: 13365 cross_layer: 5 file: parser.c
ctxt = xmlCreateMemoryParserCtxt ( ( char * ) string , size ); location: 13367 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13368 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13369 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13370 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13372 cross_layer: 5 file: parser.c
if ( ctxt -> dict != NULL )  location: 13373 cross_layer: 5 file: parser.c
xmlDictFree ( ctxt -> dict ); location: 13373 cross_layer: 5 file: parser.c
ctxt -> dict = oldctxt -> dict; location: 13374 cross_layer: 5 file: parser.c
ctxt -> input_id = oldctxt -> input_id + 1; location: 13375 cross_layer: 5 file: parser.c
ctxt -> str_xml = xmlDictLookup ( ctxt -> dict , BAD_CAST "xml" , 3 )
ctxt -> str_xmlns = xmlDictLookup ( ctxt -> dict , BAD_CAST "xmlns" , 5 ) location: 13377 cross_layer: 5 file: parser.c
ctxt -> str_xml_ns = xmlDictLookup ( ctxt -> dict , XML_XML_NAMESPACE , 36 ); location: 13378 cross_layer: 5 file: parser.c
for (i = 0;i < oldctxt->nsNr;i += 2) location: 13382 cross_layer: 5 file: parser.c
nsPush ( ctxt , oldctxt -> nsTab [ i ] , oldctxt -> nsTab [ i + 1 ] ); location: 13383 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13387 cross_layer: 5 file: parser.c
ctxt -> sax = oldctxt -> sax; location: 13388 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13389 cross_layer: 5 file: parser.c
ctxt -> replaceEntities = oldctxt -> replaceEntities; location: 13390 cross_layer: 5 file: parser.c
ctxt -> options = oldctxt -> options; location: 13391 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13393 cross_layer: 5 file: parser.c
if ( oldctxt -> myDoc == NULL )  location: 13394 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13397 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13398 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13399 cross_layer: 5 file: parser.c
newDoc -> dict = ctxt -> dict; location: 13403 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13404 cross_layer: 5 file: parser.c
ctxt -> myDoc = newDoc; location: 13405 cross_layer: 5 file: parser.c
ctxt -> myDoc = oldctxt -> myDoc; location: 13407 cross_layer: 5 file: parser.c
content = ctxt -> myDoc -> children; location: 13408 cross_layer: 5 file: parser.c
last = ctxt -> myDoc -> last; location: 13409 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( ctxt -> myDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13411 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13412 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13413 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13414 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13415 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13416 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13417 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = NULL; location: 13421 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = NULL; location: 13422 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ctxt -> myDoc , newRoot ); location: 13423 cross_layer: 5 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13425 cross_layer: 5 file: parser.c
ctxt -> depth = oldctxt -> depth + 1; location: 13426 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13428 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13429 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) || ( oldctxt -> replaceEntities != 0 ) )  location: 13430 cross_layer: 5 file: parser.c
ctxt -> loadsubset |= XML_SKIP_IDS; location: 13434 cross_layer: 5 file: parser.c
ctxt -> dictNames = oldctxt -> dictNames; location: 13436 cross_layer: 5 file: parser.c
ctxt -> attsDefault = oldctxt -> attsDefault; location: 13437 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = oldctxt -> attsSpecial; location: 13438 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13442 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13444 cross_layer: 5 file: parser.c
if ( ctxt -> node != ctxt -> myDoc -> children )  location: 13446 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13447 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13450 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13451 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13454 cross_layer: 5 file: parser.c
if ( ( lst != NULL ) && ( ret == XML_ERR_OK ) )  location: 13459 cross_layer: 5 file: parser.c
cur = ctxt -> myDoc -> children -> children; location: 13466 cross_layer: 5 file: parser.c
* lst = cur; location: 13467 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13468 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) && ( oldctxt -> wellFormed ) && ( oldctxt -> myDoc ) && ( oldctxt -> myDoc -> intSubset ) && ( cur -> type == XML_ELEMENT_NODE ) )  location: 13470 cross_layer: 5 file: parser.c
oldctxt -> valid &= xmlValidateElement ( & oldctxt -> vctxt , oldctxt -> myDoc , cur ); location: 13473 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13477 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13478 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children -> children = NULL; location: 13480 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 13482 cross_layer: 5 file: parser.c
xmlFreeNode ( ctxt -> myDoc -> children ); location: 13483 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = content; location: 13484 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = last; location: 13485 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13492 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13493 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code != XML_ERR_OK )  location: 13498 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13499 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13501 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13502 cross_layer: 5 file: parser.c
ctxt -> attsDefault = NULL; location: 13503 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = NULL; location: 13504 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13505 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13506 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13507 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13510 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
132 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 3 file: parser.c
return ( xmlParseExternalEntityPrivate ( doc , NULL , sax , user_data , depth , URL , ID , lst ) ) ; location: 13286 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
------------------------------
133 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newRoot ); location: 13831 cross_layer: 3 file: parser.c
return xmlParseBalancedChunkMemoryRecover ( doc , sax , user_data , depth , string , lst , 0 ) ; location: 13313 cross_layer: 4 file: parser.c
------------------------------
134 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6941 cross_layer: 2 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 3 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 3 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 3 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 3 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 3 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 3 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 3 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 3 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 3 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 3 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 3 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 3 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 3 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 3 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 3 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 3 file: parser.c
return ( xmlSAXParseDTD ( NULL , ExternalID , SystemID ) ) ; location: 12839 cross_layer: 4 file: parser.c
xmlDtdPtr
xmlSAXParseDTD(xmlSAXHandlerPtr sax, const xmlChar *ExternalID,
const xmlChar *SystemID) location: 12708 cross_layer: 5 file: parser.c
if ( ( ExternalID == NULL ) && ( SystemID == NULL ) )  location: 12715 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12728 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 12731 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 12732 cross_layer: 5 file: parser.c
systemIdCanonic = xmlCanonicPath ( SystemID ); location: 12738 cross_layer: 5 file: parser.c
if ( ( SystemID != NULL ) && ( systemIdCanonic == NULL ) )  location: 12739 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12740 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> resolveEntity != NULL ) )  location: 12748 cross_layer: 5 file: parser.c
input = ctxt -> sax -> resolveEntity ( ctxt -> userData , ExternalID , systemIdCanonic ); location: 12749 cross_layer: 5 file: parser.c
if ( input == NULL )  location: 12751 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12752 cross_layer: 5 file: parser.c
ctxt -> sax = NULL; location: 12752 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12753 cross_layer: 5 file: parser.c
if ( systemIdCanonic != NULL )  location: 12754 cross_layer: 5 file: parser.c
xmlFree ( systemIdCanonic ); location: 12755 cross_layer: 5 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 12762 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12763 cross_layer: 5 file: parser.c
if ( systemIdCanonic != NULL )  location: 12765 cross_layer: 5 file: parser.c
xmlFree ( systemIdCanonic ); location: 12766 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 12769 cross_layer: 5 file: parser.c
enc = xmlDetectCharEncoding ( ctxt -> input -> cur , 4 ); location: 12770 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 12771 cross_layer: 5 file: parser.c
if ( input -> filename == NULL )  location: 12774 cross_layer: 5 file: parser.c
input -> filename = ( char * ) systemIdCanonic; location: 12775 cross_layer: 5 file: parser.c
xmlFree ( systemIdCanonic ); location: 12777 cross_layer: 5 file: parser.c
input -> line = 1; location: 12778 cross_layer: 5 file: parser.c
input -> col = 1; location: 12779 cross_layer: 5 file: parser.c
input -> base = ctxt -> input -> cur; location: 12780 cross_layer: 5 file: parser.c
input -> cur = ctxt -> input -> cur; location: 12781 cross_layer: 5 file: parser.c
input -> free = NULL; location: 12782 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12791 cross_layer: 5 file: parser.c
ctxt -> myDoc -> extSubset = xmlNewDtd ( ctxt -> myDoc , BAD_CAST "none" ,
ExternalID , SystemID ) location: 12797 cross_layer: 5 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 5 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 5 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 5 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 5 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 5 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 5 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 5 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 5 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 5 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 5 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 5 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12820 cross_layer: 5 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 5 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 5 file: parser.c
------------------------------
135 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 5534 cross_layer: 2 file: parser.c
xmlParseEntityDecl ( ctxt ); location: 6791 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
136 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 5534 cross_layer: 2 file: parser.c
xmlParseEntityDecl ( ctxt ); location: 6791 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
137 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 5534 cross_layer: 2 file: parser.c
xmlParseEntityDecl ( ctxt ); location: 6791 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
138 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 10845 cross_layer: 3 file: parser.c
xmlParseExtParsedEnt ( ctxt ); location: 13939 cross_layer: 4 file: parser.c
------------------------------
139 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 10014 cross_layer: 3 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 4 file: parser.c
------------------------------
140 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 10014 cross_layer: 3 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 4 file: parser.c
------------------------------
141 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13680 cross_layer: 3 file: parser.c
------------------------------
142 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13006 cross_layer: 3 file: parser.c
------------------------------
143 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13855 cross_layer: 3 file: parser.c
return xmlParseBalancedChunkMemoryRecover ( doc , sax , user_data , depth , string , lst , 0 ) ; location: 13313 cross_layer: 4 file: parser.c
------------------------------
144 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , & list ); location: 7110 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7112 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7114 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7115 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
145 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
146 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
147 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseBalancedChunkMemoryInternal(xmlParserCtxtPtr oldctxt,
const xmlChar *string, void *user_data, xmlNodePtr *lst) location: 13341 cross_layer: 5 file: parser.c
if ( ( ( oldctxt -> depth > 40 ) && ( ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( oldctxt -> depth > 1024 ) )  location: 13354 cross_layer: 5 file: parser.c
if ( lst != NULL )  location: 13360 cross_layer: 5 file: parser.c
* lst = NULL; location: 13361 cross_layer: 5 file: parser.c
if ( string == NULL )  location: 13362 cross_layer: 5 file: parser.c
size = xmlStrlen ( string ); location: 13365 cross_layer: 5 file: parser.c
ctxt = xmlCreateMemoryParserCtxt ( ( char * ) string , size ); location: 13367 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13368 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13369 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13370 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13372 cross_layer: 5 file: parser.c
if ( ctxt -> dict != NULL )  location: 13373 cross_layer: 5 file: parser.c
xmlDictFree ( ctxt -> dict ); location: 13373 cross_layer: 5 file: parser.c
ctxt -> dict = oldctxt -> dict; location: 13374 cross_layer: 5 file: parser.c
ctxt -> input_id = oldctxt -> input_id + 1; location: 13375 cross_layer: 5 file: parser.c
ctxt -> str_xml = xmlDictLookup ( ctxt -> dict , BAD_CAST "xml" , 3 )
ctxt -> str_xmlns = xmlDictLookup ( ctxt -> dict , BAD_CAST "xmlns" , 5 ) location: 13377 cross_layer: 5 file: parser.c
ctxt -> str_xml_ns = xmlDictLookup ( ctxt -> dict , XML_XML_NAMESPACE , 36 ); location: 13378 cross_layer: 5 file: parser.c
for (i = 0;i < oldctxt->nsNr;i += 2) location: 13382 cross_layer: 5 file: parser.c
nsPush ( ctxt , oldctxt -> nsTab [ i ] , oldctxt -> nsTab [ i + 1 ] ); location: 13383 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13387 cross_layer: 5 file: parser.c
ctxt -> sax = oldctxt -> sax; location: 13388 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13389 cross_layer: 5 file: parser.c
ctxt -> replaceEntities = oldctxt -> replaceEntities; location: 13390 cross_layer: 5 file: parser.c
ctxt -> options = oldctxt -> options; location: 13391 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13393 cross_layer: 5 file: parser.c
if ( oldctxt -> myDoc == NULL )  location: 13394 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13397 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13398 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13399 cross_layer: 5 file: parser.c
newDoc -> dict = ctxt -> dict; location: 13403 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13404 cross_layer: 5 file: parser.c
ctxt -> myDoc = newDoc; location: 13405 cross_layer: 5 file: parser.c
ctxt -> myDoc = oldctxt -> myDoc; location: 13407 cross_layer: 5 file: parser.c
content = ctxt -> myDoc -> children; location: 13408 cross_layer: 5 file: parser.c
last = ctxt -> myDoc -> last; location: 13409 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( ctxt -> myDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13411 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13412 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13413 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13414 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13415 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13416 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13417 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = NULL; location: 13421 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = NULL; location: 13422 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ctxt -> myDoc , newRoot ); location: 13423 cross_layer: 5 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13425 cross_layer: 5 file: parser.c
ctxt -> depth = oldctxt -> depth + 1; location: 13426 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13428 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13429 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) || ( oldctxt -> replaceEntities != 0 ) )  location: 13430 cross_layer: 5 file: parser.c
ctxt -> loadsubset |= XML_SKIP_IDS; location: 13434 cross_layer: 5 file: parser.c
ctxt -> dictNames = oldctxt -> dictNames; location: 13436 cross_layer: 5 file: parser.c
ctxt -> attsDefault = oldctxt -> attsDefault; location: 13437 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = oldctxt -> attsSpecial; location: 13438 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13442 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13444 cross_layer: 5 file: parser.c
if ( ctxt -> node != ctxt -> myDoc -> children )  location: 13446 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13447 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13450 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13451 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13454 cross_layer: 5 file: parser.c
if ( ( lst != NULL ) && ( ret == XML_ERR_OK ) )  location: 13459 cross_layer: 5 file: parser.c
cur = ctxt -> myDoc -> children -> children; location: 13466 cross_layer: 5 file: parser.c
* lst = cur; location: 13467 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13468 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) && ( oldctxt -> wellFormed ) && ( oldctxt -> myDoc ) && ( oldctxt -> myDoc -> intSubset ) && ( cur -> type == XML_ELEMENT_NODE ) )  location: 13470 cross_layer: 5 file: parser.c
oldctxt -> valid &= xmlValidateElement ( & oldctxt -> vctxt , oldctxt -> myDoc , cur ); location: 13473 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13477 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13478 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children -> children = NULL; location: 13480 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 13482 cross_layer: 5 file: parser.c
xmlFreeNode ( ctxt -> myDoc -> children ); location: 13483 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = content; location: 13484 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = last; location: 13485 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13492 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13493 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code != XML_ERR_OK )  location: 13498 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13499 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13501 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13502 cross_layer: 5 file: parser.c
ctxt -> attsDefault = NULL; location: 13503 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = NULL; location: 13504 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13505 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13506 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13507 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13510 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
148 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 3 file: parser.c
return ( xmlParseExternalEntityPrivate ( doc , NULL , sax , user_data , depth , URL , ID , lst ) ) ; location: 13286 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
------------------------------
149 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13859 cross_layer: 3 file: parser.c
return xmlParseBalancedChunkMemoryRecover ( doc , sax , user_data , depth , string , lst , 0 ) ; location: 13313 cross_layer: 4 file: parser.c
------------------------------
150 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
151 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
152 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
153 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
154 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
155 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
156 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
157 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12254 cross_layer: 2 file: parser.c
------------------------------
158 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11513 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
159 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11513 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
160 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11835 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
161 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11835 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
162 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
163 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
164 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
165 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
166 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
167 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
168 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12470 @@ ['ctxt->input->length'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
169 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11351 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
170 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11351 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
171 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
172 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
173 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
174 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
175 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
176 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
177 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
178 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11263 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
179 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11263 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
180 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12221 cross_layer: 2 file: parser.c
------------------------------
181 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
182 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
183 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
184 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
185 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
186 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
187 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
188 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12199 cross_layer: 2 file: parser.c
------------------------------
189 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 2093 cross_layer: 2 file: parser.c
------------------------------
190 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 2087 cross_layer: 2 file: parser.c
------------------------------
191 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 10845 cross_layer: 4 file: parser.c
------------------------------
192 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 10014 cross_layer: 4 file: parser.c
------------------------------
193 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13680 cross_layer: 4 file: parser.c
------------------------------
194 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13006 cross_layer: 4 file: parser.c
------------------------------
195 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13855 cross_layer: 4 file: parser.c
------------------------------
196 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 4 file: parser.c
------------------------------
197 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 4 file: parser.c
------------------------------
198 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13859 cross_layer: 4 file: parser.c
------------------------------
199 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14614 cross_layer: 4 file: parser.c
------------------------------
200 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14447 cross_layer: 4 file: parser.c
------------------------------
201 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14541 cross_layer: 4 file: parser.c
------------------------------
202 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14175 cross_layer: 4 file: parser.c
------------------------------
203 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14331 cross_layer: 4 file: parser.c
------------------------------
204 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 15196 cross_layer: 4 file: parser.c
------------------------------
205 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11230 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
206 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11230 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
207 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11319 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
208 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11319 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
209 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12486 cross_layer: 2 file: parser.c
------------------------------
210 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , node ); location: 13640 cross_layer: 3 file: parser.c
------------------------------
211 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 12926 cross_layer: 3 file: parser.c
------------------------------
212 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , & list ); location: 7110 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7112 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7114 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7115 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
213 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
214 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
215 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseBalancedChunkMemoryInternal(xmlParserCtxtPtr oldctxt,
const xmlChar *string, void *user_data, xmlNodePtr *lst) location: 13341 cross_layer: 5 file: parser.c
if ( ( ( oldctxt -> depth > 40 ) && ( ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( oldctxt -> depth > 1024 ) )  location: 13354 cross_layer: 5 file: parser.c
if ( lst != NULL )  location: 13360 cross_layer: 5 file: parser.c
* lst = NULL; location: 13361 cross_layer: 5 file: parser.c
if ( string == NULL )  location: 13362 cross_layer: 5 file: parser.c
size = xmlStrlen ( string ); location: 13365 cross_layer: 5 file: parser.c
ctxt = xmlCreateMemoryParserCtxt ( ( char * ) string , size ); location: 13367 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13368 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13369 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13370 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13372 cross_layer: 5 file: parser.c
if ( ctxt -> dict != NULL )  location: 13373 cross_layer: 5 file: parser.c
xmlDictFree ( ctxt -> dict ); location: 13373 cross_layer: 5 file: parser.c
ctxt -> dict = oldctxt -> dict; location: 13374 cross_layer: 5 file: parser.c
ctxt -> input_id = oldctxt -> input_id + 1; location: 13375 cross_layer: 5 file: parser.c
ctxt -> str_xml = xmlDictLookup ( ctxt -> dict , BAD_CAST "xml" , 3 )
ctxt -> str_xmlns = xmlDictLookup ( ctxt -> dict , BAD_CAST "xmlns" , 5 ) location: 13377 cross_layer: 5 file: parser.c
ctxt -> str_xml_ns = xmlDictLookup ( ctxt -> dict , XML_XML_NAMESPACE , 36 ); location: 13378 cross_layer: 5 file: parser.c
for (i = 0;i < oldctxt->nsNr;i += 2) location: 13382 cross_layer: 5 file: parser.c
nsPush ( ctxt , oldctxt -> nsTab [ i ] , oldctxt -> nsTab [ i + 1 ] ); location: 13383 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13387 cross_layer: 5 file: parser.c
ctxt -> sax = oldctxt -> sax; location: 13388 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13389 cross_layer: 5 file: parser.c
ctxt -> replaceEntities = oldctxt -> replaceEntities; location: 13390 cross_layer: 5 file: parser.c
ctxt -> options = oldctxt -> options; location: 13391 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13393 cross_layer: 5 file: parser.c
if ( oldctxt -> myDoc == NULL )  location: 13394 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13397 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13398 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13399 cross_layer: 5 file: parser.c
newDoc -> dict = ctxt -> dict; location: 13403 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13404 cross_layer: 5 file: parser.c
ctxt -> myDoc = newDoc; location: 13405 cross_layer: 5 file: parser.c
ctxt -> myDoc = oldctxt -> myDoc; location: 13407 cross_layer: 5 file: parser.c
content = ctxt -> myDoc -> children; location: 13408 cross_layer: 5 file: parser.c
last = ctxt -> myDoc -> last; location: 13409 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( ctxt -> myDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13411 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13412 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13413 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13414 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13415 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13416 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13417 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = NULL; location: 13421 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = NULL; location: 13422 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ctxt -> myDoc , newRoot ); location: 13423 cross_layer: 5 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13425 cross_layer: 5 file: parser.c
ctxt -> depth = oldctxt -> depth + 1; location: 13426 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13428 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13429 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) || ( oldctxt -> replaceEntities != 0 ) )  location: 13430 cross_layer: 5 file: parser.c
ctxt -> loadsubset |= XML_SKIP_IDS; location: 13434 cross_layer: 5 file: parser.c
ctxt -> dictNames = oldctxt -> dictNames; location: 13436 cross_layer: 5 file: parser.c
ctxt -> attsDefault = oldctxt -> attsDefault; location: 13437 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = oldctxt -> attsSpecial; location: 13438 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13442 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13444 cross_layer: 5 file: parser.c
if ( ctxt -> node != ctxt -> myDoc -> children )  location: 13446 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13447 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13450 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13451 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13454 cross_layer: 5 file: parser.c
if ( ( lst != NULL ) && ( ret == XML_ERR_OK ) )  location: 13459 cross_layer: 5 file: parser.c
cur = ctxt -> myDoc -> children -> children; location: 13466 cross_layer: 5 file: parser.c
* lst = cur; location: 13467 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13468 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) && ( oldctxt -> wellFormed ) && ( oldctxt -> myDoc ) && ( oldctxt -> myDoc -> intSubset ) && ( cur -> type == XML_ELEMENT_NODE ) )  location: 13470 cross_layer: 5 file: parser.c
oldctxt -> valid &= xmlValidateElement ( & oldctxt -> vctxt , oldctxt -> myDoc , cur ); location: 13473 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13477 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13478 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children -> children = NULL; location: 13480 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 13482 cross_layer: 5 file: parser.c
xmlFreeNode ( ctxt -> myDoc -> children ); location: 13483 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = content; location: 13484 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = last; location: 13485 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13492 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13493 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code != XML_ERR_OK )  location: 13498 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13499 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13501 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13502 cross_layer: 5 file: parser.c
ctxt -> attsDefault = NULL; location: 13503 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = NULL; location: 13504 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13505 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13506 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13507 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13510 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
216 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 3 file: parser.c
return ( xmlParseExternalEntityPrivate ( doc , NULL , sax , user_data , depth , URL , ID , lst ) ) ; location: 13286 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
------------------------------
217 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newRoot ); location: 13831 cross_layer: 3 file: parser.c
return xmlParseBalancedChunkMemoryRecover ( doc , sax , user_data , depth , string , lst , 0 ) ; location: 13313 cross_layer: 4 file: parser.c
------------------------------
218 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6941 cross_layer: 2 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 3 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 3 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 3 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 3 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 3 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 3 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 3 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 3 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 3 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 3 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 3 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 3 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 3 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 3 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 3 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 3 file: parser.c
return ( xmlSAXParseDTD ( NULL , ExternalID , SystemID ) ) ; location: 12839 cross_layer: 4 file: parser.c
xmlDtdPtr
xmlSAXParseDTD(xmlSAXHandlerPtr sax, const xmlChar *ExternalID,
const xmlChar *SystemID) location: 12708 cross_layer: 5 file: parser.c
if ( ( ExternalID == NULL ) && ( SystemID == NULL ) )  location: 12715 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12728 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 12731 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 12732 cross_layer: 5 file: parser.c
systemIdCanonic = xmlCanonicPath ( SystemID ); location: 12738 cross_layer: 5 file: parser.c
if ( ( SystemID != NULL ) && ( systemIdCanonic == NULL ) )  location: 12739 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12740 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> resolveEntity != NULL ) )  location: 12748 cross_layer: 5 file: parser.c
input = ctxt -> sax -> resolveEntity ( ctxt -> userData , ExternalID , systemIdCanonic ); location: 12749 cross_layer: 5 file: parser.c
if ( input == NULL )  location: 12751 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12752 cross_layer: 5 file: parser.c
ctxt -> sax = NULL; location: 12752 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12753 cross_layer: 5 file: parser.c
if ( systemIdCanonic != NULL )  location: 12754 cross_layer: 5 file: parser.c
xmlFree ( systemIdCanonic ); location: 12755 cross_layer: 5 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 12762 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12763 cross_layer: 5 file: parser.c
if ( systemIdCanonic != NULL )  location: 12765 cross_layer: 5 file: parser.c
xmlFree ( systemIdCanonic ); location: 12766 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 12769 cross_layer: 5 file: parser.c
enc = xmlDetectCharEncoding ( ctxt -> input -> cur , 4 ); location: 12770 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 12771 cross_layer: 5 file: parser.c
if ( input -> filename == NULL )  location: 12774 cross_layer: 5 file: parser.c
input -> filename = ( char * ) systemIdCanonic; location: 12775 cross_layer: 5 file: parser.c
xmlFree ( systemIdCanonic ); location: 12777 cross_layer: 5 file: parser.c
input -> line = 1; location: 12778 cross_layer: 5 file: parser.c
input -> col = 1; location: 12779 cross_layer: 5 file: parser.c
input -> base = ctxt -> input -> cur; location: 12780 cross_layer: 5 file: parser.c
input -> cur = ctxt -> input -> cur; location: 12781 cross_layer: 5 file: parser.c
input -> free = NULL; location: 12782 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12791 cross_layer: 5 file: parser.c
ctxt -> myDoc -> extSubset = xmlNewDtd ( ctxt -> myDoc , BAD_CAST "none" ,
ExternalID , SystemID ) location: 12797 cross_layer: 5 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 5 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 5 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 5 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 5 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 5 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 5 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 5 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 5 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 5 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 5 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 5 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12820 cross_layer: 5 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 5 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 5 file: parser.c
------------------------------
219 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 5534 cross_layer: 2 file: parser.c
xmlParseEntityDecl ( ctxt ); location: 6791 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
220 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 5534 cross_layer: 2 file: parser.c
xmlParseEntityDecl ( ctxt ); location: 6791 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
221 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 5534 cross_layer: 2 file: parser.c
xmlParseEntityDecl ( ctxt ); location: 6791 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
222 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 10845 cross_layer: 3 file: parser.c
xmlParseExtParsedEnt ( ctxt ); location: 13939 cross_layer: 4 file: parser.c
------------------------------
223 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 10014 cross_layer: 3 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 4 file: parser.c
------------------------------
224 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 10014 cross_layer: 3 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 4 file: parser.c
------------------------------
225 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13680 cross_layer: 3 file: parser.c
------------------------------
226 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13006 cross_layer: 3 file: parser.c
------------------------------
227 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13855 cross_layer: 3 file: parser.c
return xmlParseBalancedChunkMemoryRecover ( doc , sax , user_data , depth , string , lst , 0 ) ; location: 13313 cross_layer: 4 file: parser.c
------------------------------
228 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , & list ); location: 7110 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7112 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7114 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7115 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
229 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
230 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
231 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseBalancedChunkMemoryInternal(xmlParserCtxtPtr oldctxt,
const xmlChar *string, void *user_data, xmlNodePtr *lst) location: 13341 cross_layer: 5 file: parser.c
if ( ( ( oldctxt -> depth > 40 ) && ( ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( oldctxt -> depth > 1024 ) )  location: 13354 cross_layer: 5 file: parser.c
if ( lst != NULL )  location: 13360 cross_layer: 5 file: parser.c
* lst = NULL; location: 13361 cross_layer: 5 file: parser.c
if ( string == NULL )  location: 13362 cross_layer: 5 file: parser.c
size = xmlStrlen ( string ); location: 13365 cross_layer: 5 file: parser.c
ctxt = xmlCreateMemoryParserCtxt ( ( char * ) string , size ); location: 13367 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13368 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13369 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13370 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13372 cross_layer: 5 file: parser.c
if ( ctxt -> dict != NULL )  location: 13373 cross_layer: 5 file: parser.c
xmlDictFree ( ctxt -> dict ); location: 13373 cross_layer: 5 file: parser.c
ctxt -> dict = oldctxt -> dict; location: 13374 cross_layer: 5 file: parser.c
ctxt -> input_id = oldctxt -> input_id + 1; location: 13375 cross_layer: 5 file: parser.c
ctxt -> str_xml = xmlDictLookup ( ctxt -> dict , BAD_CAST "xml" , 3 )
ctxt -> str_xmlns = xmlDictLookup ( ctxt -> dict , BAD_CAST "xmlns" , 5 ) location: 13377 cross_layer: 5 file: parser.c
ctxt -> str_xml_ns = xmlDictLookup ( ctxt -> dict , XML_XML_NAMESPACE , 36 ); location: 13378 cross_layer: 5 file: parser.c
for (i = 0;i < oldctxt->nsNr;i += 2) location: 13382 cross_layer: 5 file: parser.c
nsPush ( ctxt , oldctxt -> nsTab [ i ] , oldctxt -> nsTab [ i + 1 ] ); location: 13383 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13387 cross_layer: 5 file: parser.c
ctxt -> sax = oldctxt -> sax; location: 13388 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13389 cross_layer: 5 file: parser.c
ctxt -> replaceEntities = oldctxt -> replaceEntities; location: 13390 cross_layer: 5 file: parser.c
ctxt -> options = oldctxt -> options; location: 13391 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13393 cross_layer: 5 file: parser.c
if ( oldctxt -> myDoc == NULL )  location: 13394 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13397 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13398 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13399 cross_layer: 5 file: parser.c
newDoc -> dict = ctxt -> dict; location: 13403 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13404 cross_layer: 5 file: parser.c
ctxt -> myDoc = newDoc; location: 13405 cross_layer: 5 file: parser.c
ctxt -> myDoc = oldctxt -> myDoc; location: 13407 cross_layer: 5 file: parser.c
content = ctxt -> myDoc -> children; location: 13408 cross_layer: 5 file: parser.c
last = ctxt -> myDoc -> last; location: 13409 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( ctxt -> myDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13411 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13412 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13413 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13414 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13415 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13416 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13417 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = NULL; location: 13421 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = NULL; location: 13422 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ctxt -> myDoc , newRoot ); location: 13423 cross_layer: 5 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13425 cross_layer: 5 file: parser.c
ctxt -> depth = oldctxt -> depth + 1; location: 13426 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13428 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13429 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) || ( oldctxt -> replaceEntities != 0 ) )  location: 13430 cross_layer: 5 file: parser.c
ctxt -> loadsubset |= XML_SKIP_IDS; location: 13434 cross_layer: 5 file: parser.c
ctxt -> dictNames = oldctxt -> dictNames; location: 13436 cross_layer: 5 file: parser.c
ctxt -> attsDefault = oldctxt -> attsDefault; location: 13437 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = oldctxt -> attsSpecial; location: 13438 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13442 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13444 cross_layer: 5 file: parser.c
if ( ctxt -> node != ctxt -> myDoc -> children )  location: 13446 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13447 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13450 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13451 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13454 cross_layer: 5 file: parser.c
if ( ( lst != NULL ) && ( ret == XML_ERR_OK ) )  location: 13459 cross_layer: 5 file: parser.c
cur = ctxt -> myDoc -> children -> children; location: 13466 cross_layer: 5 file: parser.c
* lst = cur; location: 13467 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13468 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) && ( oldctxt -> wellFormed ) && ( oldctxt -> myDoc ) && ( oldctxt -> myDoc -> intSubset ) && ( cur -> type == XML_ELEMENT_NODE ) )  location: 13470 cross_layer: 5 file: parser.c
oldctxt -> valid &= xmlValidateElement ( & oldctxt -> vctxt , oldctxt -> myDoc , cur ); location: 13473 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13477 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13478 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children -> children = NULL; location: 13480 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 13482 cross_layer: 5 file: parser.c
xmlFreeNode ( ctxt -> myDoc -> children ); location: 13483 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = content; location: 13484 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = last; location: 13485 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13492 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13493 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code != XML_ERR_OK )  location: 13498 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13499 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13501 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13502 cross_layer: 5 file: parser.c
ctxt -> attsDefault = NULL; location: 13503 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = NULL; location: 13504 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13505 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13506 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13507 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13510 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
232 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 3 file: parser.c
return ( xmlParseExternalEntityPrivate ( doc , NULL , sax , user_data , depth , URL , ID , lst ) ) ; location: 13286 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
------------------------------
233 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13859 cross_layer: 3 file: parser.c
return xmlParseBalancedChunkMemoryRecover ( doc , sax , user_data , depth , string , lst , 0 ) ; location: 13313 cross_layer: 4 file: parser.c
------------------------------
234 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
235 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
236 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
237 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
238 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
239 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
240 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
241 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12254 cross_layer: 2 file: parser.c
------------------------------
242 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11513 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
243 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11513 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
244 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11835 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
245 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11835 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
246 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
247 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
248 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
249 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
250 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
251 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
252 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12466 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
xmlFreeParserInputBuffer ( ctxt -> input -> buf ); location: 12466 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> cur = BAD_CAST "" location: 12469 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
253 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11351 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
254 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11351 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
255 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
256 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
257 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
258 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
259 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
260 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
261 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6738 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
262 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11263 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
263 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11263 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
264 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12221 cross_layer: 2 file: parser.c
------------------------------
265 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
266 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
267 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
268 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
269 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
270 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
271 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6659 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
272 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12199 cross_layer: 2 file: parser.c
------------------------------
273 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 2093 cross_layer: 2 file: parser.c
------------------------------
274 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 2087 cross_layer: 2 file: parser.c
------------------------------
275 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 10845 cross_layer: 4 file: parser.c
------------------------------
276 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 10014 cross_layer: 4 file: parser.c
------------------------------
277 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13680 cross_layer: 4 file: parser.c
------------------------------
278 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13006 cross_layer: 4 file: parser.c
------------------------------
279 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13855 cross_layer: 4 file: parser.c
------------------------------
280 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 4 file: parser.c
------------------------------
281 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 4 file: parser.c
------------------------------
282 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 3 file: parser.c
xmlParseContent ( ctxt ); location: 13859 cross_layer: 4 file: parser.c
------------------------------
283 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14614 cross_layer: 4 file: parser.c
------------------------------
284 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14447 cross_layer: 4 file: parser.c
------------------------------
285 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14541 cross_layer: 4 file: parser.c
------------------------------
286 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14175 cross_layer: 4 file: parser.c
------------------------------
287 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 14331 cross_layer: 4 file: parser.c
------------------------------
288 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9906 cross_layer: 2 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 3 file: parser.c
xmlParseDocument ( ctxt ); location: 15196 cross_layer: 4 file: parser.c
------------------------------
289 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11230 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
290 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11230 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
291 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11319 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
292 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11319 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
293 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12486 cross_layer: 2 file: parser.c
------------------------------
294 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , node ); location: 13640 cross_layer: 3 file: parser.c
------------------------------
295 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 12926 cross_layer: 3 file: parser.c
------------------------------
296 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , & list ); location: 7110 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7112 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7114 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7115 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
297 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
298 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
299 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseBalancedChunkMemoryInternal(xmlParserCtxtPtr oldctxt,
const xmlChar *string, void *user_data, xmlNodePtr *lst) location: 13341 cross_layer: 5 file: parser.c
if ( ( ( oldctxt -> depth > 40 ) && ( ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( oldctxt -> depth > 1024 ) )  location: 13354 cross_layer: 5 file: parser.c
if ( lst != NULL )  location: 13360 cross_layer: 5 file: parser.c
* lst = NULL; location: 13361 cross_layer: 5 file: parser.c
if ( string == NULL )  location: 13362 cross_layer: 5 file: parser.c
size = xmlStrlen ( string ); location: 13365 cross_layer: 5 file: parser.c
ctxt = xmlCreateMemoryParserCtxt ( ( char * ) string , size ); location: 13367 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13368 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13369 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13370 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13372 cross_layer: 5 file: parser.c
if ( ctxt -> dict != NULL )  location: 13373 cross_layer: 5 file: parser.c
xmlDictFree ( ctxt -> dict ); location: 13373 cross_layer: 5 file: parser.c
ctxt -> dict = oldctxt -> dict; location: 13374 cross_layer: 5 file: parser.c
ctxt -> input_id = oldctxt -> input_id + 1; location: 13375 cross_layer: 5 file: parser.c
ctxt -> str_xml = xmlDictLookup ( ctxt -> dict , BAD_CAST "xml" , 3 )
ctxt -> str_xmlns = xmlDictLookup ( ctxt -> dict , BAD_CAST "xmlns" , 5 ) location: 13377 cross_layer: 5 file: parser.c
ctxt -> str_xml_ns = xmlDictLookup ( ctxt -> dict , XML_XML_NAMESPACE , 36 ); location: 13378 cross_layer: 5 file: parser.c
for (i = 0;i < oldctxt->nsNr;i += 2) location: 13382 cross_layer: 5 file: parser.c
nsPush ( ctxt , oldctxt -> nsTab [ i ] , oldctxt -> nsTab [ i + 1 ] ); location: 13383 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13387 cross_layer: 5 file: parser.c
ctxt -> sax = oldctxt -> sax; location: 13388 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13389 cross_layer: 5 file: parser.c
ctxt -> replaceEntities = oldctxt -> replaceEntities; location: 13390 cross_layer: 5 file: parser.c
ctxt -> options = oldctxt -> options; location: 13391 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13393 cross_layer: 5 file: parser.c
if ( oldctxt -> myDoc == NULL )  location: 13394 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13397 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13398 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13399 cross_layer: 5 file: parser.c
newDoc -> dict = ctxt -> dict; location: 13403 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13404 cross_layer: 5 file: parser.c
ctxt -> myDoc = newDoc; location: 13405 cross_layer: 5 file: parser.c
ctxt -> myDoc = oldctxt -> myDoc; location: 13407 cross_layer: 5 file: parser.c
content = ctxt -> myDoc -> children; location: 13408 cross_layer: 5 file: parser.c
last = ctxt -> myDoc -> last; location: 13409 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( ctxt -> myDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13411 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13412 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13413 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13414 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13415 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13416 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13417 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = NULL; location: 13421 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = NULL; location: 13422 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ctxt -> myDoc , newRoot ); location: 13423 cross_layer: 5 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13425 cross_layer: 5 file: parser.c
ctxt -> depth = oldctxt -> depth + 1; location: 13426 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13428 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13429 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) || ( oldctxt -> replaceEntities != 0 ) )  location: 13430 cross_layer: 5 file: parser.c
ctxt -> loadsubset |= XML_SKIP_IDS; location: 13434 cross_layer: 5 file: parser.c
ctxt -> dictNames = oldctxt -> dictNames; location: 13436 cross_layer: 5 file: parser.c
ctxt -> attsDefault = oldctxt -> attsDefault; location: 13437 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = oldctxt -> attsSpecial; location: 13438 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13442 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13444 cross_layer: 5 file: parser.c
if ( ctxt -> node != ctxt -> myDoc -> children )  location: 13446 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13447 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13450 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13451 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13454 cross_layer: 5 file: parser.c
if ( ( lst != NULL ) && ( ret == XML_ERR_OK ) )  location: 13459 cross_layer: 5 file: parser.c
cur = ctxt -> myDoc -> children -> children; location: 13466 cross_layer: 5 file: parser.c
* lst = cur; location: 13467 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13468 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) && ( oldctxt -> wellFormed ) && ( oldctxt -> myDoc ) && ( oldctxt -> myDoc -> intSubset ) && ( cur -> type == XML_ELEMENT_NODE ) )  location: 13470 cross_layer: 5 file: parser.c
oldctxt -> valid &= xmlValidateElement ( & oldctxt -> vctxt , oldctxt -> myDoc , cur ); location: 13473 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13477 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13478 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children -> children = NULL; location: 13480 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 13482 cross_layer: 5 file: parser.c
xmlFreeNode ( ctxt -> myDoc -> children ); location: 13483 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = content; location: 13484 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = last; location: 13485 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13492 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13493 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code != XML_ERR_OK )  location: 13498 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13499 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13501 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13502 cross_layer: 5 file: parser.c
ctxt -> attsDefault = NULL; location: 13503 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = NULL; location: 13504 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13505 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13506 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13507 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13510 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
300 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 3 file: parser.c
return ( xmlParseExternalEntityPrivate ( doc , NULL , sax , user_data , depth , URL , ID , lst ) ) ; location: 13286 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
------------------------------
301 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 1788 cross_layer: 2 file: parser.c
nodePush ( ctxt , newRoot ); location: 13831 cross_layer: 3 file: parser.c
return xmlParseBalancedChunkMemoryRecover ( doc , sax , user_data , depth , string , lst , 0 ) ; location: 13313 cross_layer: 4 file: parser.c
------------------------------
302 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6941 cross_layer: 2 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 3 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 3 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 3 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 3 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 3 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 3 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 3 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 3 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 3 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 3 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 3 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 3 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 3 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 3 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 3 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 3 file: parser.c
return ( xmlSAXParseDTD ( NULL , ExternalID , SystemID ) ) ; location: 12839 cross_layer: 4 file: parser.c
xmlDtdPtr
xmlSAXParseDTD(xmlSAXHandlerPtr sax, const xmlChar *ExternalID,
const xmlChar *SystemID) location: 12708 cross_layer: 5 file: parser.c
if ( ( ExternalID == NULL ) && ( SystemID == NULL ) )  location: 12715 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12728 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 12731 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 12732 cross_layer: 5 file: parser.c
systemIdCanonic = xmlCanonicPath ( SystemID ); location: 12738 cross_layer: 5 file: parser.c
if ( ( SystemID != NULL ) && ( systemIdCanonic == NULL ) )  location: 12739 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12740 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> resolveEntity != NULL ) )  location: 12748 cross_layer: 5 file: parser.c
input = ctxt -> sax -> resolveEntity ( ctxt -> userData , ExternalID , systemIdCanonic ); location: 12749 cross_layer: 5 file: parser.c
if ( input == NULL )  location: 12751 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12752 cross_layer: 5 file: parser.c
ctxt -> sax = NULL; location: 12752 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12753 cross_layer: 5 file: parser.c
if ( systemIdCanonic != NULL )  location: 12754 cross_layer: 5 file: parser.c
xmlFree ( systemIdCanonic ); location: 12755 cross_layer: 5 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 12762 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12763 cross_layer: 5 file: parser.c
if ( systemIdCanonic != NULL )  location: 12765 cross_layer: 5 file: parser.c
xmlFree ( systemIdCanonic ); location: 12766 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 12769 cross_layer: 5 file: parser.c
enc = xmlDetectCharEncoding ( ctxt -> input -> cur , 4 ); location: 12770 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 12771 cross_layer: 5 file: parser.c
if ( input -> filename == NULL )  location: 12774 cross_layer: 5 file: parser.c
input -> filename = ( char * ) systemIdCanonic; location: 12775 cross_layer: 5 file: parser.c
xmlFree ( systemIdCanonic ); location: 12777 cross_layer: 5 file: parser.c
input -> line = 1; location: 12778 cross_layer: 5 file: parser.c
input -> col = 1; location: 12779 cross_layer: 5 file: parser.c
input -> base = ctxt -> input -> cur; location: 12780 cross_layer: 5 file: parser.c
input -> cur = ctxt -> input -> cur; location: 12781 cross_layer: 5 file: parser.c
input -> free = NULL; location: 12782 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12791 cross_layer: 5 file: parser.c
ctxt -> myDoc -> extSubset = xmlNewDtd ( ctxt -> myDoc , BAD_CAST "none" ,
ExternalID , SystemID ) location: 12797 cross_layer: 5 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 5 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 5 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 5 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 5 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 5 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 5 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 5 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 5 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 5 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 5 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 5 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 12820 cross_layer: 5 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 5 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 5 file: parser.c
------------------------------
303 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 5534 cross_layer: 2 file: parser.c
xmlParseEntityDecl ( ctxt ); location: 6791 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
304 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 5534 cross_layer: 2 file: parser.c
xmlParseEntityDecl ( ctxt ); location: 6791 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
305 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 5534 cross_layer: 2 file: parser.c
xmlParseEntityDecl ( ctxt ); location: 6791 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
306 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 10845 cross_layer: 3 file: parser.c
xmlParseExtParsedEnt ( ctxt ); location: 13939 cross_layer: 4 file: parser.c
------------------------------
307 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 10014 cross_layer: 3 file: parser.c
xmlParseElement ( ctxt ); location: 9846 cross_layer: 4 file: parser.c
------------------------------
308 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 10014 cross_layer: 3 file: parser.c
xmlParseElement ( ctxt ); location: 10711 cross_layer: 4 file: parser.c
------------------------------
309 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13680 cross_layer: 3 file: parser.c
------------------------------
310 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13006 cross_layer: 3 file: parser.c
------------------------------
311 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13855 cross_layer: 3 file: parser.c
return xmlParseBalancedChunkMemoryRecover ( doc , sax , user_data , depth , string , lst , 0 ) ; location: 13313 cross_layer: 4 file: parser.c
------------------------------
312 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , & list ); location: 7110 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7112 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7114 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7115 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
313 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 3 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
314 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
315 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 3 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , & list ); location: 7116 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7119 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7122 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 7130 cross_layer: 4 file: parser.c
if ( ( ent -> content != NULL ) && ( xmlStrchr ( ent -> content , '<' ) ) )  location: 7131 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 7132 cross_layer: 4 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7133 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7134 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7138 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ( ret == XML_ERR_OK ) && ( list != NULL ) )  location: 7143 cross_layer: 4 file: parser.c
if ( ( ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY ) || ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) && ( ent -> children == NULL ) )  location: 7144 cross_layer: 4 file: parser.c
ent -> children = list; location: 7147 cross_layer: 4 file: parser.c
if ( ctxt -> replaceEntities )  location: 7148 cross_layer: 4 file: parser.c
if ( ( ( list -> type == XML_TEXT_NODE ) && ( list -> next == NULL ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7153 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7156 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7158 cross_layer: 4 file: parser.c
ent -> owner = 0; location: 7160 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ctxt -> node; location: 7162 cross_layer: 4 file: parser.c
list -> doc = ctxt -> myDoc; location: 7163 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7164 cross_layer: 4 file: parser.c
ent -> last = list; location: 7165 cross_layer: 4 file: parser.c
list = list -> next; location: 7166 cross_layer: 4 file: parser.c
list = ent -> children; location: 7168 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7170 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , list , NULL ); location: 7171 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
ent -> owner = 1; location: 7175 cross_layer: 4 file: parser.c
list -> parent = ( xmlNodePtr ) ent; location: 7177 cross_layer: 4 file: parser.c
xmlSetTreeDoc ( list , ent -> doc ); location: 7178 cross_layer: 4 file: parser.c
if ( list -> next == NULL )  location: 7179 cross_layer: 4 file: parser.c
ent -> last = list; location: 7180 cross_layer: 4 file: parser.c
list = list -> next; location: 7181 cross_layer: 4 file: parser.c
if ( ( ret != XML_ERR_OK ) && ( ret != XML_WAR_UNDECLARED_ENTITY ) )  location: 7188 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr ( ctxt , XML_ERR_UNDECLARED_ENTITY , "Entity '%s' failed to parse\n" , ent -> name ); location: 7190 cross_layer: 4 file: parser.c
xmlFatalErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 733 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 735 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 738 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 739 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 740 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 744 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 745 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 746 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 747 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 7192 cross_layer: 4 file: parser.c
ent -> content [ 0 ] = 0; location: 7193 cross_layer: 4 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7194 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
if ( ent -> checked == 0 )  location: 7199 cross_layer: 4 file: parser.c
ent -> checked = 2; location: 7200 cross_layer: 4 file: parser.c
if ( ent -> checked != 1 )  location: 7204 cross_layer: 4 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 7205 cross_layer: 4 file: parser.c
if ( ent -> children == NULL )  location: 7213 cross_layer: 4 file: parser.c
if ( was_checked != 0 )  location: 7220 cross_layer: 4 file: parser.c
if ( ctxt -> userData == ctxt )  location: 7227 cross_layer: 4 file: parser.c
user_data = ctxt -> userData; location: 7230 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_INTERNAL_GENERAL_ENTITY )  location: 7232 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7233 cross_layer: 4 file: parser.c
ret = xmlParseBalancedChunkMemoryInternal ( ctxt , ent -> content , user_data , NULL ); location: 7234 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseBalancedChunkMemoryInternal(xmlParserCtxtPtr oldctxt,
const xmlChar *string, void *user_data, xmlNodePtr *lst) location: 13341 cross_layer: 5 file: parser.c
if ( ( ( oldctxt -> depth > 40 ) && ( ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( oldctxt -> depth > 1024 ) )  location: 13354 cross_layer: 5 file: parser.c
if ( lst != NULL )  location: 13360 cross_layer: 5 file: parser.c
* lst = NULL; location: 13361 cross_layer: 5 file: parser.c
if ( string == NULL )  location: 13362 cross_layer: 5 file: parser.c
size = xmlStrlen ( string ); location: 13365 cross_layer: 5 file: parser.c
ctxt = xmlCreateMemoryParserCtxt ( ( char * ) string , size ); location: 13367 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13368 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13369 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13370 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13372 cross_layer: 5 file: parser.c
if ( ctxt -> dict != NULL )  location: 13373 cross_layer: 5 file: parser.c
xmlDictFree ( ctxt -> dict ); location: 13373 cross_layer: 5 file: parser.c
ctxt -> dict = oldctxt -> dict; location: 13374 cross_layer: 5 file: parser.c
ctxt -> input_id = oldctxt -> input_id + 1; location: 13375 cross_layer: 5 file: parser.c
ctxt -> str_xml = xmlDictLookup ( ctxt -> dict , BAD_CAST "xml" , 3 )
ctxt -> str_xmlns = xmlDictLookup ( ctxt -> dict , BAD_CAST "xmlns" , 5 ) location: 13377 cross_layer: 5 file: parser.c
ctxt -> str_xml_ns = xmlDictLookup ( ctxt -> dict , XML_XML_NAMESPACE , 36 ); location: 13378 cross_layer: 5 file: parser.c
for (i = 0;i < oldctxt->nsNr;i += 2) location: 13382 cross_layer: 5 file: parser.c
nsPush ( ctxt , oldctxt -> nsTab [ i ] , oldctxt -> nsTab [ i + 1 ] ); location: 13383 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13387 cross_layer: 5 file: parser.c
ctxt -> sax = oldctxt -> sax; location: 13388 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13389 cross_layer: 5 file: parser.c
ctxt -> replaceEntities = oldctxt -> replaceEntities; location: 13390 cross_layer: 5 file: parser.c
ctxt -> options = oldctxt -> options; location: 13391 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13393 cross_layer: 5 file: parser.c
if ( oldctxt -> myDoc == NULL )  location: 13394 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13397 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13398 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13399 cross_layer: 5 file: parser.c
newDoc -> dict = ctxt -> dict; location: 13403 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13404 cross_layer: 5 file: parser.c
ctxt -> myDoc = newDoc; location: 13405 cross_layer: 5 file: parser.c
ctxt -> myDoc = oldctxt -> myDoc; location: 13407 cross_layer: 5 file: parser.c
content = ctxt -> myDoc -> children; location: 13408 cross_layer: 5 file: parser.c
last = ctxt -> myDoc -> last; location: 13409 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( ctxt -> myDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13411 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13412 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13413 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13414 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13415 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13416 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13417 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = NULL; location: 13421 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = NULL; location: 13422 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ctxt -> myDoc , newRoot ); location: 13423 cross_layer: 5 file: parser.c
nodePush ( ctxt , ctxt -> myDoc -> children ); location: 13424 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13425 cross_layer: 5 file: parser.c
ctxt -> depth = oldctxt -> depth + 1; location: 13426 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13428 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13429 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) || ( oldctxt -> replaceEntities != 0 ) )  location: 13430 cross_layer: 5 file: parser.c
ctxt -> loadsubset |= XML_SKIP_IDS; location: 13434 cross_layer: 5 file: parser.c
ctxt -> dictNames = oldctxt -> dictNames; location: 13436 cross_layer: 5 file: parser.c
ctxt -> attsDefault = oldctxt -> attsDefault; location: 13437 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = oldctxt -> attsSpecial; location: 13438 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13440 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13442 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13444 cross_layer: 5 file: parser.c
if ( ctxt -> node != ctxt -> myDoc -> children )  location: 13446 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13447 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13450 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13451 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13454 cross_layer: 5 file: parser.c
if ( ( lst != NULL ) && ( ret == XML_ERR_OK ) )  location: 13459 cross_layer: 5 file: parser.c
cur = ctxt -> myDoc -> children -> children; location: 13466 cross_layer: 5 file: parser.c
* lst = cur; location: 13467 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13468 cross_layer: 5 file: parser.c
if ( ( oldctxt -> validate ) && ( oldctxt -> wellFormed ) && ( oldctxt -> myDoc ) && ( oldctxt -> myDoc -> intSubset ) && ( cur -> type == XML_ELEMENT_NODE ) )  location: 13470 cross_layer: 5 file: parser.c
oldctxt -> valid &= xmlValidateElement ( & oldctxt -> vctxt , oldctxt -> myDoc , cur ); location: 13473 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13477 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13478 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children -> children = NULL; location: 13480 cross_layer: 5 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 13482 cross_layer: 5 file: parser.c
xmlFreeNode ( ctxt -> myDoc -> children ); location: 13483 cross_layer: 5 file: parser.c
ctxt -> myDoc -> children = content; location: 13484 cross_layer: 5 file: parser.c
ctxt -> myDoc -> last = last; location: 13485 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13492 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13493 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code != XML_ERR_OK )  location: 13498 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13499 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13501 cross_layer: 5 file: parser.c
ctxt -> dict = NULL; location: 13502 cross_layer: 5 file: parser.c
ctxt -> attsDefault = NULL; location: 13503 cross_layer: 5 file: parser.c
ctxt -> attsSpecial = NULL; location: 13504 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13505 cross_layer: 5 file: parser.c
if ( newDoc != NULL )  location: 13506 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13507 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13510 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 7236 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7237 cross_layer: 4 file: parser.c
ctxt -> depth ++; location: 7239 cross_layer: 4 file: parser.c
ret = xmlParseExternalEntityPrivate ( ctxt -> myDoc , ctxt , ctxt -> sax , user_data , ctxt -> depth , ent -> URI , ent -> ExternalID , NULL ); location: 7240 cross_layer: 4 file: parser.c
ctxt -> depth --; location: 7243 cross_layer: 4 file: parser.c
xmlErrMsgStr ( ctxt , XML_ERR_INTERNAL_ERROR , "invalid entity type found\n" , NULL ); location: 7246 cross_layer: 4 file: parser.c
xmlErrMsgStr(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, const xmlChar * val) location: 762 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 764 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 767 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 768 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_ERROR , NULL , 0 , ( const char * ) val , NULL , NULL , 0 , 0 , msg , val ); location: 769 cross_layer: 5 file: parser.c
if ( ret == XML_ERR_ENTITY_LOOP )  location: 7249 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 7250 cross_layer: 4 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 350 cross_layer: 5 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 354 cross_layer: 5 file: parser.c
switch ( error )  location: 357 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 539 cross_layer: 5 file: parser.c
ctxt -> errNo = error; location: 540 cross_layer: 5 file: parser.c
if ( info == NULL )  location: 541 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s\n" , errmsg ); location: 542 cross_layer: 5 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , "%s: %s\n" , errmsg , info ); location: 546 cross_layer: 5 file: parser.c
if ( ctxt != NULL )  location: 550 cross_layer: 5 file: parser.c
ctxt -> wellFormed = 0; location: 551 cross_layer: 5 file: parser.c
if ( ctxt -> recovery == 0 )  location: 552 cross_layer: 5 file: parser.c
ctxt -> disableSAX = 1; location: 553 cross_layer: 5 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7254 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7260 cross_layer: 4 file: parser.c
if ( ( ctxt -> sax != NULL ) && ( ctxt -> sax -> reference != NULL ) && ( ctxt -> replaceEntities == 0 ) && ( ! ctxt -> disableSAX ) )  location: 7268 cross_layer: 4 file: parser.c
ctxt -> sax -> reference ( ctxt -> userData , ent -> name ); location: 7273 cross_layer: 4 file: parser.c
if ( ( ctxt -> replaceEntities ) || ( ent -> children == NULL ) )  location: 7277 cross_layer: 4 file: parser.c
if ( ( ctxt -> node != NULL ) && ( ent -> children != NULL ) )  location: 7291 cross_layer: 4 file: parser.c
if ( ( ( list == NULL ) && ( ent -> owner == 0 ) ) || ( ctxt -> parseMode == XML_PARSE_READER ) )  location: 7297 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7304 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7305 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7315 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7316 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7317 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7318 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7319 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7320 cross_layer: 4 file: parser.c
firstChild = nw; location: 7322 cross_layer: 4 file: parser.c
nw = xmlAddChild ( ctxt -> node , nw ); location: 7324 cross_layer: 4 file: parser.c
if ( cur == ent -> last )  location: 7326 cross_layer: 4 file: parser.c
if ( ( ctxt -> parseMode == XML_PARSE_READER ) && ( nw != NULL ) && ( nw -> type == XML_ELEMENT_NODE ) && ( nw -> children == NULL ) )  location: 7331 cross_layer: 4 file: parser.c
nw -> extra = 1; location: 7335 cross_layer: 4 file: parser.c
cur = cur -> next; location: 7339 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7342 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7343 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ( list == NULL ) || ( ctxt -> inputNr > 0 ) )  location: 7345 cross_layer: 4 file: parser.c
ctxt -> sizeentcopy += ent -> length + 5; location: 7352 cross_layer: 4 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7353 cross_layer: 4 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) && ( ctxt -> errNo != XML_ERR_ENTITY_LOOP ) )  location: 140 cross_layer: 5 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 143 cross_layer: 5 file: parser.c
ent -> checked = 1; location: 146 cross_layer: 5 file: parser.c
++ ctxt -> depth; location: 148 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 149 cross_layer: 5 file: parser.c
-- ctxt -> depth; location: 151 cross_layer: 5 file: parser.c
if ( ( rep == NULL ) || ( ctxt -> errNo == XML_ERR_ENTITY_LOOP ) )  location: 152 cross_layer: 5 file: parser.c
ent -> content [ 0 ] = 0; location: 153 cross_layer: 5 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 156 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 157 cross_layer: 5 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 158 cross_layer: 5 file: parser.c
ent -> checked |= 1; location: 159 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 160 cross_layer: 5 file: parser.c
if ( replacement != 0 )  location: 164 cross_layer: 5 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 165 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 173 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 174 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 177 cross_layer: 5 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 179 cross_layer: 5 file: parser.c
if ( size != 0 )  location: 181 cross_layer: 5 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 185 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 191 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 192 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 195 cross_layer: 5 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 197 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 200 cross_layer: 5 file: parser.c
size = ent -> checked / 2; location: 204 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL )  location: 209 cross_layer: 5 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 210 cross_layer: 5 file: parser.c
consumed += ctxt -> sizeentities; location: 213 cross_layer: 5 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 219 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 225 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 230 cross_layer: 5 file: parser.c
cur = ent -> children; location: 7362 cross_layer: 4 file: parser.c
ent -> children = NULL; location: 7363 cross_layer: 4 file: parser.c
last = ent -> last; location: 7364 cross_layer: 4 file: parser.c
ent -> last = NULL; location: 7365 cross_layer: 4 file: parser.c
while ( cur != NULL )  location: 7366 cross_layer: 4 file: parser.c
next = cur -> next; location: 7367 cross_layer: 4 file: parser.c
cur -> next = NULL; location: 7368 cross_layer: 4 file: parser.c
cur -> parent = NULL; location: 7369 cross_layer: 4 file: parser.c
nw = xmlDocCopyNode ( cur , ctxt -> myDoc , 1 ); location: 7370 cross_layer: 4 file: parser.c
if ( nw != NULL )  location: 7371 cross_layer: 4 file: parser.c
if ( nw -> _private == NULL )  location: 7372 cross_layer: 4 file: parser.c
nw -> _private = cur -> _private; location: 7373 cross_layer: 4 file: parser.c
firstChild = cur; location: 7375 cross_layer: 4 file: parser.c
xmlAddChild ( ( xmlNodePtr ) ent , nw ); location: 7377 cross_layer: 4 file: parser.c
xmlAddChild ( ctxt -> node , cur ); location: 7378 cross_layer: 4 file: parser.c
if ( cur == last )  location: 7380 cross_layer: 4 file: parser.c
cur = next; location: 7382 cross_layer: 4 file: parser.c
if ( ent -> owner == 0 )  location: 7384 cross_layer: 4 file: parser.c
ent -> owner = 1; location: 7385 cross_layer: 4 file: parser.c
if ( ent -> etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY )  location: 7387 cross_layer: 4 file: parser.c
xmlAddEntityReference ( ent , firstChild , nw ); location: 7388 cross_layer: 4 file: parser.c
static void
xmlAddEntityReference(xmlEntityPtr ent, xmlNodePtr firstNode,
xmlNodePtr lastNode) location: 14663 cross_layer: 5 file: parser.c
( * xmlEntityRefFunc ) ( ent , firstNode , lastNode ); location: 14666 cross_layer: 5 file: parser.c
if ( ent -> children -> type == XML_TEXT_NODE )  location: 7400 cross_layer: 4 file: parser.c
ent -> children -> name = nbktext; location: 7401 cross_layer: 4 file: parser.c
if ( ( ent -> last != ent -> children ) && ( ent -> last -> type == XML_TEXT_NODE ) )  location: 7402 cross_layer: 4 file: parser.c
ent -> last -> name = nbktext; location: 7404 cross_layer: 4 file: parser.c
xmlAddChildList ( ctxt -> node , ent -> children ); location: 7405 cross_layer: 4 file: parser.c
ctxt -> nodemem = 0; location: 7412 cross_layer: 4 file: parser.c
ctxt -> nodelen = 0; location: 7413 cross_layer: 4 file: parser.c
------------------------------
316 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 3 file: parser.c
return ( xmlParseExternalEntityPrivate ( doc , NULL , sax , user_data , depth , URL , ID , lst ) ) ; location: 13286 cross_layer: 4 file: parser.c
static xmlParserErrors
xmlParseExternalEntityPrivate(xmlDocPtr doc, xmlParserCtxtPtr oldctxt,
xmlSAXHandlerPtr sax,
void *user_data, int depth, const xmlChar *URL,
const xmlChar *ID, xmlNodePtr *list) location: 13075 cross_layer: 5 file: parser.c
if ( ( ( depth > 40 ) && ( ( oldctxt == NULL ) || ( oldctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( depth > 1024 ) )  location: 13084 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13090 cross_layer: 5 file: parser.c
* list = NULL; location: 13091 cross_layer: 5 file: parser.c
if ( ( URL == NULL ) && ( ID == NULL ) )  location: 13092 cross_layer: 5 file: parser.c
if ( doc == NULL )  location: 13094 cross_layer: 5 file: parser.c
ctxt = xmlCreateEntityParserCtxtInternal ( URL , ID , NULL , oldctxt ); location: 13098 cross_layer: 5 file: parser.c
if ( ctxt == NULL )  location: 13099 cross_layer: 5 file: parser.c
ctxt -> userData = ctxt; location: 13100 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13101 cross_layer: 5 file: parser.c
ctxt -> _private = oldctxt -> _private; location: 13102 cross_layer: 5 file: parser.c
ctxt -> loadsubset = oldctxt -> loadsubset; location: 13103 cross_layer: 5 file: parser.c
ctxt -> validate = oldctxt -> validate; location: 13104 cross_layer: 5 file: parser.c
ctxt -> external = oldctxt -> external; location: 13105 cross_layer: 5 file: parser.c
ctxt -> record_info = oldctxt -> record_info; location: 13106 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = oldctxt -> node_seq . maximum; location: 13107 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = oldctxt -> node_seq . length; location: 13108 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = oldctxt -> node_seq . buffer; location: 13109 cross_layer: 5 file: parser.c
ctxt -> _private = NULL; location: 13115 cross_layer: 5 file: parser.c
ctxt -> validate = 0; location: 13116 cross_layer: 5 file: parser.c
ctxt -> external = 2; location: 13117 cross_layer: 5 file: parser.c
ctxt -> loadsubset = 0; location: 13118 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13120 cross_layer: 5 file: parser.c
oldsax = ctxt -> sax; location: 13121 cross_layer: 5 file: parser.c
ctxt -> sax = sax; location: 13122 cross_layer: 5 file: parser.c
if ( user_data != NULL )  location: 13123 cross_layer: 5 file: parser.c
ctxt -> userData = user_data; location: 13124 cross_layer: 5 file: parser.c
xmlDetectSAX2 ( ctxt ); location: 13126 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13129 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13130 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13131 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13132 cross_layer: 5 file: parser.c
newDoc -> intSubset = doc -> intSubset; location: 13136 cross_layer: 5 file: parser.c
newDoc -> extSubset = doc -> extSubset; location: 13137 cross_layer: 5 file: parser.c
newDoc -> dict = doc -> dict; location: 13138 cross_layer: 5 file: parser.c
xmlDictReference ( newDoc -> dict ); location: 13139 cross_layer: 5 file: parser.c
if ( doc -> URL != NULL )  location: 13141 cross_layer: 5 file: parser.c
newDoc -> URL = xmlStrdup ( doc -> URL ); location: 13142 cross_layer: 5 file: parser.c
newRoot = xmlNewDocNode ( newDoc , NULL , BAD_CAST "pseudoroot" , NULL ) location: 13144 cross_layer: 5 file: parser.c
if ( newRoot == NULL )  location: 13145 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13146 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13147 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13148 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13149 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13150 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13151 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13152 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13153 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13154 cross_layer: 5 file: parser.c
xmlAddChild ( ( xmlNodePtr ) newDoc , newRoot ); location: 13157 cross_layer: 5 file: parser.c
nodePush ( ctxt , newDoc -> children ); location: 13158 cross_layer: 5 file: parser.c
ctxt -> myDoc = doc; location: 13159 cross_layer: 5 file: parser.c
newRoot -> doc = doc; location: 13160 cross_layer: 5 file: parser.c
if ( ( ctxt -> input -> end - ctxt -> input -> cur ) >= 4 )  location: 13168 cross_layer: 5 file: parser.c
xmlSwitchEncoding ( ctxt , enc ); location: 13175 cross_layer: 5 file: parser.c
xmlParseTextDecl ( ctxt ); location: 13183 cross_layer: 5 file: parser.c
ctxt -> instate = XML_PARSER_CONTENT; location: 13186 cross_layer: 5 file: parser.c
ctxt -> depth = depth; location: 13187 cross_layer: 5 file: parser.c
xmlParseContent ( ctxt ); location: 13189 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13192 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_EXTRA_CONTENT , NULL ); location: 13194 cross_layer: 5 file: parser.c
if ( ctxt -> node != newDoc -> children )  location: 13196 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_NOT_WELL_BALANCED , NULL ); location: 13197 cross_layer: 5 file: parser.c
if ( ! ctxt -> wellFormed )  location: 13200 cross_layer: 5 file: parser.c
if ( ctxt -> errNo == 0 )  location: 13201 cross_layer: 5 file: parser.c
ret = ( xmlParserErrors ) ctxt -> errNo; location: 13204 cross_layer: 5 file: parser.c
if ( list != NULL )  location: 13206 cross_layer: 5 file: parser.c
cur = newDoc -> children -> children; location: 13213 cross_layer: 5 file: parser.c
* list = cur; location: 13214 cross_layer: 5 file: parser.c
while ( cur != NULL )  location: 13215 cross_layer: 5 file: parser.c
cur -> parent = NULL; location: 13216 cross_layer: 5 file: parser.c
cur = cur -> next; location: 13217 cross_layer: 5 file: parser.c
newDoc -> children -> children = NULL; location: 13219 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13228 cross_layer: 5 file: parser.c
oldctxt -> nbentities += ctxt -> nbentities; location: 13229 cross_layer: 5 file: parser.c
if ( ctxt -> input != NULL && oldctxt != NULL )  location: 13234 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ctxt -> input -> consumed; location: 13235 cross_layer: 5 file: parser.c
oldctxt -> sizeentities += ( ctxt -> input -> cur - ctxt -> input -> base ); location: 13236 cross_layer: 5 file: parser.c
if ( ( oldctxt != NULL ) && ( ctxt -> lastError . code != XML_ERR_OK ) )  location: 13241 cross_layer: 5 file: parser.c
xmlCopyError ( & ctxt -> lastError , & oldctxt -> lastError ); location: 13242 cross_layer: 5 file: parser.c
if ( sax != NULL )  location: 13244 cross_layer: 5 file: parser.c
ctxt -> sax = oldsax; location: 13245 cross_layer: 5 file: parser.c
if ( oldctxt != NULL )  location: 13246 cross_layer: 5 file: parser.c
oldctxt -> node_seq . maximum = ctxt -> node_seq . maximum; location: 13247 cross_layer: 5 file: parser.c
oldctxt -> node_seq . length = ctxt -> node_seq . length; location: 13248 cross_layer: 5 file: parser.c
oldctxt -> node_seq . buffer = ctxt -> node_seq . buffer; location: 13249 cross_layer: 5 file: parser.c
ctxt -> node_seq . maximum = 0; location: 13251 cross_layer: 5 file: parser.c
ctxt -> node_seq . length = 0; location: 13252 cross_layer: 5 file: parser.c
ctxt -> node_seq . buffer = NULL; location: 13253 cross_layer: 5 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 13254 cross_layer: 5 file: parser.c
newDoc -> intSubset = NULL; location: 13255 cross_layer: 5 file: parser.c
newDoc -> extSubset = NULL; location: 13256 cross_layer: 5 file: parser.c
xmlFreeDoc ( newDoc ); location: 13257 cross_layer: 5 file: parser.c
return ( ret ) ; location: 13259 cross_layer: 5 file: parser.c
------------------------------
317 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 9871 cross_layer: 2 file: parser.c
xmlParseContent ( ctxt ); location: 13859 cross_layer: 3 file: parser.c
return xmlParseBalancedChunkMemoryRecover ( doc , sax , user_data , depth , string , lst , 0 ) ; location: 13313 cross_layer: 4 file: parser.c
------------------------------
318 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
319 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
320 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
321 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
322 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
323 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
324 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6681 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
325 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 12254 cross_layer: 2 file: parser.c
------------------------------
326 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11513 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
327 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11513 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
328 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11835 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , 0 ); location: 12229 cross_layer: 3 file: parser.c
------------------------------
329 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 11835 cross_layer: 2 file: parser.c
xmlParseTryOrFinish ( ctxt , terminate ); location: 12244 cross_layer: 3 file: parser.c
------------------------------
330 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6652 cross_layer: 4 file: parser.c
------------------------------
331 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 6969 cross_layer: 4 file: parser.c
------------------------------
332 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 3 file: parser.c
xmlParseMarkupDecl ( ctxt ); location: 8285 cross_layer: 4 file: parser.c
------------------------------
333 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 3 file: parser.c
xmlParseExternalSubset ( ctxt , ExternalID , SystemID ); location: 12798 cross_layer: 4 file: parser.c
if ( ctxt -> myDoc != NULL )  location: 12800 cross_layer: 4 file: parser.c
if ( ctxt -> wellFormed )  location: 12801 cross_layer: 4 file: parser.c
ret = ctxt -> myDoc -> extSubset; location: 12802 cross_layer: 4 file: parser.c
ctxt -> myDoc -> extSubset = NULL; location: 12803 cross_layer: 4 file: parser.c
if ( ret != NULL )  location: 12804 cross_layer: 4 file: parser.c
ret -> doc = NULL; location: 12807 cross_layer: 4 file: parser.c
tmp = ret -> children; location: 12808 cross_layer: 4 file: parser.c
while ( tmp != NULL )  location: 12809 cross_layer: 4 file: parser.c
tmp -> doc = NULL; location: 12810 cross_layer: 4 file: parser.c
tmp = tmp -> next; location: 12811 cross_layer: 4 file: parser.c
xmlFreeDoc ( ctxt -> myDoc ); location: 12817 cross_layer: 4 file: parser.c
ctxt -> myDoc = NULL; location: 12818 cross_layer: 4 file: parser.c
ctxt -> sax = NULL; location: 12820 cross_layer: 4 file: parser.c
xmlFreeParserCtxt ( ctxt ); location: 12821 cross_layer: 4 file: parser.c
return ( ret ) ; location: 12823 cross_layer: 4 file: parser.c
------------------------------
334 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6824 cross_layer: 4 file: parser.c
------------------------------
335 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6967 cross_layer: 4 file: parser.c
------------------------------
336 @@ testCode/CVE-2017-8872_CWE-125_123234f2cfcd9e9b9f83047eee1dc17b4c3f4407_parser.c_NEW.c @@ xmlHaltParser @@ 12467 @@ ['ctxt->input->buf'] @@ {}
static void
xmlHaltParser(xmlParserCtxtPtr ctxt) location: 12449 cross_layer: 1 file: parser.c
if ( ctxt == NULL )  location: 12450 cross_layer: 1 file: parser.c
ctxt -> instate = XML_PARSER_EOF; location: 12452 cross_layer: 1 file: parser.c
ctxt -> disableSAX = 1; location: 12453 cross_layer: 1 file: parser.c
if ( ctxt -> input != NULL )  location: 12456 cross_layer: 1 file: parser.c
if ( ctxt -> input -> free != NULL )  location: 12461 cross_layer: 1 file: parser.c
ctxt -> input -> free = NULL; location: 12463 cross_layer: 1 file: parser.c
if ( ctxt -> input -> buf != NULL )  location: 12465 cross_layer: 1 file: parser.c
ctxt -> input -> buf = NULL; location: 12467 cross_layer: 1 file: parser.c
ctxt -> input -> length = 0; location: 12470 cross_layer: 1 file: parser.c
ctxt -> input -> base = ctxt -> input -> cur; location: 12471 cross_layer: 1 file: parser.c
ctxt -> input -> end = ctxt -> input -> cur; location: 12472 cross_layer: 1 file: parser.c
xmlHaltParser ( ctxt ); location: 6623 cross_layer: 2 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 3 file: parser.c
xmlParseConditionalSections ( ctxt ); location: 6650 cross_layer: 4 file: parser.c
------------------------------
