1 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 4099 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 4103 cross_layer: 3 file: parser.c
current = rep; location: 4104 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 4105 cross_layer: 3 file: parser.c
if ( ( * current == 0xD ) || ( * current == 0xA ) || ( * current == 0x9 ) )  location: 4106 cross_layer: 3 file: parser.c
current ++; location: 4109 cross_layer: 3 file: parser.c
buf [ len ++ ] = * current ++; location: 4111 cross_layer: 3 file: parser.c
if ( len + 10 > buf_size )  location: 4112 cross_layer: 3 file: parser.c
growBuffer ( buf , 10 ); location: 4113 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 4116 cross_layer: 3 file: parser.c
if ( len + 10 > buf_size )  location: 4120 cross_layer: 3 file: parser.c
buf [ len ++ ] = ent -> content [ 0 ]; location: 4124 cross_layer: 3 file: parser.c
buf [ len ++ ] = '&'; location: 4155 cross_layer: 3 file: parser.c
while ( len + i + 10 > buf_size )  location: 4156 cross_layer: 3 file: parser.c
growBuffer ( buf , i + 10 ); location: 4157 cross_layer: 3 file: parser.c
buf [ len ++ ] = * cur ++; location: 4160 cross_layer: 3 file: parser.c
buf [ len ++ ] = ';'; location: 4161 cross_layer: 3 file: parser.c
if ( ( len != 0 ) || ( ! normalize ) )  location: 4166 cross_layer: 3 file: parser.c
COPY_BUF ( l , buf , len , 0x20 ); location: 4168 cross_layer: 3 file: parser.c
while ( len + 10 > buf_size )  location: 4169 cross_layer: 3 file: parser.c
COPY_BUF ( l , buf , len , c ); location: 4177 cross_layer: 3 file: parser.c
if ( len + 10 > buf_size )  location: 4178 cross_layer: 3 file: parser.c
while ( ( len > 0 ) && ( buf [ len - 1 ] == 0x20 ) )  location: 4191 cross_layer: 3 file: parser.c
len --; location: 4191 cross_layer: 3 file: parser.c
buf [ len ] = 0; location: 4193 cross_layer: 3 file: parser.c
if ( len >= INT_MAX )  location: 4211 cross_layer: 3 file: parser.c
* attlen = ( int ) len; location: 4217 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 4225 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 4226 cross_layer: 3 file: parser.c
return xmlParseAttValueComplex ( ctxt , len , normalize ) ; location: 9198 cross_layer: 4 file: parser.c
------------------------------
2 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7551 cross_layer: 4 file: parser.c
------------------------------
3 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7736 cross_layer: 4 file: parser.c
------------------------------
4 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , NULL , 0 ); location: 8330 cross_layer: 4 file: parser.c
------------------------------
5 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7930 cross_layer: 4 file: parser.c
------------------------------
6 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 4 file: parser.c
------------------------------
7 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 4 file: parser.c
------------------------------
8 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 4 file: parser.c
------------------------------
9 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 7395 cross_layer: 4 file: parser.c
------------------------------
10 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , NULL , 0 ); location: 2632 cross_layer: 4 file: parser.c
------------------------------
11 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , NULL , 0 ); location: 8090 cross_layer: 4 file: parser.c
------------------------------
12 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , ctxt -> sizeentcopy ) )  location: 7503 cross_layer: 4 file: parser.c
------------------------------
13 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , 0 , ent , 0 ) )  location: 7341 cross_layer: 4 file: parser.c
------------------------------
14 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 4 file: parser.c
------------------------------
15 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
ret = xmlStringDecodeEntities ( ctxt , buf , XML_SUBSTITUTE_PEREF , 0 , 0 , 0 ); location: 3971 cross_layer: 3 file: parser.c
return ( ret ) ; location: 3980 cross_layer: 3 file: parser.c
value = xmlParseEntityValue ( ctxt , & orig ); location: 5585 cross_layer: 4 file: parser.c
ctxt -> sax -> entityDecl ( ctxt -> userData , name , XML_INTERNAL_GENERAL_ENTITY , NULL , NULL , value ); location: 5588 cross_layer: 4 file: parser.c
xmlSAX2EntityDecl ( ctxt , name , XML_INTERNAL_GENERAL_ENTITY , NULL , NULL , value ); location: 5608 cross_layer: 4 file: parser.c
if ( value != NULL )  location: 5728 cross_layer: 4 file: parser.c
xmlFree ( value ); location: 5728 cross_layer: 4 file: parser.c
------------------------------
16 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
ret = xmlStringDecodeEntities ( ctxt , buf , XML_SUBSTITUTE_PEREF , 0 , 0 , 0 ); location: 3971 cross_layer: 3 file: parser.c
return ( ret ) ; location: 3980 cross_layer: 3 file: parser.c
value = xmlParseEntityValue ( ctxt , & orig ); location: 5539 cross_layer: 4 file: parser.c
if ( value )  location: 5540 cross_layer: 4 file: parser.c
ctxt -> sax -> entityDecl ( ctxt -> userData , name , XML_INTERNAL_PARAMETER_ENTITY , NULL , NULL , value ); location: 5543 cross_layer: 4 file: parser.c
if ( value != NULL )  location: 5728 cross_layer: 4 file: parser.c
xmlFree ( value ); location: 5728 cross_layer: 4 file: parser.c
------------------------------
17 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 4139 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 4144 cross_layer: 3 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 4145 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 4147 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 4225 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 4226 cross_layer: 3 file: parser.c
return xmlParseAttValueComplex ( ctxt , len , normalize ) ; location: 9198 cross_layer: 4 file: parser.c
------------------------------
18 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, curstr, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 4 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 4 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 140 cross_layer: 4 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 142 cross_layer: 4 file: parser.c
ent -> checked = 1; location: 145 cross_layer: 4 file: parser.c
++ ctxt -> depth; location: 147 cross_layer: 4 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 4 file: parser.c
-- ctxt -> depth; location: 150 cross_layer: 4 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 152 cross_layer: 4 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 4 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 155 cross_layer: 4 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 4 file: parser.c
if ( replacement != 0 )  location: 160 cross_layer: 4 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 161 cross_layer: 4 file: parser.c
if ( ctxt -> input != NULL )  location: 169 cross_layer: 4 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 170 cross_layer: 4 file: parser.c
consumed += ctxt -> sizeentities; location: 173 cross_layer: 4 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 175 cross_layer: 4 file: parser.c
if ( size != 0 )  location: 177 cross_layer: 4 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 181 cross_layer: 4 file: parser.c
if ( ctxt -> input != NULL )  location: 187 cross_layer: 4 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 188 cross_layer: 4 file: parser.c
consumed += ctxt -> sizeentities; location: 191 cross_layer: 4 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 193 cross_layer: 4 file: parser.c
if ( ent != NULL )  location: 196 cross_layer: 4 file: parser.c
size = ent -> checked / 2; location: 200 cross_layer: 4 file: parser.c
if ( ctxt -> input != NULL )  location: 205 cross_layer: 4 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 206 cross_layer: 4 file: parser.c
consumed += ctxt -> sizeentities; location: 209 cross_layer: 4 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 215 cross_layer: 4 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 221 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 226 cross_layer: 4 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 4 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 5 file: parser.c
last = str + len; location: 2758 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 5 file: parser.c
if ( str < last )  location: 2778 cross_layer: 5 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 5 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 5 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 5 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 5 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 5 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 5 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 5 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 5 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 5 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 5 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 5 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 5 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 5 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 5 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 5 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 5 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 5 file: parser.c
current = rep; location: 2828 cross_layer: 5 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 5 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 5 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 5 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 5 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 5 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 5 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 5 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 5 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 5 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 5 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 5 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 5 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 5 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 5 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 5 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 5 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 5 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 5 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 5 file: parser.c
current = rep; location: 2871 cross_layer: 5 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 5 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 5 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 5 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 5 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 5 file: parser.c
str += l; location: 2886 cross_layer: 5 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 5 file: parser.c
if ( str < last )  location: 2891 cross_layer: 5 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 5 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 5 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 5 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 5 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 5 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 5 file: parser.c
------------------------------
19 @@ testCode/CVE-2016-4449_CWE-20_b1d34de46a11323fccffa9fadeb33be670d602f5_parser.c_OLD.c @@ xmlStringLenDecodeEntities @@ 2864 @@ ['ent', 'ctxt'] @@ {str, last, str, curstr, cur}
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 1 file: parser.c
const xmlChar * last ; location: 2752 cross_layer: 1 file: parser.c
xmlEntityPtr ent ; location: 2753 cross_layer: 1 file: parser.c
int c , l ; location: 2754 cross_layer: 1 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 1 file: parser.c
last = str + len; location: 2758 cross_layer: 1 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 1 file: parser.c
buffer_size = XML_PARSER_BIG_BUFFER_SIZE; location: 2770 cross_layer: 1 file: parser.c
buffer = ( xmlChar * ) xmlMallocAtomic ( buffer_size ); location: 2771 cross_layer: 1 file: parser.c
if ( buffer == NULL )  location: 2772 cross_layer: 1 file: parser.c
if ( str < last )  location: 2778 cross_layer: 1 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 1 file: parser.c
c = 0; location: 2781 cross_layer: 1 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 1 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 1 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 1 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 1 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 1 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 1 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 1 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 1 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 1 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 1 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 1 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 1 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 1 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 1 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 1 file: parser.c
static int
xmlLoadEntityContent(xmlParserCtxtPtr ctxt, xmlEntityPtr entity) location: 8144 cross_layer: 2 file: parser.c
if ( ( ctxt == NULL ) || ( entity == NULL ) || ( ( entity -> etype != XML_EXTERNAL_PARAMETER_ENTITY ) && ( entity -> etype != XML_EXTERNAL_GENERAL_PARSED_ENTITY ) ) || ( entity -> content != NULL ) )  location: 8150 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8154 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Reading %s entity content input\n" , entity -> name ); location: 8160 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent parameter error" ); location: 8165 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
input = xmlNewEntityInputStream ( ctxt , entity ); location: 8170 cross_layer: 2 file: parser.c
if ( input == NULL )  location: 8171 cross_layer: 2 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_INTERNAL_ERROR , "xmlLoadEntityContent input error" ); location: 8172 cross_layer: 2 file: parser.c
static void
xmlFatalErr(xmlParserCtxtPtr ctxt, xmlParserErrors error, const char *info) location: 346 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 351 cross_layer: 3 file: parser.c
switch ( error )  location: 354 cross_layer: 3 file: parser.c
if ( info == NULL )  location: 536 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 540 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 541 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , info , NULL , NULL , 0 , 0 , & errstr [ 0 ] , info ); location: 542 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 545 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 546 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 547 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 548 cross_layer: 3 file: parser.c
if ( xmlPushInput ( ctxt , input ) < 0 )  location: 8182 cross_layer: 2 file: parser.c
int
xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) location: 2225 cross_layer: 3 file: parser.c
if ( input == NULL )  location: 2227 cross_layer: 3 file: parser.c
if ( ( ctxt -> input != NULL ) && ( ctxt -> input -> filename ) )  location: 2230 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "%s(%d): " , ctxt -> input -> filename , ctxt -> input -> line ); location: 2231 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Pushing input %d : %.30s\n" , ctxt -> inputNr + 1 , input -> cur ); location: 2234 cross_layer: 3 file: parser.c
ret = inputPush ( ctxt , input ); location: 2237 cross_layer: 3 file: parser.c
int
inputPush(xmlParserCtxtPtr ctxt, xmlParserInputPtr value) location: 1699 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( value == NULL ) )  location: 1701 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr >= ctxt -> inputMax )  location: 1703 cross_layer: 4 file: parser.c
ctxt -> inputMax *= 2; location: 1704 cross_layer: 4 file: parser.c
ctxt -> inputTab = ( xmlParserInputPtr * ) xmlRealloc ( ctxt -> inputTab , ctxt -> inputMax * sizeof ( ctxt -> inputTab [ 0 ] ) ); location: 1705 cross_layer: 4 file: parser.c
if ( ctxt -> inputTab == NULL )  location: 1709 cross_layer: 4 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 1710 cross_layer: 4 file: parser.c
xmlFreeInputStream ( value ); location: 1711 cross_layer: 4 file: parser.c
ctxt -> inputMax /= 2; location: 1712 cross_layer: 4 file: parser.c
value = NULL; location: 1713 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = value; location: 1717 cross_layer: 4 file: parser.c
ctxt -> input = value; location: 1718 cross_layer: 4 file: parser.c
return ( ctxt -> inputNr ++ ) ; location: 1719 cross_layer: 4 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 2238 cross_layer: 3 file: parser.c
return ( ret ) ; location: 2241 cross_layer: 3 file: parser.c
while ( ( ctxt -> input == input ) && ( ctxt -> input -> cur < ctxt -> input -> end ) && ( IS_CHAR ( c ) ) )  location: 8189 cross_layer: 2 file: parser.c
xmlBufferAdd ( buf , ctxt -> input -> cur , l ); location: 8191 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8195 cross_layer: 2 file: parser.c
if ( ctxt -> instate == XML_PARSER_EOF )  location: 8205 cross_layer: 2 file: parser.c
if ( ( ctxt -> input == input ) && ( ctxt -> input -> cur >= ctxt -> input -> end ) )  location: 8213 cross_layer: 2 file: parser.c
xmlPopInput ( ctxt ); location: 8214 cross_layer: 2 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 3 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 3 file: parser.c
xmlParserInputPtr
inputPop(xmlParserCtxtPtr ctxt) location: 1730 cross_layer: 4 file: parser.c
if ( ctxt == NULL )  location: 1734 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr <= 0 )  location: 1736 cross_layer: 4 file: parser.c
ctxt -> inputNr --; location: 1738 cross_layer: 4 file: parser.c
if ( ctxt -> inputNr > 0 )  location: 1739 cross_layer: 4 file: parser.c
ctxt -> input = ctxt -> inputTab [ ctxt -> inputNr - 1 ]; location: 1740 cross_layer: 4 file: parser.c
ctxt -> input = NULL; location: 1742 cross_layer: 4 file: parser.c
ret = ctxt -> inputTab [ ctxt -> inputNr ]; location: 1743 cross_layer: 4 file: parser.c
ctxt -> inputTab [ ctxt -> inputNr ] = NULL; location: 1744 cross_layer: 4 file: parser.c
return ( ret ) ; location: 1745 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 3 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 3 file: parser.c
xmlChar
xmlPopInput(xmlParserCtxtPtr ctxt) location: 2203 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> inputNr <= 1 ) )  location: 2204 cross_layer: 4 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "Popping input %d\n" , ctxt -> inputNr ); location: 2206 cross_layer: 4 file: parser.c
xmlFreeInputStream ( inputPop ( ctxt ) ); location: 2208 cross_layer: 4 file: parser.c
if ( ( * ctxt -> input -> cur == 0 ) && ( xmlParserInputGrow ( ctxt -> input , INPUT_CHUNK ) <= 0 ) )  location: 2209 cross_layer: 4 file: parser.c
return ( xmlPopInput ( ctxt ) ) ; location: 2211 cross_layer: 4 file: parser.c
xmlFatalErrMsgInt ( ctxt , XML_ERR_INVALID_CHAR , "xmlLoadEntityContent: invalid char value %d\n" , c ); location: 8216 cross_layer: 2 file: parser.c
static void
xmlFatalErrMsgInt(xmlParserCtxtPtr ctxt, xmlParserErrors error,
const char *msg, int val) location: 668 cross_layer: 3 file: parser.c
if ( ( ctxt != NULL ) && ( ctxt -> disableSAX != 0 ) && ( ctxt -> instate == XML_PARSER_EOF ) )  location: 670 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 673 cross_layer: 3 file: parser.c
ctxt -> errNo = error; location: 674 cross_layer: 3 file: parser.c
__xmlRaiseError ( NULL , NULL , NULL , ctxt , NULL , XML_FROM_PARSER , error , XML_ERR_FATAL , NULL , 0 , NULL , NULL , NULL , val , 0 , msg , val ); location: 675 cross_layer: 3 file: parser.c
if ( ctxt != NULL )  location: 678 cross_layer: 3 file: parser.c
ctxt -> wellFormed = 0; location: 679 cross_layer: 3 file: parser.c
if ( ctxt -> recovery == 0 )  location: 680 cross_layer: 3 file: parser.c
ctxt -> disableSAX = 1; location: 681 cross_layer: 3 file: parser.c
entity -> content = buf -> content; location: 8222 cross_layer: 2 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 2 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 3 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 3 file: parser.c
last = str + len; location: 2758 cross_layer: 3 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 3 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 3 file: parser.c
if ( str < last )  location: 2778 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 3 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 3 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 3 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 3 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 3 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 3 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 3 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 3 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 3 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 3 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 3 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 3 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 3 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
for (;i > 0;i--) location: 2848 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 3 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 3 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 3 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 3 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 3 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 3 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 3 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 3 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 3 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 3 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 3 file: parser.c
current = rep; location: 2871 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
str += l; location: 2886 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
if ( str < last )  location: 2891 cross_layer: 3 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 3 file: parser.c
current = rep; location: 2828 cross_layer: 3 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 3 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 4 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 4 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 140 cross_layer: 4 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 142 cross_layer: 4 file: parser.c
ent -> checked = 1; location: 145 cross_layer: 4 file: parser.c
++ ctxt -> depth; location: 147 cross_layer: 4 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 4 file: parser.c
-- ctxt -> depth; location: 150 cross_layer: 4 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 152 cross_layer: 4 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 4 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 155 cross_layer: 4 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 4 file: parser.c
if ( replacement != 0 )  location: 160 cross_layer: 4 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 161 cross_layer: 4 file: parser.c
if ( ctxt -> input != NULL )  location: 169 cross_layer: 4 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 170 cross_layer: 4 file: parser.c
consumed += ctxt -> sizeentities; location: 173 cross_layer: 4 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 175 cross_layer: 4 file: parser.c
if ( size != 0 )  location: 177 cross_layer: 4 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 181 cross_layer: 4 file: parser.c
if ( ctxt -> input != NULL )  location: 187 cross_layer: 4 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 188 cross_layer: 4 file: parser.c
consumed += ctxt -> sizeentities; location: 191 cross_layer: 4 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 193 cross_layer: 4 file: parser.c
if ( ent != NULL )  location: 196 cross_layer: 4 file: parser.c
size = ent -> checked / 2; location: 200 cross_layer: 4 file: parser.c
if ( ctxt -> input != NULL )  location: 205 cross_layer: 4 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 206 cross_layer: 4 file: parser.c
consumed += ctxt -> sizeentities; location: 209 cross_layer: 4 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 215 cross_layer: 4 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 221 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 226 cross_layer: 4 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 3 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 3 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 3 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 3 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 3 file: parser.c
static int
xmlParserEntityCheck(xmlParserCtxtPtr ctxt, size_t size,
xmlEntityPtr ent, size_t replacement) location: 127 cross_layer: 4 file: parser.c
if ( ( ctxt == NULL ) || ( ctxt -> options & XML_PARSE_HUGE ) )  location: 131 cross_layer: 4 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 133 cross_layer: 4 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype != XML_INTERNAL_PREDEFINED_ENTITY ) && ( ent -> content != NULL ) && ( ent -> checked == 0 ) )  location: 140 cross_layer: 4 file: parser.c
unsigned long oldnbent = ctxt -> nbentities ; location: 142 cross_layer: 4 file: parser.c
ent -> checked = 1; location: 145 cross_layer: 4 file: parser.c
++ ctxt -> depth; location: 147 cross_layer: 4 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , XML_SUBSTITUTE_REF , 0 , 0 , 0 ); location: 148 cross_layer: 4 file: parser.c
-- ctxt -> depth; location: 150 cross_layer: 4 file: parser.c
ent -> checked = ( ctxt -> nbentities - oldnbent + 1 ) * 2; location: 152 cross_layer: 4 file: parser.c
if ( rep != NULL )  location: 153 cross_layer: 4 file: parser.c
if ( xmlStrchr ( rep , '<' ) )  location: 154 cross_layer: 4 file: parser.c
ent -> checked |= 1; location: 155 cross_layer: 4 file: parser.c
xmlFree ( rep ); location: 156 cross_layer: 4 file: parser.c
if ( replacement != 0 )  location: 160 cross_layer: 4 file: parser.c
if ( replacement < XML_MAX_TEXT_LENGTH )  location: 161 cross_layer: 4 file: parser.c
if ( ctxt -> input != NULL )  location: 169 cross_layer: 4 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 170 cross_layer: 4 file: parser.c
consumed += ctxt -> sizeentities; location: 173 cross_layer: 4 file: parser.c
if ( replacement < XML_PARSER_NON_LINEAR * consumed )  location: 175 cross_layer: 4 file: parser.c
if ( size != 0 )  location: 177 cross_layer: 4 file: parser.c
if ( size < XML_PARSER_BIG_ENTITY )  location: 181 cross_layer: 4 file: parser.c
if ( ctxt -> input != NULL )  location: 187 cross_layer: 4 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 188 cross_layer: 4 file: parser.c
consumed += ctxt -> sizeentities; location: 191 cross_layer: 4 file: parser.c
if ( ( size < XML_PARSER_NON_LINEAR * consumed ) && ( ctxt -> nbentities * 3 < XML_PARSER_NON_LINEAR * consumed ) )  location: 193 cross_layer: 4 file: parser.c
if ( ent != NULL )  location: 196 cross_layer: 4 file: parser.c
size = ent -> checked / 2; location: 200 cross_layer: 4 file: parser.c
if ( ctxt -> input != NULL )  location: 205 cross_layer: 4 file: parser.c
consumed = ctxt -> input -> consumed + ( ctxt -> input -> cur - ctxt -> input -> base ); location: 206 cross_layer: 4 file: parser.c
consumed += ctxt -> sizeentities; location: 209 cross_layer: 4 file: parser.c
if ( size * 3 < consumed * XML_PARSER_NON_LINEAR )  location: 215 cross_layer: 4 file: parser.c
if ( ( ( ctxt -> lastError . code != XML_ERR_UNDECLARED_ENTITY ) && ( ctxt -> lastError . code != XML_WAR_UNDECLARED_ENTITY ) ) || ( ctxt -> nbentities <= 10000 ) )  location: 221 cross_layer: 4 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 226 cross_layer: 4 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 3 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 3 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 3 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 3 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 3 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 3 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 3 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 3 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 3 file: parser.c
return ( xmlStringLenDecodeEntities ( ctxt , str , xmlStrlen ( str ) , what , end , end2 , end3 ) ) ; location: 2931 cross_layer: 4 file: parser.c
xmlChar *
xmlStringLenDecodeEntities(xmlParserCtxtPtr ctxt, const xmlChar *str, int len,
int what, xmlChar end, xmlChar  end2, xmlChar end3) location: 2745 cross_layer: 5 file: parser.c
if ( ( ctxt == NULL ) || ( str == NULL ) || ( len < 0 ) )  location: 2756 cross_layer: 5 file: parser.c
last = str + len; location: 2758 cross_layer: 5 file: parser.c
if ( ( ( ctxt -> depth > 40 ) && ( ( ctxt -> options & XML_PARSE_HUGE ) == 0 ) ) || ( ctxt -> depth > 1024 ) )  location: 2760 cross_layer: 5 file: parser.c
xmlFatalErr ( ctxt , XML_ERR_ENTITY_LOOP , NULL ); location: 2763 cross_layer: 5 file: parser.c
if ( str < last )  location: 2778 cross_layer: 5 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2779 cross_layer: 5 file: parser.c
while ( ( c != 0 ) && ( c != end ) && ( c != end2 ) && ( c != end3 ) )  location: 2782 cross_layer: 5 file: parser.c
if ( c == 0 )  location: 2785 cross_layer: 5 file: parser.c
if ( ( c == '&' ) && ( str [ 1 ] == '#' ) )  location: 2786 cross_layer: 5 file: parser.c
int val = xmlParseStringCharRef ( ctxt , & str ) ; location: 2787 cross_layer: 5 file: parser.c
if ( val != 0 )  location: 2788 cross_layer: 5 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , val ); location: 2789 cross_layer: 5 file: parser.c
if ( ( c == '&' ) && ( what & XML_SUBSTITUTE_REF ) )  location: 2794 cross_layer: 5 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding Entity Reference: %.30s\n" , str ); location: 2796 cross_layer: 5 file: parser.c
ent = xmlParseStringEntityRef ( ctxt , & str ); location: 2799 cross_layer: 5 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2800 cross_layer: 5 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2803 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 2804 cross_layer: 5 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2805 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> etype == XML_INTERNAL_PREDEFINED_ENTITY ) )  location: 2806 cross_layer: 5 file: parser.c
if ( ent -> content != NULL )  location: 2808 cross_layer: 5 file: parser.c
COPY_BUF ( 0 , buffer , nbchars , ent -> content [ 0 ] ); location: 2809 cross_layer: 5 file: parser.c
xmlFatalErrMsg ( ctxt , XML_ERR_INTERNAL_ERROR , "predefined entity has no content\n" ); location: 2814 cross_layer: 5 file: parser.c
if ( ( ent != NULL ) && ( ent -> content != NULL ) )  location: 2817 cross_layer: 5 file: parser.c
ctxt -> depth ++; location: 2818 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2819 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 2821 cross_layer: 5 file: parser.c
if ( ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP ) || ( ctxt -> lastError . code == XML_ERR_INTERNAL_ERROR ) )  location: 2823 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 2827 cross_layer: 5 file: parser.c
current = rep; location: 2828 cross_layer: 5 file: parser.c
while ( * current != 0 )  location: 2829 cross_layer: 5 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2830 cross_layer: 5 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2831 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2832 cross_layer: 5 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2834 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 2837 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 2840 cross_layer: 5 file: parser.c
int i = xmlStrlen ( ent -> name ) ; location: 2841 cross_layer: 5 file: parser.c
const xmlChar * cur = ent -> name ; location: 2842 cross_layer: 5 file: parser.c
buffer [ nbchars ++ ] = '&'; location: 2844 cross_layer: 5 file: parser.c
if ( nbchars + i + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2845 cross_layer: 5 file: parser.c
growBuffer ( buffer , i + XML_PARSER_BUFFER_SIZE ); location: 2846 cross_layer: 5 file: parser.c
buffer [ nbchars ++ ] = * cur ++; location: 2849 cross_layer: 5 file: parser.c
buffer [ nbchars ++ ] = ';'; location: 2850 cross_layer: 5 file: parser.c
if ( c == '%' && ( what & XML_SUBSTITUTE_PEREF ) )  location: 2852 cross_layer: 5 file: parser.c
xmlGenericError ( xmlGenericErrorContext , "String decoding PE Reference: %.30s\n" , str ); location: 2854 cross_layer: 5 file: parser.c
ent = xmlParseStringPEReference ( ctxt , & str ); location: 2856 cross_layer: 5 file: parser.c
if ( ctxt -> lastError . code == XML_ERR_ENTITY_LOOP )  location: 2857 cross_layer: 5 file: parser.c
xmlParserEntityCheck ( ctxt , 0 , ent , 0 ); location: 2859 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 2860 cross_layer: 5 file: parser.c
ctxt -> nbentities += ent -> checked / 2; location: 2861 cross_layer: 5 file: parser.c
if ( ent != NULL )  location: 2862 cross_layer: 5 file: parser.c
if ( ent -> content == NULL )  location: 2863 cross_layer: 5 file: parser.c
xmlLoadEntityContent ( ctxt , ent ); location: 2864 cross_layer: 5 file: parser.c
ctxt -> depth ++; location: 2866 cross_layer: 5 file: parser.c
rep = xmlStringDecodeEntities ( ctxt , ent -> content , what , 0 , 0 , 0 ); location: 2867 cross_layer: 5 file: parser.c
ctxt -> depth --; location: 2869 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 2870 cross_layer: 5 file: parser.c
current = rep; location: 2871 cross_layer: 5 file: parser.c
while ( * current != 0 )  location: 2872 cross_layer: 5 file: parser.c
buffer [ nbchars ++ ] = * current ++; location: 2873 cross_layer: 5 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2874 cross_layer: 5 file: parser.c
if ( xmlParserEntityCheck ( ctxt , nbchars , ent , 0 ) )  location: 2875 cross_layer: 5 file: parser.c
growBuffer ( buffer , XML_PARSER_BUFFER_SIZE ); location: 2877 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 2880 cross_layer: 5 file: parser.c
COPY_BUF ( l , buffer , nbchars , c ); location: 2885 cross_layer: 5 file: parser.c
str += l; location: 2886 cross_layer: 5 file: parser.c
if ( nbchars + XML_PARSER_BUFFER_SIZE > buffer_size )  location: 2887 cross_layer: 5 file: parser.c
if ( str < last )  location: 2891 cross_layer: 5 file: parser.c
c = CUR_SCHAR ( str , l ); location: 2892 cross_layer: 5 file: parser.c
buffer [ nbchars ] = 0; location: 2896 cross_layer: 5 file: parser.c
return ( buffer ) ; location: 2897 cross_layer: 5 file: parser.c
xmlErrMemory ( ctxt , NULL ); location: 2900 cross_layer: 5 file: parser.c
if ( rep != NULL )  location: 2902 cross_layer: 5 file: parser.c
xmlFree ( rep ); location: 2903 cross_layer: 5 file: parser.c
if ( buffer != NULL )  location: 2904 cross_layer: 5 file: parser.c
xmlFree ( buffer ); location: 2905 cross_layer: 5 file: parser.c
------------------------------
