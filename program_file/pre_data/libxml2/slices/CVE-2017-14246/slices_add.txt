1 @@ testCode/CVE-2017-14246_CWE-125_8ddc442d539ca775d80cdbc7af17a718634a743f_ulaw.c_NEW.c @@ f2ulaw_array @@ 855 @@ ['ptr [count]'] @@ {ptr, buffer}
static inline void
d2ulaw_array (const double *ptr, int count, unsigned char *buffer, double normfact) location: 851 cross_layer: 1 file: ulaw.c
while ( -- count >= 0 )  location: 852 cross_layer: 1 file: ulaw.c
if ( ! isfinite ( ptr [ count ] ) )  location: 853 cross_layer: 1 file: ulaw.c
buffer [ count ] = 0; location: 854 cross_layer: 1 file: ulaw.c
if ( ptr [ count ] >= 0 )  location: 855 cross_layer: 1 file: ulaw.c
d2ulaw_array ( ptr + total , bufferlen , ubuf . ucbuf , normfact ); location: 1046 cross_layer: 2 file: ulaw.c
writecount = psf_fwrite ( ubuf . ucbuf , 1 , bufferlen , psf ); location: 1047 cross_layer: 2 file: ulaw.c
total += writecount; location: 1048 cross_layer: 2 file: ulaw.c
if ( writecount < bufferlen )  location: 1049 cross_layer: 2 file: ulaw.c
len -= writecount; location: 1051 cross_layer: 2 file: ulaw.c
return total ; location: 1054 cross_layer: 2 file: ulaw.c
------------------------------
2 @@ testCode/CVE-2017-14246_CWE-125_8ddc442d539ca775d80cdbc7af17a718634a743f_ulaw.c_NEW.c @@ s2ulaw_array @@ 832 @@ ['buffer[count]'] @@ {ptr, buffer}
static inline void
i2ulaw_array (const int *ptr, int count, unsigned char *buffer) location: 829 cross_layer: 1 file: ulaw.c
while ( -- count >= 0 )  location: 830 cross_layer: 1 file: ulaw.c
if ( ptr [ count ] == INT_MIN )  location: 831 cross_layer: 1 file: ulaw.c
buffer [ count ] = ulaw_encode [ INT_MAX >> ( 16 + 2 ) ]; location: 832 cross_layer: 1 file: ulaw.c
if ( ptr [ count ] >= 0 )  location: 833 cross_layer: 1 file: ulaw.c
buffer [ count ] = ulaw_encode [ ptr [ count ] >> ( 16 + 2 ) ]; location: 834 cross_layer: 1 file: ulaw.c
buffer [ count ] = 0x7F & ulaw_encode [ - ptr [ count ] >> ( 16 + 2 ) ]; location: 836 cross_layer: 1 file: ulaw.c
i2ulaw_array ( ptr + total , bufferlen , ubuf . ucbuf ); location: 994 cross_layer: 2 file: ulaw.c
writecount = psf_fwrite ( ubuf . ucbuf , 1 , bufferlen , psf ); location: 995 cross_layer: 2 file: ulaw.c
total += writecount; location: 996 cross_layer: 2 file: ulaw.c
if ( writecount < bufferlen )  location: 997 cross_layer: 2 file: ulaw.c
len -= writecount; location: 999 cross_layer: 2 file: ulaw.c
return total ; location: 1002 cross_layer: 2 file: ulaw.c
------------------------------
3 @@ testCode/CVE-2017-14246_CWE-125_8ddc442d539ca775d80cdbc7af17a718634a743f_ulaw.c_NEW.c @@ s2ulaw_array @@ 833 @@ ['ptr [count]'] @@ {ptr, buffer}
static inline void
i2ulaw_array (const int *ptr, int count, unsigned char *buffer) location: 829 cross_layer: 1 file: ulaw.c
while ( -- count >= 0 )  location: 830 cross_layer: 1 file: ulaw.c
if ( ptr [ count ] == INT_MIN )  location: 831 cross_layer: 1 file: ulaw.c
buffer [ count ] = ulaw_encode [ INT_MAX >> ( 16 + 2 ) ]; location: 832 cross_layer: 1 file: ulaw.c
if ( ptr [ count ] >= 0 )  location: 833 cross_layer: 1 file: ulaw.c
i2ulaw_array ( ptr + total , bufferlen , ubuf . ucbuf ); location: 994 cross_layer: 2 file: ulaw.c
writecount = psf_fwrite ( ubuf . ucbuf , 1 , bufferlen , psf ); location: 995 cross_layer: 2 file: ulaw.c
total += writecount; location: 996 cross_layer: 2 file: ulaw.c
if ( writecount < bufferlen )  location: 997 cross_layer: 2 file: ulaw.c
len -= writecount; location: 999 cross_layer: 2 file: ulaw.c
return total ; location: 1002 cross_layer: 2 file: ulaw.c
------------------------------
4 @@ testCode/CVE-2017-14246_CWE-125_8ddc442d539ca775d80cdbc7af17a718634a743f_ulaw.c_NEW.c @@ f2ulaw_array @@ 854 @@ ['buffer[count]'] @@ {ptr, buffer}
static inline void
d2ulaw_array (const double *ptr, int count, unsigned char *buffer, double normfact) location: 851 cross_layer: 1 file: ulaw.c
while ( -- count >= 0 )  location: 852 cross_layer: 1 file: ulaw.c
if ( ! isfinite ( ptr [ count ] ) )  location: 853 cross_layer: 1 file: ulaw.c
buffer [ count ] = 0; location: 854 cross_layer: 1 file: ulaw.c
if ( ptr [ count ] >= 0 )  location: 855 cross_layer: 1 file: ulaw.c
buffer [ count ] = ulaw_encode [ lrint ( normfact * ptr [ count ] ) ]; location: 856 cross_layer: 1 file: ulaw.c
buffer [ count ] = 0x7F & ulaw_encode [ - lrint ( normfact * ptr [ count ] ) ]; location: 858 cross_layer: 1 file: ulaw.c
d2ulaw_array ( ptr + total , bufferlen , ubuf . ucbuf , normfact ); location: 1046 cross_layer: 2 file: ulaw.c
writecount = psf_fwrite ( ubuf . ucbuf , 1 , bufferlen , psf ); location: 1047 cross_layer: 2 file: ulaw.c
total += writecount; location: 1048 cross_layer: 2 file: ulaw.c
if ( writecount < bufferlen )  location: 1049 cross_layer: 2 file: ulaw.c
len -= writecount; location: 1051 cross_layer: 2 file: ulaw.c
return total ; location: 1054 cross_layer: 2 file: ulaw.c
------------------------------
1 @@ testCode/CVE-2017-14246_CWE-125_8ddc442d539ca775d80cdbc7af17a718634a743f_ulaw.c_NEW.c @@ f2ulaw_array @@ 855 @@ ['ptr [count]'] @@ {ptr, buffer}
static inline void
d2ulaw_array (const double *ptr, int count, unsigned char *buffer, double normfact) location: 851 cross_layer: 1 file: ulaw.c
while ( -- count >= 0 )  location: 852 cross_layer: 1 file: ulaw.c
if ( ! isfinite ( ptr [ count ] ) )  location: 853 cross_layer: 1 file: ulaw.c
buffer [ count ] = 0; location: 854 cross_layer: 1 file: ulaw.c
if ( ptr [ count ] >= 0 )  location: 855 cross_layer: 1 file: ulaw.c
d2ulaw_array ( ptr + total , bufferlen , ubuf . ucbuf , normfact ); location: 1046 cross_layer: 2 file: ulaw.c
writecount = psf_fwrite ( ubuf . ucbuf , 1 , bufferlen , psf ); location: 1047 cross_layer: 2 file: ulaw.c
total += writecount; location: 1048 cross_layer: 2 file: ulaw.c
if ( writecount < bufferlen )  location: 1049 cross_layer: 2 file: ulaw.c
len -= writecount; location: 1051 cross_layer: 2 file: ulaw.c
return total ; location: 1054 cross_layer: 2 file: ulaw.c
------------------------------
2 @@ testCode/CVE-2017-14246_CWE-125_8ddc442d539ca775d80cdbc7af17a718634a743f_ulaw.c_NEW.c @@ s2ulaw_array @@ 832 @@ ['buffer[count]'] @@ {ptr, buffer}
static inline void
i2ulaw_array (const int *ptr, int count, unsigned char *buffer) location: 829 cross_layer: 1 file: ulaw.c
while ( -- count >= 0 )  location: 830 cross_layer: 1 file: ulaw.c
if ( ptr [ count ] == INT_MIN )  location: 831 cross_layer: 1 file: ulaw.c
buffer [ count ] = ulaw_encode [ INT_MAX >> ( 16 + 2 ) ]; location: 832 cross_layer: 1 file: ulaw.c
if ( ptr [ count ] >= 0 )  location: 833 cross_layer: 1 file: ulaw.c
buffer [ count ] = ulaw_encode [ ptr [ count ] >> ( 16 + 2 ) ]; location: 834 cross_layer: 1 file: ulaw.c
buffer [ count ] = 0x7F & ulaw_encode [ - ptr [ count ] >> ( 16 + 2 ) ]; location: 836 cross_layer: 1 file: ulaw.c
i2ulaw_array ( ptr + total , bufferlen , ubuf . ucbuf ); location: 994 cross_layer: 2 file: ulaw.c
writecount = psf_fwrite ( ubuf . ucbuf , 1 , bufferlen , psf ); location: 995 cross_layer: 2 file: ulaw.c
total += writecount; location: 996 cross_layer: 2 file: ulaw.c
if ( writecount < bufferlen )  location: 997 cross_layer: 2 file: ulaw.c
len -= writecount; location: 999 cross_layer: 2 file: ulaw.c
return total ; location: 1002 cross_layer: 2 file: ulaw.c
------------------------------
3 @@ testCode/CVE-2017-14246_CWE-125_8ddc442d539ca775d80cdbc7af17a718634a743f_ulaw.c_NEW.c @@ s2ulaw_array @@ 833 @@ ['ptr [count]'] @@ {ptr, buffer}
static inline void
i2ulaw_array (const int *ptr, int count, unsigned char *buffer) location: 829 cross_layer: 1 file: ulaw.c
while ( -- count >= 0 )  location: 830 cross_layer: 1 file: ulaw.c
if ( ptr [ count ] == INT_MIN )  location: 831 cross_layer: 1 file: ulaw.c
buffer [ count ] = ulaw_encode [ INT_MAX >> ( 16 + 2 ) ]; location: 832 cross_layer: 1 file: ulaw.c
if ( ptr [ count ] >= 0 )  location: 833 cross_layer: 1 file: ulaw.c
i2ulaw_array ( ptr + total , bufferlen , ubuf . ucbuf ); location: 994 cross_layer: 2 file: ulaw.c
writecount = psf_fwrite ( ubuf . ucbuf , 1 , bufferlen , psf ); location: 995 cross_layer: 2 file: ulaw.c
total += writecount; location: 996 cross_layer: 2 file: ulaw.c
if ( writecount < bufferlen )  location: 997 cross_layer: 2 file: ulaw.c
len -= writecount; location: 999 cross_layer: 2 file: ulaw.c
return total ; location: 1002 cross_layer: 2 file: ulaw.c
------------------------------
4 @@ testCode/CVE-2017-14246_CWE-125_8ddc442d539ca775d80cdbc7af17a718634a743f_ulaw.c_NEW.c @@ f2ulaw_array @@ 854 @@ ['buffer[count]'] @@ {ptr, buffer}
static inline void
d2ulaw_array (const double *ptr, int count, unsigned char *buffer, double normfact) location: 851 cross_layer: 1 file: ulaw.c
while ( -- count >= 0 )  location: 852 cross_layer: 1 file: ulaw.c
if ( ! isfinite ( ptr [ count ] ) )  location: 853 cross_layer: 1 file: ulaw.c
buffer [ count ] = 0; location: 854 cross_layer: 1 file: ulaw.c
if ( ptr [ count ] >= 0 )  location: 855 cross_layer: 1 file: ulaw.c
buffer [ count ] = ulaw_encode [ lrint ( normfact * ptr [ count ] ) ]; location: 856 cross_layer: 1 file: ulaw.c
buffer [ count ] = 0x7F & ulaw_encode [ - lrint ( normfact * ptr [ count ] ) ]; location: 858 cross_layer: 1 file: ulaw.c
d2ulaw_array ( ptr + total , bufferlen , ubuf . ucbuf , normfact ); location: 1046 cross_layer: 2 file: ulaw.c
writecount = psf_fwrite ( ubuf . ucbuf , 1 , bufferlen , psf ); location: 1047 cross_layer: 2 file: ulaw.c
total += writecount; location: 1048 cross_layer: 2 file: ulaw.c
if ( writecount < bufferlen )  location: 1049 cross_layer: 2 file: ulaw.c
len -= writecount; location: 1051 cross_layer: 2 file: ulaw.c
return total ; location: 1054 cross_layer: 2 file: ulaw.c
------------------------------
