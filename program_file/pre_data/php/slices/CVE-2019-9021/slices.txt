1 @@ testCode/CVE-2019-9021_CWE-125_9d388b95c54ea053ce6f194defe1ff6673195747_phar.c_OLD.c @@ phar_detect_phar_fname_ext @@ 2029 @@ ['pos'] @@ {filename, pos ,, slash, pphar, str_key}
int phar_detect_phar_fname_ext(const char *filename, size_t filename_len, const char **ext_str, size_t *ext_len, int executable, int for_create, int is_complete) /* location: 1915 cross_layer: 1 file: phar.c
const char * pos , * slash ; location: 1917 cross_layer: 1 file: phar.c
if ( ! filename_len || filename_len == 1 )  location: 1922 cross_layer: 1 file: phar.c
pos = memchr ( filename , '/' , filename_len ); location: 1928 cross_layer: 1 file: phar.c
if ( pos && pos != filename )  location: 1930 cross_layer: 1 file: phar.c
if ( * ( pos - 1 ) == ':' && ( size_t ) ( pos - filename ) < filename_len - 1 && * ( pos + 1 ) == '/' )  location: 1932 cross_layer: 1 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_alias_map ) ) , ( char * ) filename , pos - filename ) )  location: 1937 cross_layer: 1 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_alias , ( char * ) filename , pos - filename ) )  location: 1943 cross_layer: 1 file: phar.c
if ( zend_hash_num_elements ( & ( PHAR_G ( phar_fname_map ) ) ) || PHAR_G ( manifest_cached ) )  location: 1950 cross_layer: 1 file: phar.c
phar_archive_data * pphar ; location: 1951 cross_layer: 1 file: phar.c
if ( is_complete )  location: 1953 cross_layer: 1 file: phar.c
if ( NULL != ( pphar = zend_hash_str_find_ptr ( & ( PHAR_G ( phar_fname_map ) ) , ( char * ) filename , filename_len ) ) )  location: 1954 cross_layer: 1 file: phar.c
if ( PHAR_G ( manifest_cached ) && NULL != ( pphar = zend_hash_str_find_ptr ( & cached_phars , ( char * ) filename , filename_len ) ) )  location: 1974 cross_layer: 1 file: phar.c
zend_string * str_key ; location: 1979 cross_layer: 1 file: phar.c
zend_ulong unused ; location: 1980 cross_layer: 1 file: phar.c
for (zend_hash_internal_pointer_reset(&(PHAR_G(phar_fname_map)));
HASH_KEY_NON_EXISTENT != zend_hash_get_current_key(&(PHAR_G(phar_fname_map)), &str_key, &unused);
zend_hash_move_forward(&(PHAR_G(phar_fname_map))) location: 1984 cross_layer: 1 file: phar.c
if ( ZSTR_LEN ( str_key ) > ( uint32_t ) filename_len )  location: 1986 cross_layer: 1 file: phar.c
if ( ! memcmp ( filename , ZSTR_VAL ( str_key ) , ZSTR_LEN ( str_key ) ) && ( ( uint32_t ) filename_len == ZSTR_LEN ( str_key ) || filename [ ZSTR_LEN ( str_key ) ] == '/' || filename [ ZSTR_LEN ( str_key ) ] == '\0' ) )  location: 1990 cross_layer: 1 file: phar.c
if ( NULL == ( pphar = zend_hash_get_current_data_ptr ( & ( PHAR_G ( phar_fname_map ) ) ) ) )  location: 1992 cross_layer: 1 file: phar.c
if ( PHAR_G ( manifest_cached ) )  location: 2000 cross_layer: 1 file: phar.c
for (zend_hash_internal_pointer_reset(&cached_phars);
HASH_KEY_NON_EXISTENT != zend_hash_get_current_key(&cached_phars, &str_key, &unused);
zend_hash_move_forward(&cached_phars) location: 2003 cross_layer: 1 file: phar.c
if ( ZSTR_LEN ( str_key ) > ( uint32_t ) filename_len )  location: 2005 cross_layer: 1 file: phar.c
if ( ! memcmp ( filename , ZSTR_VAL ( str_key ) , ZSTR_LEN ( str_key ) ) && ( ( uint32_t ) filename_len == ZSTR_LEN ( str_key ) || filename [ ZSTR_LEN ( str_key ) ] == '/' || filename [ ZSTR_LEN ( str_key ) ] == '\0' ) )  location: 2009 cross_layer: 1 file: phar.c
if ( NULL == ( pphar = zend_hash_get_current_data_ptr ( & cached_phars ) ) )  location: 2011 cross_layer: 1 file: phar.c
pos = memchr ( filename + 1 , '.' , filename_len ); location: 2022 cross_layer: 1 file: phar.c
if ( ! pos )  location: 2024 cross_layer: 1 file: phar.c
while ( pos != filename && ( * ( pos - 1 ) == '/' || * ( pos - 1 ) == '\0' ) )  location: 2028 cross_layer: 1 file: phar.c
pos = memchr ( pos + 1 , '.' , filename_len - ( pos - filename ) + 1 ); location: 2029 cross_layer: 1 file: phar.c
if ( ! pos )  location: 2030 cross_layer: 1 file: phar.c
slash = memchr ( pos , '/' , filename_len - ( pos - filename ) ); location: 2035 cross_layer: 1 file: phar.c
if ( ! slash )  location: 2037 cross_layer: 1 file: phar.c
* ext_str = pos; location: 2039 cross_layer: 1 file: phar.c
* ext_len = strlen ( pos ); location: 2040 cross_layer: 1 file: phar.c
switch ( phar_check_str ( filename , * ext_str , * ext_len , executable , for_create ) )  location: 2043 cross_layer: 1 file: phar.c
static int phar_check_str(const char *fname, const char *ext_str, size_t ext_len, int executable, int for_create) /* location: 1863 cross_layer: 2 file: phar.c
if ( ext_len >= 50 )  location: 1867 cross_layer: 2 file: phar.c
if ( executable == 1 )  location: 1870 cross_layer: 2 file: phar.c
pos = strstr ( ext_str , ".phar" ); location: 1873 cross_layer: 2 file: phar.c
if ( ! pos || ( pos != ext_str && ( * ( pos - 1 ) == '/' ) ) || ( ext_len - ( pos - ext_str ) ) < 5 || ! ( pos += 5 ) || ! ( * pos == '\0' || * pos == '/' || * pos == '.' ) )  location: 1875 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1882 cross_layer: 2 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
if ( ! executable )  location: 1886 cross_layer: 2 file: phar.c
pos = strstr ( ext_str , ".phar" ); location: 1887 cross_layer: 2 file: phar.c
if ( ! ( pos && ( * ( pos - 1 ) != '/' ) && ( pos += 5 ) && ( * pos == '\0' || * pos == '/' || * pos == '.' ) ) && * ( ext_str + 1 ) != '.' && * ( ext_str + 1 ) != '/' && * ( ext_str + 1 ) != '\0' )  location: 1888 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1890 cross_layer: 2 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
if ( * ( ext_str + 1 ) != '.' && * ( ext_str + 1 ) != '/' && * ( ext_str + 1 ) != '\0' )  location: 1893 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1894 cross_layer: 2 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
* ext_str = pos; location: 2053 cross_layer: 1 file: phar.c
* ext_len = slash - pos; location: 2054 cross_layer: 1 file: phar.c
switch ( phar_check_str ( filename , * ext_str , * ext_len , executable , for_create ) )  location: 2056 cross_layer: 1 file: phar.c
static int phar_check_str(const char *fname, const char *ext_str, size_t ext_len, int executable, int for_create) /* location: 1863 cross_layer: 2 file: phar.c
if ( ext_len >= 50 )  location: 1867 cross_layer: 2 file: phar.c
if ( executable == 1 )  location: 1870 cross_layer: 2 file: phar.c
pos = strstr ( ext_str , ".phar" ); location: 1873 cross_layer: 2 file: phar.c
if ( ! pos || ( pos != ext_str && ( * ( pos - 1 ) == '/' ) ) || ( ext_len - ( pos - ext_str ) ) < 5 || ! ( pos += 5 ) || ! ( * pos == '\0' || * pos == '/' || * pos == '.' ) )  location: 1875 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1882 cross_layer: 2 file: phar.c
if ( ! executable )  location: 1886 cross_layer: 2 file: phar.c
pos = strstr ( ext_str , ".phar" ); location: 1887 cross_layer: 2 file: phar.c
if ( ! ( pos && ( * ( pos - 1 ) != '/' ) && ( pos += 5 ) && ( * pos == '\0' || * pos == '/' || * pos == '.' ) ) && * ( ext_str + 1 ) != '.' && * ( ext_str + 1 ) != '/' && * ( ext_str + 1 ) != '\0' )  location: 1888 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1890 cross_layer: 2 file: phar.c
if ( * ( ext_str + 1 ) != '.' && * ( ext_str + 1 ) != '/' && * ( ext_str + 1 ) != '\0' )  location: 1893 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1894 cross_layer: 2 file: phar.c
pos = strchr ( pos + 1 , '.' ); location: 2061 cross_layer: 1 file: phar.c
if ( pos )  location: 2062 cross_layer: 1 file: phar.c
* ext_str = NULL; location: 2063 cross_layer: 1 file: phar.c
* ext_len = 0; location: 2064 cross_layer: 1 file: phar.c
if ( phar_detect_phar_fname_ext ( fname , fname_len , & ext_str , & ext_len , ! is_data , 0 , 1 ) == SUCCESS )  location: 1287 cross_layer: 2 file: phar.c
------------------------------
2 @@ testCode/CVE-2019-9021_CWE-125_9d388b95c54ea053ce6f194defe1ff6673195747_phar.c_OLD.c @@ phar_detect_phar_fname_ext @@ 2029 @@ ['pos'] @@ {filename, pos ,, slash, pphar, str_key}
int phar_detect_phar_fname_ext(const char *filename, size_t filename_len, const char **ext_str, size_t *ext_len, int executable, int for_create, int is_complete) /* location: 1915 cross_layer: 1 file: phar.c
const char * pos , * slash ; location: 1917 cross_layer: 1 file: phar.c
if ( ! filename_len || filename_len == 1 )  location: 1922 cross_layer: 1 file: phar.c
pos = memchr ( filename , '/' , filename_len ); location: 1928 cross_layer: 1 file: phar.c
if ( pos && pos != filename )  location: 1930 cross_layer: 1 file: phar.c
if ( * ( pos - 1 ) == ':' && ( size_t ) ( pos - filename ) < filename_len - 1 && * ( pos + 1 ) == '/' )  location: 1932 cross_layer: 1 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_alias_map ) ) , ( char * ) filename , pos - filename ) )  location: 1937 cross_layer: 1 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_alias , ( char * ) filename , pos - filename ) )  location: 1943 cross_layer: 1 file: phar.c
if ( zend_hash_num_elements ( & ( PHAR_G ( phar_fname_map ) ) ) || PHAR_G ( manifest_cached ) )  location: 1950 cross_layer: 1 file: phar.c
phar_archive_data * pphar ; location: 1951 cross_layer: 1 file: phar.c
if ( is_complete )  location: 1953 cross_layer: 1 file: phar.c
if ( NULL != ( pphar = zend_hash_str_find_ptr ( & ( PHAR_G ( phar_fname_map ) ) , ( char * ) filename , filename_len ) ) )  location: 1954 cross_layer: 1 file: phar.c
if ( PHAR_G ( manifest_cached ) && NULL != ( pphar = zend_hash_str_find_ptr ( & cached_phars , ( char * ) filename , filename_len ) ) )  location: 1974 cross_layer: 1 file: phar.c
zend_string * str_key ; location: 1979 cross_layer: 1 file: phar.c
zend_ulong unused ; location: 1980 cross_layer: 1 file: phar.c
for (zend_hash_internal_pointer_reset(&(PHAR_G(phar_fname_map)));
HASH_KEY_NON_EXISTENT != zend_hash_get_current_key(&(PHAR_G(phar_fname_map)), &str_key, &unused);
zend_hash_move_forward(&(PHAR_G(phar_fname_map))) location: 1984 cross_layer: 1 file: phar.c
if ( ZSTR_LEN ( str_key ) > ( uint32_t ) filename_len )  location: 1986 cross_layer: 1 file: phar.c
if ( ! memcmp ( filename , ZSTR_VAL ( str_key ) , ZSTR_LEN ( str_key ) ) && ( ( uint32_t ) filename_len == ZSTR_LEN ( str_key ) || filename [ ZSTR_LEN ( str_key ) ] == '/' || filename [ ZSTR_LEN ( str_key ) ] == '\0' ) )  location: 1990 cross_layer: 1 file: phar.c
if ( NULL == ( pphar = zend_hash_get_current_data_ptr ( & ( PHAR_G ( phar_fname_map ) ) ) ) )  location: 1992 cross_layer: 1 file: phar.c
if ( PHAR_G ( manifest_cached ) )  location: 2000 cross_layer: 1 file: phar.c
for (zend_hash_internal_pointer_reset(&cached_phars);
HASH_KEY_NON_EXISTENT != zend_hash_get_current_key(&cached_phars, &str_key, &unused);
zend_hash_move_forward(&cached_phars) location: 2003 cross_layer: 1 file: phar.c
if ( ZSTR_LEN ( str_key ) > ( uint32_t ) filename_len )  location: 2005 cross_layer: 1 file: phar.c
if ( ! memcmp ( filename , ZSTR_VAL ( str_key ) , ZSTR_LEN ( str_key ) ) && ( ( uint32_t ) filename_len == ZSTR_LEN ( str_key ) || filename [ ZSTR_LEN ( str_key ) ] == '/' || filename [ ZSTR_LEN ( str_key ) ] == '\0' ) )  location: 2009 cross_layer: 1 file: phar.c
if ( NULL == ( pphar = zend_hash_get_current_data_ptr ( & cached_phars ) ) )  location: 2011 cross_layer: 1 file: phar.c
pos = memchr ( filename + 1 , '.' , filename_len ); location: 2022 cross_layer: 1 file: phar.c
if ( ! pos )  location: 2024 cross_layer: 1 file: phar.c
while ( pos != filename && ( * ( pos - 1 ) == '/' || * ( pos - 1 ) == '\0' ) )  location: 2028 cross_layer: 1 file: phar.c
pos = memchr ( pos + 1 , '.' , filename_len - ( pos - filename ) + 1 ); location: 2029 cross_layer: 1 file: phar.c
if ( ! pos )  location: 2030 cross_layer: 1 file: phar.c
slash = memchr ( pos , '/' , filename_len - ( pos - filename ) ); location: 2035 cross_layer: 1 file: phar.c
if ( ! slash )  location: 2037 cross_layer: 1 file: phar.c
* ext_str = pos; location: 2039 cross_layer: 1 file: phar.c
* ext_len = strlen ( pos ); location: 2040 cross_layer: 1 file: phar.c
switch ( phar_check_str ( filename , * ext_str , * ext_len , executable , for_create ) )  location: 2043 cross_layer: 1 file: phar.c
static int phar_check_str(const char *fname, const char *ext_str, size_t ext_len, int executable, int for_create) /* location: 1863 cross_layer: 2 file: phar.c
if ( ext_len >= 50 )  location: 1867 cross_layer: 2 file: phar.c
if ( executable == 1 )  location: 1870 cross_layer: 2 file: phar.c
pos = strstr ( ext_str , ".phar" ); location: 1873 cross_layer: 2 file: phar.c
if ( ! pos || ( pos != ext_str && ( * ( pos - 1 ) == '/' ) ) || ( ext_len - ( pos - ext_str ) ) < 5 || ! ( pos += 5 ) || ! ( * pos == '\0' || * pos == '/' || * pos == '.' ) )  location: 1875 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1882 cross_layer: 2 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
if ( ! executable )  location: 1886 cross_layer: 2 file: phar.c
pos = strstr ( ext_str , ".phar" ); location: 1887 cross_layer: 2 file: phar.c
if ( ! ( pos && ( * ( pos - 1 ) != '/' ) && ( pos += 5 ) && ( * pos == '\0' || * pos == '/' || * pos == '.' ) ) && * ( ext_str + 1 ) != '.' && * ( ext_str + 1 ) != '/' && * ( ext_str + 1 ) != '\0' )  location: 1888 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1890 cross_layer: 2 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
if ( * ( ext_str + 1 ) != '.' && * ( ext_str + 1 ) != '/' && * ( ext_str + 1 ) != '\0' )  location: 1893 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1894 cross_layer: 2 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
* ext_str = pos; location: 2053 cross_layer: 1 file: phar.c
* ext_len = slash - pos; location: 2054 cross_layer: 1 file: phar.c
switch ( phar_check_str ( filename , * ext_str , * ext_len , executable , for_create ) )  location: 2056 cross_layer: 1 file: phar.c
static int phar_check_str(const char *fname, const char *ext_str, size_t ext_len, int executable, int for_create) /* location: 1863 cross_layer: 2 file: phar.c
if ( ext_len >= 50 )  location: 1867 cross_layer: 2 file: phar.c
if ( executable == 1 )  location: 1870 cross_layer: 2 file: phar.c
pos = strstr ( ext_str , ".phar" ); location: 1873 cross_layer: 2 file: phar.c
if ( ! pos || ( pos != ext_str && ( * ( pos - 1 ) == '/' ) ) || ( ext_len - ( pos - ext_str ) ) < 5 || ! ( pos += 5 ) || ! ( * pos == '\0' || * pos == '/' || * pos == '.' ) )  location: 1875 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1882 cross_layer: 2 file: phar.c
if ( ! executable )  location: 1886 cross_layer: 2 file: phar.c
pos = strstr ( ext_str , ".phar" ); location: 1887 cross_layer: 2 file: phar.c
if ( ! ( pos && ( * ( pos - 1 ) != '/' ) && ( pos += 5 ) && ( * pos == '\0' || * pos == '/' || * pos == '.' ) ) && * ( ext_str + 1 ) != '.' && * ( ext_str + 1 ) != '/' && * ( ext_str + 1 ) != '\0' )  location: 1888 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1890 cross_layer: 2 file: phar.c
if ( * ( ext_str + 1 ) != '.' && * ( ext_str + 1 ) != '/' && * ( ext_str + 1 ) != '\0' )  location: 1893 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1894 cross_layer: 2 file: phar.c
pos = strchr ( pos + 1 , '.' ); location: 2061 cross_layer: 1 file: phar.c
if ( pos )  location: 2062 cross_layer: 1 file: phar.c
* ext_str = NULL; location: 2063 cross_layer: 1 file: phar.c
* ext_len = 0; location: 2064 cross_layer: 1 file: phar.c
if ( FAILURE == phar_detect_phar_fname_ext ( fname , fname_len , & ext_str , & ext_len , ! is_data , 1 , 1 ) )  location: 1292 cross_layer: 2 file: phar.c
------------------------------
3 @@ testCode/CVE-2019-9021_CWE-125_9d388b95c54ea053ce6f194defe1ff6673195747_phar.c_OLD.c @@ phar_detect_phar_fname_ext @@ 2029 @@ ['pos'] @@ {filename, pos ,, slash, pphar, str_key}
int phar_detect_phar_fname_ext(const char *filename, size_t filename_len, const char **ext_str, size_t *ext_len, int executable, int for_create, int is_complete) /* location: 1915 cross_layer: 1 file: phar.c
const char * pos , * slash ; location: 1917 cross_layer: 1 file: phar.c
if ( ! filename_len || filename_len == 1 )  location: 1922 cross_layer: 1 file: phar.c
pos = memchr ( filename , '/' , filename_len ); location: 1928 cross_layer: 1 file: phar.c
if ( pos && pos != filename )  location: 1930 cross_layer: 1 file: phar.c
if ( * ( pos - 1 ) == ':' && ( size_t ) ( pos - filename ) < filename_len - 1 && * ( pos + 1 ) == '/' )  location: 1932 cross_layer: 1 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_alias_map ) ) , ( char * ) filename , pos - filename ) )  location: 1937 cross_layer: 1 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_alias , ( char * ) filename , pos - filename ) )  location: 1943 cross_layer: 1 file: phar.c
if ( zend_hash_num_elements ( & ( PHAR_G ( phar_fname_map ) ) ) || PHAR_G ( manifest_cached ) )  location: 1950 cross_layer: 1 file: phar.c
phar_archive_data * pphar ; location: 1951 cross_layer: 1 file: phar.c
if ( is_complete )  location: 1953 cross_layer: 1 file: phar.c
if ( NULL != ( pphar = zend_hash_str_find_ptr ( & ( PHAR_G ( phar_fname_map ) ) , ( char * ) filename , filename_len ) ) )  location: 1954 cross_layer: 1 file: phar.c
if ( PHAR_G ( manifest_cached ) && NULL != ( pphar = zend_hash_str_find_ptr ( & cached_phars , ( char * ) filename , filename_len ) ) )  location: 1974 cross_layer: 1 file: phar.c
zend_string * str_key ; location: 1979 cross_layer: 1 file: phar.c
zend_ulong unused ; location: 1980 cross_layer: 1 file: phar.c
for (zend_hash_internal_pointer_reset(&(PHAR_G(phar_fname_map)));
HASH_KEY_NON_EXISTENT != zend_hash_get_current_key(&(PHAR_G(phar_fname_map)), &str_key, &unused);
zend_hash_move_forward(&(PHAR_G(phar_fname_map))) location: 1984 cross_layer: 1 file: phar.c
if ( ZSTR_LEN ( str_key ) > ( uint32_t ) filename_len )  location: 1986 cross_layer: 1 file: phar.c
if ( ! memcmp ( filename , ZSTR_VAL ( str_key ) , ZSTR_LEN ( str_key ) ) && ( ( uint32_t ) filename_len == ZSTR_LEN ( str_key ) || filename [ ZSTR_LEN ( str_key ) ] == '/' || filename [ ZSTR_LEN ( str_key ) ] == '\0' ) )  location: 1990 cross_layer: 1 file: phar.c
if ( NULL == ( pphar = zend_hash_get_current_data_ptr ( & ( PHAR_G ( phar_fname_map ) ) ) ) )  location: 1992 cross_layer: 1 file: phar.c
if ( PHAR_G ( manifest_cached ) )  location: 2000 cross_layer: 1 file: phar.c
for (zend_hash_internal_pointer_reset(&cached_phars);
HASH_KEY_NON_EXISTENT != zend_hash_get_current_key(&cached_phars, &str_key, &unused);
zend_hash_move_forward(&cached_phars) location: 2003 cross_layer: 1 file: phar.c
if ( ZSTR_LEN ( str_key ) > ( uint32_t ) filename_len )  location: 2005 cross_layer: 1 file: phar.c
if ( ! memcmp ( filename , ZSTR_VAL ( str_key ) , ZSTR_LEN ( str_key ) ) && ( ( uint32_t ) filename_len == ZSTR_LEN ( str_key ) || filename [ ZSTR_LEN ( str_key ) ] == '/' || filename [ ZSTR_LEN ( str_key ) ] == '\0' ) )  location: 2009 cross_layer: 1 file: phar.c
if ( NULL == ( pphar = zend_hash_get_current_data_ptr ( & cached_phars ) ) )  location: 2011 cross_layer: 1 file: phar.c
pos = memchr ( filename + 1 , '.' , filename_len ); location: 2022 cross_layer: 1 file: phar.c
if ( ! pos )  location: 2024 cross_layer: 1 file: phar.c
while ( pos != filename && ( * ( pos - 1 ) == '/' || * ( pos - 1 ) == '\0' ) )  location: 2028 cross_layer: 1 file: phar.c
pos = memchr ( pos + 1 , '.' , filename_len - ( pos - filename ) + 1 ); location: 2029 cross_layer: 1 file: phar.c
if ( ! pos )  location: 2030 cross_layer: 1 file: phar.c
slash = memchr ( pos , '/' , filename_len - ( pos - filename ) ); location: 2035 cross_layer: 1 file: phar.c
if ( ! slash )  location: 2037 cross_layer: 1 file: phar.c
* ext_str = pos; location: 2039 cross_layer: 1 file: phar.c
* ext_len = strlen ( pos ); location: 2040 cross_layer: 1 file: phar.c
switch ( phar_check_str ( filename , * ext_str , * ext_len , executable , for_create ) )  location: 2043 cross_layer: 1 file: phar.c
static int phar_check_str(const char *fname, const char *ext_str, size_t ext_len, int executable, int for_create) /* location: 1863 cross_layer: 2 file: phar.c
if ( ext_len >= 50 )  location: 1867 cross_layer: 2 file: phar.c
if ( executable == 1 )  location: 1870 cross_layer: 2 file: phar.c
pos = strstr ( ext_str , ".phar" ); location: 1873 cross_layer: 2 file: phar.c
if ( ! pos || ( pos != ext_str && ( * ( pos - 1 ) == '/' ) ) || ( ext_len - ( pos - ext_str ) ) < 5 || ! ( pos += 5 ) || ! ( * pos == '\0' || * pos == '/' || * pos == '.' ) )  location: 1875 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1882 cross_layer: 2 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
if ( ! executable )  location: 1886 cross_layer: 2 file: phar.c
pos = strstr ( ext_str , ".phar" ); location: 1887 cross_layer: 2 file: phar.c
if ( ! ( pos && ( * ( pos - 1 ) != '/' ) && ( pos += 5 ) && ( * pos == '\0' || * pos == '/' || * pos == '.' ) ) && * ( ext_str + 1 ) != '.' && * ( ext_str + 1 ) != '/' && * ( ext_str + 1 ) != '\0' )  location: 1888 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1890 cross_layer: 2 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
if ( * ( ext_str + 1 ) != '.' && * ( ext_str + 1 ) != '/' && * ( ext_str + 1 ) != '\0' )  location: 1893 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1894 cross_layer: 2 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
static int phar_analyze_path(const char *fname, const char *ext, size_t ext_len, int for_create) /* location: 1758 cross_layer: 3 file: phar.c
char * filename = estrndup ( fname , ( ext - fname ) + ext_len ) ; location: 1762 cross_layer: 3 file: phar.c
if ( realpath = expand_filepath ( filename , NULL ) )  location: 1764 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1766 cross_layer: 3 file: phar.c
if ( zend_hash_str_exists ( & ( PHAR_G ( phar_fname_map ) ) , realpath , strlen ( realpath ) ) )  location: 1768 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1769 cross_layer: 3 file: phar.c
efree ( filename ); location: 1770 cross_layer: 3 file: phar.c
if ( PHAR_G ( manifest_cached ) && zend_hash_str_exists ( & cached_phars , realpath , strlen ( realpath ) ) )  location: 1774 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1775 cross_layer: 3 file: phar.c
efree ( filename ); location: 1776 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1779 cross_layer: 3 file: phar.c
if ( SUCCESS == php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1782 cross_layer: 3 file: phar.c
efree ( filename ); location: 1784 cross_layer: 3 file: phar.c
if ( for_create == 1 )  location: 1790 cross_layer: 3 file: phar.c
if ( ! for_create )  location: 1798 cross_layer: 3 file: phar.c
efree ( filename ); location: 1799 cross_layer: 3 file: phar.c
slash = ( char * ) strrchr ( filename , '/' ); location: 1803 cross_layer: 3 file: phar.c
if ( slash )  location: 1805 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1806 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( ( char * ) filename , & ssb ) )  location: 1809 cross_layer: 3 file: phar.c
if ( ! slash )  location: 1810 cross_layer: 3 file: phar.c
if ( ! ( realpath = expand_filepath ( filename , NULL ) ) )  location: 1811 cross_layer: 3 file: phar.c
efree ( filename ); location: 1812 cross_layer: 3 file: phar.c
phar_unixify_path_separators ( realpath , strlen ( realpath ) ); location: 1816 cross_layer: 3 file: phar.c
slash = strstr ( realpath , filename ); location: 1818 cross_layer: 3 file: phar.c
if ( slash )  location: 1819 cross_layer: 3 file: phar.c
slash += ( ( ext - fname ) + ext_len ); location: 1820 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1821 cross_layer: 3 file: phar.c
slash = strrchr ( realpath , '/' ); location: 1823 cross_layer: 3 file: phar.c
if ( slash )  location: 1825 cross_layer: 3 file: phar.c
* slash = '\0'; location: 1826 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1828 cross_layer: 3 file: phar.c
efree ( filename ); location: 1829 cross_layer: 3 file: phar.c
if ( SUCCESS != php_stream_stat_path ( realpath , & ssb ) )  location: 1833 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1834 cross_layer: 3 file: phar.c
efree ( filename ); location: 1835 cross_layer: 3 file: phar.c
efree ( realpath ); location: 1839 cross_layer: 3 file: phar.c
efree ( filename ); location: 1842 cross_layer: 3 file: phar.c
efree ( filename ); location: 1847 cross_layer: 3 file: phar.c
efree ( filename ); location: 1851 cross_layer: 3 file: phar.c
* ext_str = pos; location: 2053 cross_layer: 1 file: phar.c
* ext_len = slash - pos; location: 2054 cross_layer: 1 file: phar.c
switch ( phar_check_str ( filename , * ext_str , * ext_len , executable , for_create ) )  location: 2056 cross_layer: 1 file: phar.c
static int phar_check_str(const char *fname, const char *ext_str, size_t ext_len, int executable, int for_create) /* location: 1863 cross_layer: 2 file: phar.c
if ( ext_len >= 50 )  location: 1867 cross_layer: 2 file: phar.c
if ( executable == 1 )  location: 1870 cross_layer: 2 file: phar.c
pos = strstr ( ext_str , ".phar" ); location: 1873 cross_layer: 2 file: phar.c
if ( ! pos || ( pos != ext_str && ( * ( pos - 1 ) == '/' ) ) || ( ext_len - ( pos - ext_str ) ) < 5 || ! ( pos += 5 ) || ! ( * pos == '\0' || * pos == '/' || * pos == '.' ) )  location: 1875 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1882 cross_layer: 2 file: phar.c
if ( ! executable )  location: 1886 cross_layer: 2 file: phar.c
pos = strstr ( ext_str , ".phar" ); location: 1887 cross_layer: 2 file: phar.c
if ( ! ( pos && ( * ( pos - 1 ) != '/' ) && ( pos += 5 ) && ( * pos == '\0' || * pos == '/' || * pos == '.' ) ) && * ( ext_str + 1 ) != '.' && * ( ext_str + 1 ) != '/' && * ( ext_str + 1 ) != '\0' )  location: 1888 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1890 cross_layer: 2 file: phar.c
if ( * ( ext_str + 1 ) != '.' && * ( ext_str + 1 ) != '/' && * ( ext_str + 1 ) != '\0' )  location: 1893 cross_layer: 2 file: phar.c
return phar_analyze_path ( fname , ext_str , ext_len , for_create ) ; location: 1894 cross_layer: 2 file: phar.c
pos = strchr ( pos + 1 , '.' ); location: 2061 cross_layer: 1 file: phar.c
if ( pos )  location: 2062 cross_layer: 1 file: phar.c
* ext_str = NULL; location: 2063 cross_layer: 1 file: phar.c
* ext_len = 0; location: 2064 cross_layer: 1 file: phar.c
if ( phar_detect_phar_fname_ext ( filename , filename_len , & ext_str , & ext_len , executable , for_create , 0 ) == FAILURE )  location: 2232 cross_layer: 2 file: phar.c
------------------------------
