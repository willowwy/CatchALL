1 @@ testCode/CVE-2019-9022_CWE-125_8d3dfabef459fe7815e8ea2fd68753fd17859d7b_dns.c_NEW.c @@ *php_parserr @@ 556 @@ ['dlen'] @@ {cp, end, answer}
static u_char *php_parserr(u_char *cp, u_char *end, querybuf *answer, int type_to_fetch, int store, int raw, zval *subarray) location: 438 cross_layer: 1 file: dns.c
u_short type , class , dlen location: 440 cross_layer: 1 file: dns.c
long n , i ; location: 442 cross_layer: 1 file: dns.c
char name [ MAXHOSTNAMELEN ] ; location: 445 cross_layer: 1 file: dns.c
n = dn_expand ( answer -> qb2 , end , cp , name , sizeof ( name ) - 2 ); location: 450 cross_layer: 1 file: dns.c
if ( n < 0 )  location: 451 cross_layer: 1 file: dns.c
cp += n; location: 454 cross_layer: 1 file: dns.c
if ( dlen == 0 )  location: 462 cross_layer: 1 file: dns.c
if ( type_to_fetch != T_ANY && type != type_to_fetch )  location: 466 cross_layer: 1 file: dns.c
if ( ! store )  location: 471 cross_layer: 1 file: dns.c
if ( raw )  location: 483 cross_layer: 1 file: dns.c
switch ( type )  location: 490 cross_layer: 1 file: dns.c
snprintf ( name , sizeof ( name ) , "%d.%d.%d.%d" , cp [ 0 ] , cp [ 1 ] , cp [ 2 ] , cp [ 3 ] ); location: 494 cross_layer: 1 file: dns.c
cp += dlen; location: 496 cross_layer: 1 file: dns.c
n = dn_expand ( answer -> qb2 , end , cp , name , ( sizeof name ) - 2 ); location: 518 cross_layer: 1 file: dns.c
if ( n < 0 )  location: 519 cross_layer: 1 file: dns.c
cp += n; location: 522 cross_layer: 1 file: dns.c
n = * cp & 0xFF; location: 529 cross_layer: 1 file: dns.c
cp ++; location: 530 cross_layer: 1 file: dns.c
cp += n; location: 533 cross_layer: 1 file: dns.c
n = * cp & 0xFF; location: 535 cross_layer: 1 file: dns.c
cp ++; location: 536 cross_layer: 1 file: dns.c
cp += n; location: 539 cross_layer: 1 file: dns.c
n = * cp & 0xFF; location: 546 cross_layer: 1 file: dns.c
cp ++; location: 548 cross_layer: 1 file: dns.c
n = * cp & 0xFF; location: 551 cross_layer: 1 file: dns.c
if ( ( size_t ) dlen < ( ( size_t ) n ) + 2 )  location: 556 cross_layer: 1 file: dns.c
------------------------------
2 @@ testCode/CVE-2019-9022_CWE-125_8d3dfabef459fe7815e8ea2fd68753fd17859d7b_dns.c_NEW.c @@ *php_parserr @@ 462 @@ ['dlen'] @@ {cp, end, answer}
static u_char *php_parserr(u_char *cp, u_char *end, querybuf *answer, int type_to_fetch, int store, int raw, zval *subarray) location: 438 cross_layer: 1 file: dns.c
u_short type , class , dlen location: 440 cross_layer: 1 file: dns.c
long n , i ; location: 442 cross_layer: 1 file: dns.c
char name [ MAXHOSTNAMELEN ] ; location: 445 cross_layer: 1 file: dns.c
n = dn_expand ( answer -> qb2 , end , cp , name , sizeof ( name ) - 2 ); location: 450 cross_layer: 1 file: dns.c
if ( n < 0 )  location: 451 cross_layer: 1 file: dns.c
if ( dlen == 0 )  location: 462 cross_layer: 1 file: dns.c
------------------------------
