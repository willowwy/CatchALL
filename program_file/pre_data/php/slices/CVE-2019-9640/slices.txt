1 @@ testCode/CVE-2019-9640_CWE-125_30d2b94a2e88021b77b07149e1f4438662ca8e5e_exif.c_OLD.c @@ exif_scan_thumbnail @@ 3905 @@ ['length', 'pos'] @@ {ImageInfo, data}
static int exif_scan_thumbnail(image_info_type *ImageInfo) location: 3869 cross_layer: 1 file: exif.c
uchar c , * data = ( uchar * ) ImageInfo -> Thumbnail . data ; location: 3871 cross_layer: 1 file: exif.c
int n , marker ; location: 3872 cross_layer: 1 file: exif.c
size_t length = 2 , pos = 0 ; location: 3873 cross_layer: 1 file: exif.c
pos += length; location: 3886 cross_layer: 1 file: exif.c
if ( pos >= ImageInfo -> Thumbnail . size )  location: 3887 cross_layer: 1 file: exif.c
c = data [ pos ++ ]; location: 3889 cross_layer: 1 file: exif.c
if ( pos >= ImageInfo -> Thumbnail . size )  location: 3890 cross_layer: 1 file: exif.c
if ( c != 0xFF )  location: 3892 cross_layer: 1 file: exif.c
n = 8; location: 3895 cross_layer: 1 file: exif.c
while ( ( c = data [ pos ++ ] ) == 0xFF && n -- )  location: 3896 cross_layer: 1 file: exif.c
if ( c == 0xFF )  location: 3901 cross_layer: 1 file: exif.c
length = php_jpg_get16 ( data + pos ); location: 3904 cross_layer: 1 file: exif.c
if ( pos + length >= ImageInfo -> Thumbnail . size )  location: 3905 cross_layer: 1 file: exif.c
------------------------------
