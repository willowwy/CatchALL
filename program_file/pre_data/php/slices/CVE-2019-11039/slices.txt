1 @@ testCode/CVE-2019-11039_CWE-125_7cf7148a8f8f4f55fb04de2a517d740bb6253eac_iconv.c_OLD.c @@ _php_iconv_mime_decode @@ 1676 @@ ['str_left'] @@ {pretval, str, enc, p1, csname, encoded_word}
static php_iconv_err_t _php_iconv_mime_decode(smart_str *pretval, const char *str, size_t str_nbytes, const char *enc, const char **next_pos, int mode) location: 1484 cross_layer: 1 file: iconv.c
const char * p1 ; location: 1490 cross_layer: 1 file: iconv.c
size_t str_left ; location: 1491 cross_layer: 1 file: iconv.c
unsigned int scan_stat = 0 ; location: 1492 cross_layer: 1 file: iconv.c
const char * csname = NULL ; location: 1493 cross_layer: 1 file: iconv.c
size_t csname_len ; location: 1494 cross_layer: 1 file: iconv.c
const char * encoded_word = NULL ; location: 1497 cross_layer: 1 file: iconv.c
cd_pl = iconv_open ( enc , ICONV_ASCII_ENCODING ); location: 1506 cross_layer: 1 file: iconv.c
if ( cd_pl == ( iconv_t ) ( - 1 ) )  location: 1508 cross_layer: 1 file: iconv.c
p1 = str; location: 1521 cross_layer: 1 file: iconv.c
for (str_left = str_nbytes; str_left > 0; str_left--, p1++) location: 1522 cross_layer: 1 file: iconv.c
switch ( scan_stat )  location: 1525 cross_layer: 1 file: iconv.c
switch ( * p1 )  location: 1527 cross_layer: 1 file: iconv.c
scan_stat = 7; location: 1529 cross_layer: 1 file: iconv.c
scan_stat = 8; location: 1533 cross_layer: 1 file: iconv.c
encoded_word = p1; location: 1537 cross_layer: 1 file: iconv.c
scan_stat = 1; location: 1538 cross_layer: 1 file: iconv.c
scan_stat = 11; location: 1543 cross_layer: 1 file: iconv.c
err = _php_iconv_appendc ( pretval , * p1 , cd_pl ); location: 1547 cross_layer: 1 file: iconv.c
if ( err != PHP_ICONV_ERR_SUCCESS )  location: 1548 cross_layer: 1 file: iconv.c
if ( mode & PHP_ICONV_MIME_DECODE_CONTINUE_ON_ERROR )  location: 1549 cross_layer: 1 file: iconv.c
err = PHP_ICONV_ERR_SUCCESS; location: 1550 cross_layer: 1 file: iconv.c
encoded_word = NULL; location: 1555 cross_layer: 1 file: iconv.c
if ( mode & PHP_ICONV_MIME_DECODE_STRICT )  location: 1556 cross_layer: 1 file: iconv.c
scan_stat = 12; location: 1557 cross_layer: 1 file: iconv.c
if ( * p1 != '?' )  location: 1564 cross_layer: 1 file: iconv.c
err = _php_iconv_appendl ( pretval , encoded_word , ( size_t ) ( ( p1 + 1 ) - encoded_word ) , cd_pl ); location: 1568 cross_layer: 1 file: iconv.c
if ( err != PHP_ICONV_ERR_SUCCESS )  location: 1569 cross_layer: 1 file: iconv.c
if ( mode & PHP_ICONV_MIME_DECODE_STRICT )  location: 1573 cross_layer: 1 file: iconv.c
scan_stat = 12; location: 1574 cross_layer: 1 file: iconv.c
scan_stat = 0; location: 1576 cross_layer: 1 file: iconv.c
csname = p1 + 1; location: 1580 cross_layer: 1 file: iconv.c
scan_stat = 2; location: 1581 cross_layer: 1 file: iconv.c
switch ( * p1 )  location: 1585 cross_layer: 1 file: iconv.c
scan_stat = 3; location: 1587 cross_layer: 1 file: iconv.c
scan_stat = 10; location: 1591 cross_layer: 1 file: iconv.c
err = _php_iconv_appendl ( pretval , csname , ( size_t ) ( ( p1 + 1 ) - csname ) , cd_pl ); location: 1598 cross_layer: 1 file: iconv.c
if ( err != PHP_ICONV_ERR_SUCCESS )  location: 1599 cross_layer: 1 file: iconv.c
csname = NULL; location: 1602 cross_layer: 1 file: iconv.c
if ( mode & PHP_ICONV_MIME_DECODE_STRICT )  location: 1603 cross_layer: 1 file: iconv.c
scan_stat = 12; location: 1604 cross_layer: 1 file: iconv.c
scan_stat = 0; location: 1607 cross_layer: 1 file: iconv.c
if ( scan_stat != 2 )  location: 1611 cross_layer: 1 file: iconv.c
char tmpbuf [ 80 ] ; location: 1612 cross_layer: 1 file: iconv.c
if ( csname == NULL )  location: 1614 cross_layer: 1 file: iconv.c
csname_len = ( size_t ) ( p1 - csname ); location: 1619 cross_layer: 1 file: iconv.c
if ( csname_len > sizeof ( tmpbuf ) - 1 )  location: 1621 cross_layer: 1 file: iconv.c
memcpy ( tmpbuf , csname , csname_len ); location: 1640 cross_layer: 1 file: iconv.c
tmpbuf [ csname_len ] = '\0'; location: 1641 cross_layer: 1 file: iconv.c
cd = iconv_open ( enc , tmpbuf ); location: 1647 cross_layer: 1 file: iconv.c
if ( cd == ( iconv_t ) ( - 1 ) )  location: 1649 cross_layer: 1 file: iconv.c
if ( mode & PHP_ICONV_MIME_DECODE_CONTINUE_ON_ERROR )  location: 1650 cross_layer: 1 file: iconv.c
if ( * ( p1 + 1 ) == '=' )  location: 1674 cross_layer: 1 file: iconv.c
err = _php_iconv_appendl ( pretval , encoded_word , ( size_t ) ( ( p1 + 1 ) - encoded_word ) , cd_pl ); location: 1679 cross_layer: 1 file: iconv.c    (key_var lines)
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 2 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 2 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 2 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 2 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 2 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 2 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 2 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 2 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 2 file: iconv.c
if ( err != PHP_ICONV_ERR_SUCCESS )  location: 1680 cross_layer: 1 file: iconv.c
switch ( * p1 )  location: 1706 cross_layer: 1 file: iconv.c
err = _php_iconv_appendl ( pretval , encoded_word , ( size_t ) ( ( p1 + 1 ) - encoded_word ) , cd_pl ); location: 1721 cross_layer: 1 file: iconv.c
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 2 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 2 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 2 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 2 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 2 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 2 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 2 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 2 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 2 file: iconv.c
if ( err != PHP_ICONV_ERR_SUCCESS )  location: 1722 cross_layer: 1 file: iconv.c
if ( * p1 != '?' )  location: 1740 cross_layer: 1 file: iconv.c
err = _php_iconv_appendl ( pretval , encoded_word , ( size_t ) ( ( p1 + 1 ) - encoded_word ) , cd_pl ); location: 1743 cross_layer: 1 file: iconv.c
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 2 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 2 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 2 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 2 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 2 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 2 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 2 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 2 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 2 file: iconv.c
if ( err != PHP_ICONV_ERR_SUCCESS )  location: 1744 cross_layer: 1 file: iconv.c
encoded_text = p1 + 1; location: 1759 cross_layer: 1 file: iconv.c
if ( * p1 == '?' )  location: 1764 cross_layer: 1 file: iconv.c
encoded_text_len = ( size_t ) ( p1 - encoded_text ); location: 1765 cross_layer: 1 file: iconv.c
if ( * p1 == '\n' )  location: 1771 cross_layer: 1 file: iconv.c
_php_iconv_appendc ( pretval , * p1 , cd_pl ); location: 1776 cross_layer: 1 file: iconv.c
static php_iconv_err_t _php_iconv_appendc(smart_str *d, const char c, iconv_t cd) location: 531 cross_layer: 2 file: iconv.c
return _php_iconv_appendl ( d , & c , 1 , cd ) ; location: 533 cross_layer: 2 file: iconv.c
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 3 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 3 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 3 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 3 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 3 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 3 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 3 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 3 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 3 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 3 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 3 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 3 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 3 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 3 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 3 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 3 file: iconv.c
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 3 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 3 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 3 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 3 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 3 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 3 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 3 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 3 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 3 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 3 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 3 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 3 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 3 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 3 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 3 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 3 file: iconv.c
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 3 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 3 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 3 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 3 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 3 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 3 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 3 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 3 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 3 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 3 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 3 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 3 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 3 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 3 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 3 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 3 file: iconv.c
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 3 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 3 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 3 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 3 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 3 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 3 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 3 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 3 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 3 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 3 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 3 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 3 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 3 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 3 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 3 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 3 file: iconv.c
if ( * p1 != ' ' && * p1 != '\t' )  location: 1783 cross_layer: 1 file: iconv.c
str_left = 1; location: 1785 cross_layer: 1 file: iconv.c
if ( encoded_word == NULL )  location: 1788 cross_layer: 1 file: iconv.c
if ( * p1 != '=' )  location: 1796 cross_layer: 1 file: iconv.c
err = _php_iconv_appendl ( pretval , encoded_word , ( size_t ) ( ( p1 + 1 ) - encoded_word ) , cd_pl ); location: 1799 cross_layer: 1 file: iconv.c
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 2 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 2 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 2 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 2 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 2 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 2 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 2 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 2 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 2 file: iconv.c
if ( err != PHP_ICONV_ERR_SUCCESS )  location: 1800 cross_layer: 1 file: iconv.c
if ( str_left == 1 )  location: 1816 cross_layer: 1 file: iconv.c
switch ( * p1 )  location: 1823 cross_layer: 1 file: iconv.c
err = _php_iconv_appendl ( pretval , encoded_word , ( size_t ) ( ( p1 + 1 ) - encoded_word ) , cd_pl ); location: 1836 cross_layer: 1 file: iconv.c
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 2 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 2 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 2 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 2 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 2 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 2 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 2 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 2 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 2 file: iconv.c
if ( err != PHP_ICONV_ERR_SUCCESS )  location: 1837 cross_layer: 1 file: iconv.c
decoded_text = php_base64_decode ( ( unsigned char * ) encoded_text , encoded_text_len ); location: 1851 cross_layer: 1 file: iconv.c
decoded_text = php_quot_print_decode ( ( unsigned char * ) encoded_text , encoded_text_len , 1 ); location: 1855 cross_layer: 1 file: iconv.c
if ( decoded_text == NULL )  location: 1862 cross_layer: 1 file: iconv.c
err = _php_iconv_appendl ( pretval , encoded_word , ( size_t ) ( ( p1 + 1 ) - encoded_word ) , cd_pl ); location: 1865 cross_layer: 1 file: iconv.c
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 2 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 2 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 2 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 2 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 2 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 2 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 2 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 2 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 2 file: iconv.c
if ( err != PHP_ICONV_ERR_SUCCESS )  location: 1866 cross_layer: 1 file: iconv.c
err = _php_iconv_appendl ( pretval , ZSTR_VAL ( decoded_text ) , ZSTR_LEN ( decoded_text ) , cd ); location: 1882 cross_layer: 1 file: iconv.c
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 2 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 2 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 2 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 2 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 2 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 2 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 2 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 2 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 2 file: iconv.c
zend_string_release ( decoded_text ); location: 1883 cross_layer: 1 file: iconv.c
if ( err != PHP_ICONV_ERR_SUCCESS )  location: 1885 cross_layer: 1 file: iconv.c
err = _php_iconv_appendl ( pretval , encoded_word , ( size_t ) ( p1 - encoded_word ) , cd_pl ); location: 1888 cross_layer: 1 file: iconv.c
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 2 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 2 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 2 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 2 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 2 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 2 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 2 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 2 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 2 file: iconv.c
if ( err != PHP_ICONV_ERR_SUCCESS )  location: 1890 cross_layer: 1 file: iconv.c
switch ( * p1 )  location: 1903 cross_layer: 1 file: iconv.c
spaces = p1; location: 1917 cross_layer: 1 file: iconv.c
_php_iconv_appendc ( pretval , * p1 , cd_pl ); location: 1922 cross_layer: 1 file: iconv.c
static php_iconv_err_t _php_iconv_appendc(smart_str *d, const char c, iconv_t cd) location: 531 cross_layer: 2 file: iconv.c
return _php_iconv_appendl ( d , & c , 1 , cd ) ; location: 533 cross_layer: 2 file: iconv.c
if ( * p1 == '?' )  location: 1931 cross_layer: 1 file: iconv.c
switch ( * p1 )  location: 1937 cross_layer: 1 file: iconv.c
if ( spaces != NULL && encoded_word == NULL )  location: 1947 cross_layer: 1 file: iconv.c
_php_iconv_appendl ( pretval , spaces , ( size_t ) ( p1 - spaces ) , cd_pl ); location: 1948 cross_layer: 1 file: iconv.c
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 2 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 2 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 2 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 2 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 2 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 2 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 2 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 2 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 2 file: iconv.c
encoded_word = p1; location: 1951 cross_layer: 1 file: iconv.c
if ( spaces != NULL )  location: 1959 cross_layer: 1 file: iconv.c
_php_iconv_appendl ( pretval , spaces , ( size_t ) ( p1 - spaces ) , cd_pl ); location: 1960 cross_layer: 1 file: iconv.c
static php_iconv_err_t _php_iconv_appendl(smart_str *d, const char *s, size_t l, iconv_t cd) location: 456 cross_layer: 2 file: iconv.c
const char * in_p = s ; location: 458 cross_layer: 2 file: iconv.c
size_t in_left = l ; location: 459 cross_layer: 2 file: iconv.c
size_t prev_in_left = in_left ; location: 464 cross_layer: 2 file: iconv.c
if ( in_p != NULL )  location: 467 cross_layer: 2 file: iconv.c
while ( in_left > 0 )  location: 468 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 470 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 472 cross_layer: 2 file: iconv.c
if ( iconv ( cd , ( char * * ) & in_p , & in_left , ( char * * ) & out_p , & out_left ) == ( size_t ) - 1 )  location: 474 cross_layer: 2 file: iconv.c
prev_in_left = in_left; location: 496 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 498 cross_layer: 2 file: iconv.c
smart_str_alloc ( d , out_left , 0 ); location: 504 cross_layer: 2 file: iconv.c
out_p = ZSTR_VAL ( ( d ) -> s ) + ZSTR_LEN ( ( d ) -> s ); location: 506 cross_layer: 2 file: iconv.c
if ( iconv ( cd , NULL , NULL , ( char * * ) & out_p , & out_left ) == ( size_t ) 0 )  location: 508 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 509 cross_layer: 2 file: iconv.c
ZSTR_LEN ( ( d ) -> s ) += ( buf_growth - out_left ); location: 522 cross_layer: 2 file: iconv.c
_php_iconv_appendc ( pretval , * p1 , cd_pl ); location: 1963 cross_layer: 1 file: iconv.c
static php_iconv_err_t _php_iconv_appendc(smart_str *d, const char c, iconv_t cd) location: 531 cross_layer: 2 file: iconv.c
return _php_iconv_appendl ( d , & c , 1 , cd ) ; location: 533 cross_layer: 2 file: iconv.c
switch ( * p1 )  location: 1975 cross_layer: 1 file: iconv.c
spaces = p1; location: 1985 cross_layer: 1 file: iconv.c
encoded_word = p1; location: 1991 cross_layer: 1 file: iconv.c
_php_iconv_appendc ( pretval , * p1 , cd_pl ); location: 1998 cross_layer: 1 file: iconv.c
static php_iconv_err_t _php_iconv_appendc(smart_str *d, const char c, iconv_t cd) location: 531 cross_layer: 2 file: iconv.c
return _php_iconv_appendl ( d , & c , 1 , cd ) ; location: 533 cross_layer: 2 file: iconv.c
* next_pos = p1; location: 2020 cross_layer: 1 file: iconv.c
if ( cd != ( iconv_t ) ( - 1 ) )  location: 2025 cross_layer: 1 file: iconv.c
iconv_close ( cd ); location: 2026 cross_layer: 1 file: iconv.c
return err ; location: 2031 cross_layer: 1 file: iconv.c
------------------------------
