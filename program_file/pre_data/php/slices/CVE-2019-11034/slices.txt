1 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2806 @@ ['value_len', 'ImageInfo', 'NumDirEntries'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: 2 + 0x%04X*12 = 0x%04X > 0x%04X" , NumDirEntries , 2 + NumDirEntries * 12 , value_len ) location: 2802 cross_layer: 1 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , data_len , displacement , section_index , 0 , maker_note -> tag_table ) )  location: 2807 cross_layer: 3 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 4 file: exif.c
------------------------------
2 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2806 @@ ['value_len', 'ImageInfo', 'NumDirEntries'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: 2 + 0x%04X*12 = 0x%04X > 0x%04X" , NumDirEntries , 2 + NumDirEntries * 12 , value_len ) location: 2802 cross_layer: 1 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
exif_process_IFD_in_JPEG ( ImageInfo , CharBuf + offset_of_ifd , CharBuf , length , displacement , SECTION_IFD0 ); location: 3255 cross_layer: 4 file: exif.c
------------------------------
3 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2806 @@ ['value_len', 'ImageInfo', 'NumDirEntries'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: 2 + 0x%04X*12 = 0x%04X > 0x%04X" , NumDirEntries , 2 + NumDirEntries * 12 , value_len ) location: 2802 cross_layer: 1 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 4 file: exif.c
------------------------------
4 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2806 @@ ['value_len', 'ImageInfo', 'NumDirEntries'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: 2 + 0x%04X*12 = 0x%04X > 0x%04X" , NumDirEntries , 2 + NumDirEntries * 12 , value_len ) location: 2802 cross_layer: 1 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 4 file: exif.c
------------------------------
5 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2806 @@ ['value_len', 'ImageInfo', 'NumDirEntries'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: 2 + 0x%04X*12 = 0x%04X > 0x%04X" , NumDirEntries , 2 + NumDirEntries * 12 , value_len ) location: 2802 cross_layer: 1 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , ( char * ) dir_entry , ( char * ) ( ImageInfo -> file . list [ sn ] . data - dir_offset ) , ifd_size , 0 , section_index , 0 , tag_table ) )  location: 3750 cross_layer: 3 file: exif.c
exif_process_IFD_in_TIFF ( ImageInfo , entry_offset , sub_section_index ); location: 3722 cross_layer: 4 file: exif.c
------------------------------
6 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2806 @@ ['value_len', 'ImageInfo', 'NumDirEntries'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: 2 + 0x%04X*12 = 0x%04X > 0x%04X" , NumDirEntries , 2 + NumDirEntries * 12 , value_len ) location: 2802 cross_layer: 1 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , ( char * ) dir_entry , ( char * ) ( ImageInfo -> file . list [ sn ] . data - dir_offset ) , ifd_size , 0 , section_index , 0 , tag_table ) )  location: 3750 cross_layer: 3 file: exif.c
exif_process_IFD_in_TIFF ( ImageInfo , next_offset , SECTION_THUMBNAIL ); location: 3765 cross_layer: 4 file: exif.c
------------------------------
7 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2806 @@ ['value_len', 'ImageInfo', 'NumDirEntries'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: 2 + 0x%04X*12 = 0x%04X > 0x%04X" , NumDirEntries , 2 + NumDirEntries * 12 , value_len ) location: 2802 cross_layer: 1 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , ( char * ) dir_entry , ( char * ) ( ImageInfo -> file . list [ sn ] . data - dir_offset ) , ifd_size , 0 , section_index , 0 , tag_table ) )  location: 3750 cross_layer: 3 file: exif.c
if ( exif_process_IFD_in_TIFF ( ImageInfo , php_ifd_get32u ( file_header + 4 , ImageInfo -> motorola_intel ) , SECTION_IFD0 ) )  location: 3847 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 5 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 5 file: exif.c
------------------------------
8 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2806 @@ ['value_len', 'ImageInfo', 'NumDirEntries'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: 2 + 0x%04X*12 = 0x%04X > 0x%04X" , NumDirEntries , 2 + NumDirEntries * 12 , value_len ) location: 2802 cross_layer: 1 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , ( char * ) dir_entry , ( char * ) ( ImageInfo -> file . list [ sn ] . data - dir_offset ) , ifd_size , 0 , section_index , 0 , tag_table ) )  location: 3750 cross_layer: 3 file: exif.c
if ( exif_process_IFD_in_TIFF ( ImageInfo , php_ifd_get32u ( file_header + 4 , ImageInfo -> motorola_intel ) , SECTION_IFD0 ) )  location: 3833 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 5 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 5 file: exif.c
------------------------------
9 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2805 @@ ['dir_start', 'value_ptr'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 2806 cross_layer: 1 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , data_len , displacement , section_index , 0 , maker_note -> tag_table ) )  location: 2807 cross_layer: 1 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 2 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 2 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 2 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
for (i = 0; (t = tag_table[i].Tag) != TAG_END_OF_LIST; i++) location: 999 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 2 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 2 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 2 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 2 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 2 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 2 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 2 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 2 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 2 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 2 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 2 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 2 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 2 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 2 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 2 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 2 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 2 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 2 file: exif.c
char * exif_dump_data(int *dump_free, int format, int components, int length, int motorola_intel, char *value_ptr) /* location: 1151 cross_layer: 3 file: exif.c
* dump_free = 0; location: 1156 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_STRING )  location: 1157 cross_layer: 3 file: exif.c
return value_ptr ? value_ptr : "<no data>" ; location: 1158 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_UNDEFINED )  location: 1160 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_IFD )  location: 1163 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_SINGLE || format == TAG_FMT_DOUBLE )  location: 1166 cross_layer: 3 file: exif.c
* dump_free = 1; location: 1169 cross_layer: 3 file: exif.c
if ( components > 1 )  location: 1170 cross_layer: 3 file: exif.c
len = spprintf ( & dump , 0 , "(%d,%d) {" , components , length ); location: 1171 cross_layer: 3 file: exif.c
while ( components > 0 )  location: 1175 cross_layer: 3 file: exif.c
switch ( format )  location: 1176 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 4 + 1 ); location: 1181 cross_layer: 3 file: exif.c
snprintf ( dump + len , 4 + 1 , "0x%02X" , * value_ptr ); location: 1182 cross_layer: 3 file: exif.c
len += 4; location: 1183 cross_layer: 3 file: exif.c
value_ptr ++; location: 1184 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1188 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get16s ( value_ptr , motorola_intel ) ); location: 1189 cross_layer: 3 file: exif.c
static signed short php_ifd_get16s(void *value, int motorola_intel) location: 1086 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1088 cross_layer: 4 file: exif.c
len += 6; location: 1190 cross_layer: 3 file: exif.c
value_ptr += 2; location: 1191 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1195 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) ); location: 1196 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 6; location: 1197 cross_layer: 3 file: exif.c
value_ptr += 4; location: 1198 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 13 + 1 ); location: 1202 cross_layer: 3 file: exif.c
snprintf ( dump + len , 13 + 1 , "0x%04X/0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) , php_ifd_get32s ( value_ptr + 4 , motorola_intel ) ); location: 1203 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 13; location: 1204 cross_layer: 3 file: exif.c
value_ptr += 8; location: 1205 cross_layer: 3 file: exif.c
if ( components > 0 )  location: 1208 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 2 + 1 ); location: 1209 cross_layer: 3 file: exif.c
snprintf ( dump + len , 2 + 1 , ", " ); location: 1210 cross_layer: 3 file: exif.c
len += 2; location: 1211 cross_layer: 3 file: exif.c
components --; location: 1212 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 1 + 1 ); location: 1217 cross_layer: 3 file: exif.c
snprintf ( dump + len , 1 + 1 , "}" ); location: 1218 cross_layer: 3 file: exif.c
return dump ; location: 1219 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 2 file: exif.c
static char *exif_get_tagformat(int format) location: 323 cross_layer: 3 file: exif.c
switch ( format )  location: 325 cross_layer: 3 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 2 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 2 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 2 file: exif.c
switch ( tag )  location: 2940 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 2 file: exif.c
switch ( tag )  location: 2977 cross_layer: 2 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 2 file: exif.c
static size_t php_strnlen(char* str, size_t maxlen) location: 277 cross_layer: 3 file: exif.c
if ( str && maxlen && * str )  location: 280 cross_layer: 3 file: exif.c
while ( -- maxlen && * ( ++ str ) )  location: 283 cross_layer: 3 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 2 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 2 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 2 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 2 file: exif.c
static int exif_process_user_comment(image_info_type *ImageInfo, char **pszInfoPtr, char **pszEncoding, char *szValuePtr, int ByteCount) location: 2605 cross_layer: 3 file: exif.c
* pszEncoding = NULL; location: 2611 cross_layer: 3 file: exif.c
if ( ByteCount >= 8 )  location: 2613 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "UNICODE\0" , 8 ) )  location: 2615 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2616 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2617 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2618 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFE\xFF" , 2 ) )  location: 2622 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2624 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2625 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFF\xFE" , 2 ) )  location: 2626 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2628 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2629 cross_layer: 3 file: exif.c
if ( ImageInfo -> motorola_intel )  location: 2630 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_be; location: 2631 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_le; location: 2633 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ); location: 2635 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( decode ); location: 2636 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2638 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2645 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2647 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "ASCII\0\0\0" , 8 ) )  location: 2648 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2649 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2650 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2651 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "JIS\0\0\0\0\0" , 8 ) )  location: 2652 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2654 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2655 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2656 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_jis ); location: 2658 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_jis_be : ImageInfo -> decode_jis_le ); location: 2659 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2660 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2667 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2669 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\0\0\0\0\0\0\0\0" , 8 ) )  location: 2670 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( "UNDEFINED" ); location: 2672 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2673 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2674 cross_layer: 3 file: exif.c
if ( ByteCount > 0 )  location: 2679 cross_layer: 3 file: exif.c
for (a=ByteCount-1;a && szValuePtr[a]==' ';a--) location: 2680 cross_layer: 3 file: exif.c
( szValuePtr ) [ a ] = '\0'; location: 2681 cross_layer: 3 file: exif.c
exif_process_string ( pszInfoPtr , szValuePtr , ByteCount ); location: 2686 cross_layer: 3 file: exif.c
static int exif_process_string(char **result, char *value, size_t byte_count) location: 2587 cross_layer: 4 file: exif.c
if ( ( byte_count = php_strnlen ( value , byte_count ) ) > 0 )  location: 2595 cross_layer: 4 file: exif.c
return exif_process_undefined ( result , value , byte_count ) ; location: 2596 cross_layer: 4 file: exif.c
( * result ) = estrndup ( "" , 1 ); location: 2598 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2599 cross_layer: 4 file: exif.c
return strlen ( * pszInfoPtr ) ; location: 2687 cross_layer: 3 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 2 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 2 file: exif.c
static int exif_process_unicode(image_info_type *ImageInfo, xp_field_type *xp_field, int tag, char *szValuePtr, int ByteCount) location: 2693 cross_layer: 3 file: exif.c
xp_field -> tag = tag; location: 2695 cross_layer: 3 file: exif.c
xp_field -> value = NULL; location: 2696 cross_layer: 3 file: exif.c
if ( zend_multibyte_encoding_converter ( ( unsigned char * * ) & xp_field -> value , & xp_field -> size , ( unsigned char * ) szValuePtr , ByteCount , zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ) , zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_unicode_be : ImageInfo -> decode_unicode_le ) ) == ( size_t ) - 1 )  location: 2698 cross_layer: 3 file: exif.c
xp_field -> size = exif_process_string_raw ( & xp_field -> value , szValuePtr , ByteCount ); location: 2706 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return xp_field -> size ; location: 2708 cross_layer: 3 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 2 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 2 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 2 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 2 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 2 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 2 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 2 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 2 file: exif.c
switch ( tag )  location: 3100 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 2 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 2 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 3 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 4 file: exif.c
switch ( section )  location: 1403 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 3 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 3 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 3169 cross_layer: 3 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 4 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 4 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 4 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 4 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 4 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 4 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 4 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 4 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 4 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 4 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 4 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 4 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 4 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 4 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 4 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 4 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 4 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 4 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 4 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 4 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 4 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 4 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 4 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 4 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 4 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 4 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 4 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 4 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 4 file: exif.c
switch ( tag )  location: 2940 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 4 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 4 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 4 file: exif.c
switch ( tag )  location: 2977 cross_layer: 4 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 4 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 4 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 4 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 4 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 4 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 4 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 4 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 4 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 4 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 4 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 4 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 4 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 4 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 4 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 4 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 4 file: exif.c
switch ( tag )  location: 3100 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 4 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 4 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 4 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 3 file: exif.c
switch ( section )  location: 1403 cross_layer: 3 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 4 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
static void exif_iif_add_tag(image_info_type *image_info, int section_index, char *name, int tag, int format, size_t length, void* value) location: 1789 cross_layer: 3 file: exif.c
exif_iif_add_value ( image_info , section_index , name , tag , format , ( int ) length , value , image_info -> motorola_intel ); location: 1791 cross_layer: 3 file: exif.c
static void exif_iif_add_value(image_info_type *image_info, int section_index, char *name, int tag, int format, int length, void* value, int motorola_intel) location: 1657 cross_layer: 4 file: exif.c
if ( length < 0 )  location: 1665 cross_layer: 4 file: exif.c
list = safe_erealloc ( image_info -> info_list [ section_index ] . list , ( image_info -> info_list [ section_index ] . count + 1 ) , sizeof ( image_info_data ) , 0 ); location: 1669 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . list = list; location: 1670 cross_layer: 4 file: exif.c
info_data = & image_info -> info_list [ section_index ] . list [ image_info -> info_list [ section_index ] . count ]; location: 1672 cross_layer: 4 file: exif.c
memset ( info_data , 0 , sizeof ( image_info_data ) ); location: 1673 cross_layer: 4 file: exif.c
info_data -> tag = tag; location: 1674 cross_layer: 4 file: exif.c
info_data -> format = format; location: 1675 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1676 cross_layer: 4 file: exif.c
info_data -> name = estrdup ( name ); location: 1677 cross_layer: 4 file: exif.c
info_value = & info_data -> value; location: 1678 cross_layer: 4 file: exif.c
switch ( format )  location: 1680 cross_layer: 4 file: exif.c
if ( value )  location: 1682 cross_layer: 4 file: exif.c
length = php_strnlen ( value , length ); location: 1683 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1684 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1685 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1687 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1688 cross_layer: 4 file: exif.c
info_data -> tag = TAG_FMT_UNDEFINED; location: 1698 cross_layer: 4 file: exif.c
if ( ! length )  location: 1702 cross_layer: 4 file: exif.c
if ( value )  location: 1705 cross_layer: 4 file: exif.c
if ( tag == TAG_MAKER_NOTE )  location: 1706 cross_layer: 4 file: exif.c
length = ( int ) php_strnlen ( value , length ); location: 1707 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1711 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1712 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1714 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1715 cross_layer: 4 file: exif.c
if ( length == 0 )  location: 1727 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1730 cross_layer: 4 file: exif.c
for (idex=0,vptr=value; idex<(size_t)length; idex++,vptr=(char *) vptr + php_tiff_bytes_per_format[format]) location: 1735 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1736 cross_layer: 4 file: exif.c
info_value = & info_data -> value . list [ idex ]; location: 1737 cross_layer: 4 file: exif.c
switch ( format )  location: 1739 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get16u ( vptr , motorola_intel ); location: 1741 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get32u ( vptr , motorola_intel ); location: 1745 cross_layer: 4 file: exif.c
info_value -> ur . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1749 cross_layer: 4 file: exif.c
info_value -> ur . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1750 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get16s ( vptr , motorola_intel ); location: 1754 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get32s ( vptr , motorola_intel ); location: 1758 cross_layer: 4 file: exif.c
info_value -> sr . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1762 cross_layer: 4 file: exif.c
info_value -> sr . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1763 cross_layer: 4 file: exif.c
info_value -> f = * ( float * ) value; location: 1770 cross_layer: 4 file: exif.c
info_value -> d = * ( double * ) value; location: 1776 cross_layer: 4 file: exif.c
image_info -> sections_found |= 1 << section_index; location: 1781 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . count ++; location: 1782 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 3 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 3 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 3 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 3 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 4 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 4 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 4 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 4 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 4 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 4 file: exif.c
static void exif_thumbnail_extract(image_info_type *ImageInfo, char *offset, size_t length) location: 2522 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . data )  location: 2523 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_mult_thumb" EXIFERR_CC , ImageInfo , E_WARNING , "Multiple possible thumbnails" ) location: 2524 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> read_thumbnail )  location: 2527 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size >= 65536 || ImageInfo -> Thumbnail . size <= 0 || ImageInfo -> Thumbnail . offset <= 0 )  location: 2531 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Illegal thumbnail size/offset" ) location: 2535 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size > length || ( ImageInfo -> Thumbnail . offset + ImageInfo -> Thumbnail . size ) > length || ImageInfo -> Thumbnail . offset > length - ImageInfo -> Thumbnail . size )  location: 2539 cross_layer: 4 file: exif.c
EXIF_ERRLOG_THUMBEOF ( ImageInfo ) location: 2543 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . data = estrndup ( offset + ImageInfo -> Thumbnail . offset , ImageInfo -> Thumbnail . size ); location: 2546 cross_layer: 4 file: exif.c
exif_thumbnail_build ( ImageInfo ); location: 2547 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 3 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 2 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 2 file: exif.c
ImageInfo -> motorola_intel = old_motorola_intel; location: 2812 cross_layer: 1 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( SECTION_MAKERNOTE ) ) location: 2815 cross_layer: 1 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 2 file: exif.c
switch ( section )  location: 1403 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , data_len , displacement , section_index , 0 , maker_note -> tag_table ) )  location: 2807 cross_layer: 3 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 4 file: exif.c
------------------------------
10 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2805 @@ ['dir_start', 'value_ptr'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 2806 cross_layer: 1 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , data_len , displacement , section_index , 0 , maker_note -> tag_table ) )  location: 2807 cross_layer: 1 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 2 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 2 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 2 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
for (i = 0; (t = tag_table[i].Tag) != TAG_END_OF_LIST; i++) location: 999 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 2 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 2 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 2 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 2 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 2 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 2 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 2 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 2 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 2 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 2 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 2 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 2 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 2 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 2 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 2 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 2 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 2 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 2 file: exif.c
char * exif_dump_data(int *dump_free, int format, int components, int length, int motorola_intel, char *value_ptr) /* location: 1151 cross_layer: 3 file: exif.c
* dump_free = 0; location: 1156 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_STRING )  location: 1157 cross_layer: 3 file: exif.c
return value_ptr ? value_ptr : "<no data>" ; location: 1158 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_UNDEFINED )  location: 1160 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_IFD )  location: 1163 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_SINGLE || format == TAG_FMT_DOUBLE )  location: 1166 cross_layer: 3 file: exif.c
* dump_free = 1; location: 1169 cross_layer: 3 file: exif.c
if ( components > 1 )  location: 1170 cross_layer: 3 file: exif.c
len = spprintf ( & dump , 0 , "(%d,%d) {" , components , length ); location: 1171 cross_layer: 3 file: exif.c
while ( components > 0 )  location: 1175 cross_layer: 3 file: exif.c
switch ( format )  location: 1176 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 4 + 1 ); location: 1181 cross_layer: 3 file: exif.c
snprintf ( dump + len , 4 + 1 , "0x%02X" , * value_ptr ); location: 1182 cross_layer: 3 file: exif.c
len += 4; location: 1183 cross_layer: 3 file: exif.c
value_ptr ++; location: 1184 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1188 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get16s ( value_ptr , motorola_intel ) ); location: 1189 cross_layer: 3 file: exif.c
static signed short php_ifd_get16s(void *value, int motorola_intel) location: 1086 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1088 cross_layer: 4 file: exif.c
len += 6; location: 1190 cross_layer: 3 file: exif.c
value_ptr += 2; location: 1191 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1195 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) ); location: 1196 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 6; location: 1197 cross_layer: 3 file: exif.c
value_ptr += 4; location: 1198 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 13 + 1 ); location: 1202 cross_layer: 3 file: exif.c
snprintf ( dump + len , 13 + 1 , "0x%04X/0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) , php_ifd_get32s ( value_ptr + 4 , motorola_intel ) ); location: 1203 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 13; location: 1204 cross_layer: 3 file: exif.c
value_ptr += 8; location: 1205 cross_layer: 3 file: exif.c
if ( components > 0 )  location: 1208 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 2 + 1 ); location: 1209 cross_layer: 3 file: exif.c
snprintf ( dump + len , 2 + 1 , ", " ); location: 1210 cross_layer: 3 file: exif.c
len += 2; location: 1211 cross_layer: 3 file: exif.c
components --; location: 1212 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 1 + 1 ); location: 1217 cross_layer: 3 file: exif.c
snprintf ( dump + len , 1 + 1 , "}" ); location: 1218 cross_layer: 3 file: exif.c
return dump ; location: 1219 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 2 file: exif.c
static char *exif_get_tagformat(int format) location: 323 cross_layer: 3 file: exif.c
switch ( format )  location: 325 cross_layer: 3 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 2 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 2 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 2 file: exif.c
switch ( tag )  location: 2940 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 2 file: exif.c
switch ( tag )  location: 2977 cross_layer: 2 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 2 file: exif.c
static size_t php_strnlen(char* str, size_t maxlen) location: 277 cross_layer: 3 file: exif.c
if ( str && maxlen && * str )  location: 280 cross_layer: 3 file: exif.c
while ( -- maxlen && * ( ++ str ) )  location: 283 cross_layer: 3 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 2 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 2 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 2 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 2 file: exif.c
static int exif_process_user_comment(image_info_type *ImageInfo, char **pszInfoPtr, char **pszEncoding, char *szValuePtr, int ByteCount) location: 2605 cross_layer: 3 file: exif.c
* pszEncoding = NULL; location: 2611 cross_layer: 3 file: exif.c
if ( ByteCount >= 8 )  location: 2613 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "UNICODE\0" , 8 ) )  location: 2615 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2616 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2617 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2618 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFE\xFF" , 2 ) )  location: 2622 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2624 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2625 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFF\xFE" , 2 ) )  location: 2626 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2628 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2629 cross_layer: 3 file: exif.c
if ( ImageInfo -> motorola_intel )  location: 2630 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_be; location: 2631 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_le; location: 2633 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ); location: 2635 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( decode ); location: 2636 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2638 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2645 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2647 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "ASCII\0\0\0" , 8 ) )  location: 2648 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2649 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2650 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2651 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "JIS\0\0\0\0\0" , 8 ) )  location: 2652 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2654 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2655 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2656 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_jis ); location: 2658 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_jis_be : ImageInfo -> decode_jis_le ); location: 2659 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2660 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2667 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2669 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\0\0\0\0\0\0\0\0" , 8 ) )  location: 2670 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( "UNDEFINED" ); location: 2672 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2673 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2674 cross_layer: 3 file: exif.c
if ( ByteCount > 0 )  location: 2679 cross_layer: 3 file: exif.c
for (a=ByteCount-1;a && szValuePtr[a]==' ';a--) location: 2680 cross_layer: 3 file: exif.c
( szValuePtr ) [ a ] = '\0'; location: 2681 cross_layer: 3 file: exif.c
exif_process_string ( pszInfoPtr , szValuePtr , ByteCount ); location: 2686 cross_layer: 3 file: exif.c
static int exif_process_string(char **result, char *value, size_t byte_count) location: 2587 cross_layer: 4 file: exif.c
if ( ( byte_count = php_strnlen ( value , byte_count ) ) > 0 )  location: 2595 cross_layer: 4 file: exif.c
return exif_process_undefined ( result , value , byte_count ) ; location: 2596 cross_layer: 4 file: exif.c
( * result ) = estrndup ( "" , 1 ); location: 2598 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2599 cross_layer: 4 file: exif.c
return strlen ( * pszInfoPtr ) ; location: 2687 cross_layer: 3 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 2 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 2 file: exif.c
static int exif_process_unicode(image_info_type *ImageInfo, xp_field_type *xp_field, int tag, char *szValuePtr, int ByteCount) location: 2693 cross_layer: 3 file: exif.c
xp_field -> tag = tag; location: 2695 cross_layer: 3 file: exif.c
xp_field -> value = NULL; location: 2696 cross_layer: 3 file: exif.c
if ( zend_multibyte_encoding_converter ( ( unsigned char * * ) & xp_field -> value , & xp_field -> size , ( unsigned char * ) szValuePtr , ByteCount , zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ) , zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_unicode_be : ImageInfo -> decode_unicode_le ) ) == ( size_t ) - 1 )  location: 2698 cross_layer: 3 file: exif.c
xp_field -> size = exif_process_string_raw ( & xp_field -> value , szValuePtr , ByteCount ); location: 2706 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return xp_field -> size ; location: 2708 cross_layer: 3 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 2 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 2 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 2 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 2 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 2 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 2 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 2 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 2 file: exif.c
switch ( tag )  location: 3100 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 2 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 2 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 3 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 4 file: exif.c
switch ( section )  location: 1403 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 3 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 3 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 3169 cross_layer: 3 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 4 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 4 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 4 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 4 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 4 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 4 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 4 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 4 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 4 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 4 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 4 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 4 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 4 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 4 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 4 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 4 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 4 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 4 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 4 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 4 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 4 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 4 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 4 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 4 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 4 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 4 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 4 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 4 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 4 file: exif.c
switch ( tag )  location: 2940 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 4 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 4 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 4 file: exif.c
switch ( tag )  location: 2977 cross_layer: 4 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 4 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 4 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 4 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 4 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 4 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 4 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 4 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 4 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 4 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 4 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 4 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 4 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 4 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 4 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 4 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 4 file: exif.c
switch ( tag )  location: 3100 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 4 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 4 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 4 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 3 file: exif.c
switch ( section )  location: 1403 cross_layer: 3 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 4 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
static void exif_iif_add_tag(image_info_type *image_info, int section_index, char *name, int tag, int format, size_t length, void* value) location: 1789 cross_layer: 3 file: exif.c
exif_iif_add_value ( image_info , section_index , name , tag , format , ( int ) length , value , image_info -> motorola_intel ); location: 1791 cross_layer: 3 file: exif.c
static void exif_iif_add_value(image_info_type *image_info, int section_index, char *name, int tag, int format, int length, void* value, int motorola_intel) location: 1657 cross_layer: 4 file: exif.c
if ( length < 0 )  location: 1665 cross_layer: 4 file: exif.c
list = safe_erealloc ( image_info -> info_list [ section_index ] . list , ( image_info -> info_list [ section_index ] . count + 1 ) , sizeof ( image_info_data ) , 0 ); location: 1669 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . list = list; location: 1670 cross_layer: 4 file: exif.c
info_data = & image_info -> info_list [ section_index ] . list [ image_info -> info_list [ section_index ] . count ]; location: 1672 cross_layer: 4 file: exif.c
memset ( info_data , 0 , sizeof ( image_info_data ) ); location: 1673 cross_layer: 4 file: exif.c
info_data -> tag = tag; location: 1674 cross_layer: 4 file: exif.c
info_data -> format = format; location: 1675 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1676 cross_layer: 4 file: exif.c
info_data -> name = estrdup ( name ); location: 1677 cross_layer: 4 file: exif.c
info_value = & info_data -> value; location: 1678 cross_layer: 4 file: exif.c
switch ( format )  location: 1680 cross_layer: 4 file: exif.c
if ( value )  location: 1682 cross_layer: 4 file: exif.c
length = php_strnlen ( value , length ); location: 1683 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1684 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1685 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1687 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1688 cross_layer: 4 file: exif.c
info_data -> tag = TAG_FMT_UNDEFINED; location: 1698 cross_layer: 4 file: exif.c
if ( ! length )  location: 1702 cross_layer: 4 file: exif.c
if ( value )  location: 1705 cross_layer: 4 file: exif.c
if ( tag == TAG_MAKER_NOTE )  location: 1706 cross_layer: 4 file: exif.c
length = ( int ) php_strnlen ( value , length ); location: 1707 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1711 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1712 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1714 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1715 cross_layer: 4 file: exif.c
if ( length == 0 )  location: 1727 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1730 cross_layer: 4 file: exif.c
for (idex=0,vptr=value; idex<(size_t)length; idex++,vptr=(char *) vptr + php_tiff_bytes_per_format[format]) location: 1735 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1736 cross_layer: 4 file: exif.c
info_value = & info_data -> value . list [ idex ]; location: 1737 cross_layer: 4 file: exif.c
switch ( format )  location: 1739 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get16u ( vptr , motorola_intel ); location: 1741 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get32u ( vptr , motorola_intel ); location: 1745 cross_layer: 4 file: exif.c
info_value -> ur . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1749 cross_layer: 4 file: exif.c
info_value -> ur . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1750 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get16s ( vptr , motorola_intel ); location: 1754 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get32s ( vptr , motorola_intel ); location: 1758 cross_layer: 4 file: exif.c
info_value -> sr . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1762 cross_layer: 4 file: exif.c
info_value -> sr . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1763 cross_layer: 4 file: exif.c
info_value -> f = * ( float * ) value; location: 1770 cross_layer: 4 file: exif.c
info_value -> d = * ( double * ) value; location: 1776 cross_layer: 4 file: exif.c
image_info -> sections_found |= 1 << section_index; location: 1781 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . count ++; location: 1782 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 3 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 3 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 3 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 3 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 4 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 4 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 4 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 4 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 4 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 4 file: exif.c
static void exif_thumbnail_extract(image_info_type *ImageInfo, char *offset, size_t length) location: 2522 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . data )  location: 2523 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_mult_thumb" EXIFERR_CC , ImageInfo , E_WARNING , "Multiple possible thumbnails" ) location: 2524 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> read_thumbnail )  location: 2527 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size >= 65536 || ImageInfo -> Thumbnail . size <= 0 || ImageInfo -> Thumbnail . offset <= 0 )  location: 2531 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Illegal thumbnail size/offset" ) location: 2535 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size > length || ( ImageInfo -> Thumbnail . offset + ImageInfo -> Thumbnail . size ) > length || ImageInfo -> Thumbnail . offset > length - ImageInfo -> Thumbnail . size )  location: 2539 cross_layer: 4 file: exif.c
EXIF_ERRLOG_THUMBEOF ( ImageInfo ) location: 2543 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . data = estrndup ( offset + ImageInfo -> Thumbnail . offset , ImageInfo -> Thumbnail . size ); location: 2546 cross_layer: 4 file: exif.c
exif_thumbnail_build ( ImageInfo ); location: 2547 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 3 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 2 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 2 file: exif.c
ImageInfo -> motorola_intel = old_motorola_intel; location: 2812 cross_layer: 1 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( SECTION_MAKERNOTE ) ) location: 2815 cross_layer: 1 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 2 file: exif.c
switch ( section )  location: 1403 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
exif_process_IFD_in_JPEG ( ImageInfo , CharBuf + offset_of_ifd , CharBuf , length , displacement , SECTION_IFD0 ); location: 3255 cross_layer: 4 file: exif.c
------------------------------
11 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2805 @@ ['dir_start', 'value_ptr'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 2806 cross_layer: 1 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , data_len , displacement , section_index , 0 , maker_note -> tag_table ) )  location: 2807 cross_layer: 1 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 2 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 2 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 2 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
for (i = 0; (t = tag_table[i].Tag) != TAG_END_OF_LIST; i++) location: 999 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 2 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 2 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 2 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 2 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 2 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 2 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 2 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 2 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 2 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 2 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 2 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 2 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 2 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 2 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 2 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 2 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 2 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 2 file: exif.c
char * exif_dump_data(int *dump_free, int format, int components, int length, int motorola_intel, char *value_ptr) /* location: 1151 cross_layer: 3 file: exif.c
* dump_free = 0; location: 1156 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_STRING )  location: 1157 cross_layer: 3 file: exif.c
return value_ptr ? value_ptr : "<no data>" ; location: 1158 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_UNDEFINED )  location: 1160 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_IFD )  location: 1163 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_SINGLE || format == TAG_FMT_DOUBLE )  location: 1166 cross_layer: 3 file: exif.c
* dump_free = 1; location: 1169 cross_layer: 3 file: exif.c
if ( components > 1 )  location: 1170 cross_layer: 3 file: exif.c
len = spprintf ( & dump , 0 , "(%d,%d) {" , components , length ); location: 1171 cross_layer: 3 file: exif.c
while ( components > 0 )  location: 1175 cross_layer: 3 file: exif.c
switch ( format )  location: 1176 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 4 + 1 ); location: 1181 cross_layer: 3 file: exif.c
snprintf ( dump + len , 4 + 1 , "0x%02X" , * value_ptr ); location: 1182 cross_layer: 3 file: exif.c
len += 4; location: 1183 cross_layer: 3 file: exif.c
value_ptr ++; location: 1184 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1188 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get16s ( value_ptr , motorola_intel ) ); location: 1189 cross_layer: 3 file: exif.c
static signed short php_ifd_get16s(void *value, int motorola_intel) location: 1086 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1088 cross_layer: 4 file: exif.c
len += 6; location: 1190 cross_layer: 3 file: exif.c
value_ptr += 2; location: 1191 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1195 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) ); location: 1196 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 6; location: 1197 cross_layer: 3 file: exif.c
value_ptr += 4; location: 1198 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 13 + 1 ); location: 1202 cross_layer: 3 file: exif.c
snprintf ( dump + len , 13 + 1 , "0x%04X/0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) , php_ifd_get32s ( value_ptr + 4 , motorola_intel ) ); location: 1203 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 13; location: 1204 cross_layer: 3 file: exif.c
value_ptr += 8; location: 1205 cross_layer: 3 file: exif.c
if ( components > 0 )  location: 1208 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 2 + 1 ); location: 1209 cross_layer: 3 file: exif.c
snprintf ( dump + len , 2 + 1 , ", " ); location: 1210 cross_layer: 3 file: exif.c
len += 2; location: 1211 cross_layer: 3 file: exif.c
components --; location: 1212 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 1 + 1 ); location: 1217 cross_layer: 3 file: exif.c
snprintf ( dump + len , 1 + 1 , "}" ); location: 1218 cross_layer: 3 file: exif.c
return dump ; location: 1219 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 2 file: exif.c
static char *exif_get_tagformat(int format) location: 323 cross_layer: 3 file: exif.c
switch ( format )  location: 325 cross_layer: 3 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 2 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 2 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 2 file: exif.c
switch ( tag )  location: 2940 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 2 file: exif.c
switch ( tag )  location: 2977 cross_layer: 2 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 2 file: exif.c
static size_t php_strnlen(char* str, size_t maxlen) location: 277 cross_layer: 3 file: exif.c
if ( str && maxlen && * str )  location: 280 cross_layer: 3 file: exif.c
while ( -- maxlen && * ( ++ str ) )  location: 283 cross_layer: 3 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 2 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 2 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 2 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 2 file: exif.c
static int exif_process_user_comment(image_info_type *ImageInfo, char **pszInfoPtr, char **pszEncoding, char *szValuePtr, int ByteCount) location: 2605 cross_layer: 3 file: exif.c
* pszEncoding = NULL; location: 2611 cross_layer: 3 file: exif.c
if ( ByteCount >= 8 )  location: 2613 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "UNICODE\0" , 8 ) )  location: 2615 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2616 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2617 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2618 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFE\xFF" , 2 ) )  location: 2622 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2624 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2625 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFF\xFE" , 2 ) )  location: 2626 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2628 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2629 cross_layer: 3 file: exif.c
if ( ImageInfo -> motorola_intel )  location: 2630 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_be; location: 2631 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_le; location: 2633 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ); location: 2635 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( decode ); location: 2636 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2638 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2645 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2647 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "ASCII\0\0\0" , 8 ) )  location: 2648 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2649 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2650 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2651 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "JIS\0\0\0\0\0" , 8 ) )  location: 2652 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2654 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2655 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2656 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_jis ); location: 2658 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_jis_be : ImageInfo -> decode_jis_le ); location: 2659 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2660 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2667 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2669 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\0\0\0\0\0\0\0\0" , 8 ) )  location: 2670 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( "UNDEFINED" ); location: 2672 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2673 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2674 cross_layer: 3 file: exif.c
if ( ByteCount > 0 )  location: 2679 cross_layer: 3 file: exif.c
for (a=ByteCount-1;a && szValuePtr[a]==' ';a--) location: 2680 cross_layer: 3 file: exif.c
( szValuePtr ) [ a ] = '\0'; location: 2681 cross_layer: 3 file: exif.c
exif_process_string ( pszInfoPtr , szValuePtr , ByteCount ); location: 2686 cross_layer: 3 file: exif.c
static int exif_process_string(char **result, char *value, size_t byte_count) location: 2587 cross_layer: 4 file: exif.c
if ( ( byte_count = php_strnlen ( value , byte_count ) ) > 0 )  location: 2595 cross_layer: 4 file: exif.c
return exif_process_undefined ( result , value , byte_count ) ; location: 2596 cross_layer: 4 file: exif.c
( * result ) = estrndup ( "" , 1 ); location: 2598 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2599 cross_layer: 4 file: exif.c
return strlen ( * pszInfoPtr ) ; location: 2687 cross_layer: 3 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 2 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 2 file: exif.c
static int exif_process_unicode(image_info_type *ImageInfo, xp_field_type *xp_field, int tag, char *szValuePtr, int ByteCount) location: 2693 cross_layer: 3 file: exif.c
xp_field -> tag = tag; location: 2695 cross_layer: 3 file: exif.c
xp_field -> value = NULL; location: 2696 cross_layer: 3 file: exif.c
if ( zend_multibyte_encoding_converter ( ( unsigned char * * ) & xp_field -> value , & xp_field -> size , ( unsigned char * ) szValuePtr , ByteCount , zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ) , zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_unicode_be : ImageInfo -> decode_unicode_le ) ) == ( size_t ) - 1 )  location: 2698 cross_layer: 3 file: exif.c
xp_field -> size = exif_process_string_raw ( & xp_field -> value , szValuePtr , ByteCount ); location: 2706 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return xp_field -> size ; location: 2708 cross_layer: 3 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 2 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 2 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 2 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 2 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 2 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 2 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 2 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 2 file: exif.c
switch ( tag )  location: 3100 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 2 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 2 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 3 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 4 file: exif.c
switch ( section )  location: 1403 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 3 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 3 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 3169 cross_layer: 3 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 4 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 4 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 4 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 4 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 4 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 4 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 4 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 4 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 4 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 4 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 4 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 4 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 4 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 4 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 4 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 4 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 4 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 4 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 4 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 4 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 4 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 4 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 4 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 4 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 4 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 4 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 4 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 4 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 4 file: exif.c
switch ( tag )  location: 2940 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 4 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 4 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 4 file: exif.c
switch ( tag )  location: 2977 cross_layer: 4 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 4 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 4 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 4 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 4 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 4 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 4 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 4 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 4 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 4 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 4 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 4 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 4 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 4 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 4 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 4 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 4 file: exif.c
switch ( tag )  location: 3100 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 4 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 4 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 4 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 3 file: exif.c
switch ( section )  location: 1403 cross_layer: 3 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 4 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
static void exif_iif_add_tag(image_info_type *image_info, int section_index, char *name, int tag, int format, size_t length, void* value) location: 1789 cross_layer: 3 file: exif.c
exif_iif_add_value ( image_info , section_index , name , tag , format , ( int ) length , value , image_info -> motorola_intel ); location: 1791 cross_layer: 3 file: exif.c
static void exif_iif_add_value(image_info_type *image_info, int section_index, char *name, int tag, int format, int length, void* value, int motorola_intel) location: 1657 cross_layer: 4 file: exif.c
if ( length < 0 )  location: 1665 cross_layer: 4 file: exif.c
list = safe_erealloc ( image_info -> info_list [ section_index ] . list , ( image_info -> info_list [ section_index ] . count + 1 ) , sizeof ( image_info_data ) , 0 ); location: 1669 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . list = list; location: 1670 cross_layer: 4 file: exif.c
info_data = & image_info -> info_list [ section_index ] . list [ image_info -> info_list [ section_index ] . count ]; location: 1672 cross_layer: 4 file: exif.c
memset ( info_data , 0 , sizeof ( image_info_data ) ); location: 1673 cross_layer: 4 file: exif.c
info_data -> tag = tag; location: 1674 cross_layer: 4 file: exif.c
info_data -> format = format; location: 1675 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1676 cross_layer: 4 file: exif.c
info_data -> name = estrdup ( name ); location: 1677 cross_layer: 4 file: exif.c
info_value = & info_data -> value; location: 1678 cross_layer: 4 file: exif.c
switch ( format )  location: 1680 cross_layer: 4 file: exif.c
if ( value )  location: 1682 cross_layer: 4 file: exif.c
length = php_strnlen ( value , length ); location: 1683 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1684 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1685 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1687 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1688 cross_layer: 4 file: exif.c
info_data -> tag = TAG_FMT_UNDEFINED; location: 1698 cross_layer: 4 file: exif.c
if ( ! length )  location: 1702 cross_layer: 4 file: exif.c
if ( value )  location: 1705 cross_layer: 4 file: exif.c
if ( tag == TAG_MAKER_NOTE )  location: 1706 cross_layer: 4 file: exif.c
length = ( int ) php_strnlen ( value , length ); location: 1707 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1711 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1712 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1714 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1715 cross_layer: 4 file: exif.c
if ( length == 0 )  location: 1727 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1730 cross_layer: 4 file: exif.c
for (idex=0,vptr=value; idex<(size_t)length; idex++,vptr=(char *) vptr + php_tiff_bytes_per_format[format]) location: 1735 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1736 cross_layer: 4 file: exif.c
info_value = & info_data -> value . list [ idex ]; location: 1737 cross_layer: 4 file: exif.c
switch ( format )  location: 1739 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get16u ( vptr , motorola_intel ); location: 1741 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get32u ( vptr , motorola_intel ); location: 1745 cross_layer: 4 file: exif.c
info_value -> ur . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1749 cross_layer: 4 file: exif.c
info_value -> ur . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1750 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get16s ( vptr , motorola_intel ); location: 1754 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get32s ( vptr , motorola_intel ); location: 1758 cross_layer: 4 file: exif.c
info_value -> sr . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1762 cross_layer: 4 file: exif.c
info_value -> sr . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1763 cross_layer: 4 file: exif.c
info_value -> f = * ( float * ) value; location: 1770 cross_layer: 4 file: exif.c
info_value -> d = * ( double * ) value; location: 1776 cross_layer: 4 file: exif.c
image_info -> sections_found |= 1 << section_index; location: 1781 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . count ++; location: 1782 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 3 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 3 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 3 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 3 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 4 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 4 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 4 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 4 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 4 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 4 file: exif.c
static void exif_thumbnail_extract(image_info_type *ImageInfo, char *offset, size_t length) location: 2522 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . data )  location: 2523 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_mult_thumb" EXIFERR_CC , ImageInfo , E_WARNING , "Multiple possible thumbnails" ) location: 2524 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> read_thumbnail )  location: 2527 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size >= 65536 || ImageInfo -> Thumbnail . size <= 0 || ImageInfo -> Thumbnail . offset <= 0 )  location: 2531 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Illegal thumbnail size/offset" ) location: 2535 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size > length || ( ImageInfo -> Thumbnail . offset + ImageInfo -> Thumbnail . size ) > length || ImageInfo -> Thumbnail . offset > length - ImageInfo -> Thumbnail . size )  location: 2539 cross_layer: 4 file: exif.c
EXIF_ERRLOG_THUMBEOF ( ImageInfo ) location: 2543 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . data = estrndup ( offset + ImageInfo -> Thumbnail . offset , ImageInfo -> Thumbnail . size ); location: 2546 cross_layer: 4 file: exif.c
exif_thumbnail_build ( ImageInfo ); location: 2547 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 3 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 2 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 2 file: exif.c
ImageInfo -> motorola_intel = old_motorola_intel; location: 2812 cross_layer: 1 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( SECTION_MAKERNOTE ) ) location: 2815 cross_layer: 1 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 2 file: exif.c
switch ( section )  location: 1403 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 4 file: exif.c
------------------------------
12 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2805 @@ ['dir_start', 'value_ptr'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 2806 cross_layer: 1 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , data_len , displacement , section_index , 0 , maker_note -> tag_table ) )  location: 2807 cross_layer: 1 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 2 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 2 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 2 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
for (i = 0; (t = tag_table[i].Tag) != TAG_END_OF_LIST; i++) location: 999 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 2 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 2 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 2 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 2 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 2 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 2 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 2 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 2 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 2 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 2 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 2 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 2 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 2 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 2 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 2 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 2 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 2 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 2 file: exif.c
char * exif_dump_data(int *dump_free, int format, int components, int length, int motorola_intel, char *value_ptr) /* location: 1151 cross_layer: 3 file: exif.c
* dump_free = 0; location: 1156 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_STRING )  location: 1157 cross_layer: 3 file: exif.c
return value_ptr ? value_ptr : "<no data>" ; location: 1158 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_UNDEFINED )  location: 1160 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_IFD )  location: 1163 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_SINGLE || format == TAG_FMT_DOUBLE )  location: 1166 cross_layer: 3 file: exif.c
* dump_free = 1; location: 1169 cross_layer: 3 file: exif.c
if ( components > 1 )  location: 1170 cross_layer: 3 file: exif.c
len = spprintf ( & dump , 0 , "(%d,%d) {" , components , length ); location: 1171 cross_layer: 3 file: exif.c
while ( components > 0 )  location: 1175 cross_layer: 3 file: exif.c
switch ( format )  location: 1176 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 4 + 1 ); location: 1181 cross_layer: 3 file: exif.c
snprintf ( dump + len , 4 + 1 , "0x%02X" , * value_ptr ); location: 1182 cross_layer: 3 file: exif.c
len += 4; location: 1183 cross_layer: 3 file: exif.c
value_ptr ++; location: 1184 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1188 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get16s ( value_ptr , motorola_intel ) ); location: 1189 cross_layer: 3 file: exif.c
static signed short php_ifd_get16s(void *value, int motorola_intel) location: 1086 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1088 cross_layer: 4 file: exif.c
len += 6; location: 1190 cross_layer: 3 file: exif.c
value_ptr += 2; location: 1191 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1195 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) ); location: 1196 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 6; location: 1197 cross_layer: 3 file: exif.c
value_ptr += 4; location: 1198 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 13 + 1 ); location: 1202 cross_layer: 3 file: exif.c
snprintf ( dump + len , 13 + 1 , "0x%04X/0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) , php_ifd_get32s ( value_ptr + 4 , motorola_intel ) ); location: 1203 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 13; location: 1204 cross_layer: 3 file: exif.c
value_ptr += 8; location: 1205 cross_layer: 3 file: exif.c
if ( components > 0 )  location: 1208 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 2 + 1 ); location: 1209 cross_layer: 3 file: exif.c
snprintf ( dump + len , 2 + 1 , ", " ); location: 1210 cross_layer: 3 file: exif.c
len += 2; location: 1211 cross_layer: 3 file: exif.c
components --; location: 1212 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 1 + 1 ); location: 1217 cross_layer: 3 file: exif.c
snprintf ( dump + len , 1 + 1 , "}" ); location: 1218 cross_layer: 3 file: exif.c
return dump ; location: 1219 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 2 file: exif.c
static char *exif_get_tagformat(int format) location: 323 cross_layer: 3 file: exif.c
switch ( format )  location: 325 cross_layer: 3 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 2 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 2 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 2 file: exif.c
switch ( tag )  location: 2940 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 2 file: exif.c
switch ( tag )  location: 2977 cross_layer: 2 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 2 file: exif.c
static size_t php_strnlen(char* str, size_t maxlen) location: 277 cross_layer: 3 file: exif.c
if ( str && maxlen && * str )  location: 280 cross_layer: 3 file: exif.c
while ( -- maxlen && * ( ++ str ) )  location: 283 cross_layer: 3 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 2 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 2 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 2 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 2 file: exif.c
static int exif_process_user_comment(image_info_type *ImageInfo, char **pszInfoPtr, char **pszEncoding, char *szValuePtr, int ByteCount) location: 2605 cross_layer: 3 file: exif.c
* pszEncoding = NULL; location: 2611 cross_layer: 3 file: exif.c
if ( ByteCount >= 8 )  location: 2613 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "UNICODE\0" , 8 ) )  location: 2615 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2616 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2617 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2618 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFE\xFF" , 2 ) )  location: 2622 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2624 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2625 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFF\xFE" , 2 ) )  location: 2626 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2628 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2629 cross_layer: 3 file: exif.c
if ( ImageInfo -> motorola_intel )  location: 2630 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_be; location: 2631 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_le; location: 2633 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ); location: 2635 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( decode ); location: 2636 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2638 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2645 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2647 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "ASCII\0\0\0" , 8 ) )  location: 2648 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2649 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2650 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2651 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "JIS\0\0\0\0\0" , 8 ) )  location: 2652 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2654 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2655 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2656 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_jis ); location: 2658 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_jis_be : ImageInfo -> decode_jis_le ); location: 2659 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2660 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2667 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2669 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\0\0\0\0\0\0\0\0" , 8 ) )  location: 2670 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( "UNDEFINED" ); location: 2672 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2673 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2674 cross_layer: 3 file: exif.c
if ( ByteCount > 0 )  location: 2679 cross_layer: 3 file: exif.c
for (a=ByteCount-1;a && szValuePtr[a]==' ';a--) location: 2680 cross_layer: 3 file: exif.c
( szValuePtr ) [ a ] = '\0'; location: 2681 cross_layer: 3 file: exif.c
exif_process_string ( pszInfoPtr , szValuePtr , ByteCount ); location: 2686 cross_layer: 3 file: exif.c
static int exif_process_string(char **result, char *value, size_t byte_count) location: 2587 cross_layer: 4 file: exif.c
if ( ( byte_count = php_strnlen ( value , byte_count ) ) > 0 )  location: 2595 cross_layer: 4 file: exif.c
return exif_process_undefined ( result , value , byte_count ) ; location: 2596 cross_layer: 4 file: exif.c
( * result ) = estrndup ( "" , 1 ); location: 2598 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2599 cross_layer: 4 file: exif.c
return strlen ( * pszInfoPtr ) ; location: 2687 cross_layer: 3 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 2 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 2 file: exif.c
static int exif_process_unicode(image_info_type *ImageInfo, xp_field_type *xp_field, int tag, char *szValuePtr, int ByteCount) location: 2693 cross_layer: 3 file: exif.c
xp_field -> tag = tag; location: 2695 cross_layer: 3 file: exif.c
xp_field -> value = NULL; location: 2696 cross_layer: 3 file: exif.c
if ( zend_multibyte_encoding_converter ( ( unsigned char * * ) & xp_field -> value , & xp_field -> size , ( unsigned char * ) szValuePtr , ByteCount , zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ) , zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_unicode_be : ImageInfo -> decode_unicode_le ) ) == ( size_t ) - 1 )  location: 2698 cross_layer: 3 file: exif.c
xp_field -> size = exif_process_string_raw ( & xp_field -> value , szValuePtr , ByteCount ); location: 2706 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return xp_field -> size ; location: 2708 cross_layer: 3 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 2 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 2 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 2 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 2 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 2 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 2 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 2 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 2 file: exif.c
switch ( tag )  location: 3100 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 2 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 2 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 3 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 4 file: exif.c
switch ( section )  location: 1403 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 3 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 3 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 3169 cross_layer: 3 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 4 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 4 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 4 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 4 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 4 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 4 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 4 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 4 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 4 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 4 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 4 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 4 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 4 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 4 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 4 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 4 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 4 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 4 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 4 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 4 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 4 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 4 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 4 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 4 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 4 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 4 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 4 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 4 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 4 file: exif.c
switch ( tag )  location: 2940 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 4 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 4 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 4 file: exif.c
switch ( tag )  location: 2977 cross_layer: 4 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 4 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 4 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 4 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 4 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 4 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 4 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 4 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 4 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 4 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 4 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 4 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 4 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 4 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 4 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 4 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 4 file: exif.c
switch ( tag )  location: 3100 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 4 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 4 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 4 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 3 file: exif.c
switch ( section )  location: 1403 cross_layer: 3 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 4 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
static void exif_iif_add_tag(image_info_type *image_info, int section_index, char *name, int tag, int format, size_t length, void* value) location: 1789 cross_layer: 3 file: exif.c
exif_iif_add_value ( image_info , section_index , name , tag , format , ( int ) length , value , image_info -> motorola_intel ); location: 1791 cross_layer: 3 file: exif.c
static void exif_iif_add_value(image_info_type *image_info, int section_index, char *name, int tag, int format, int length, void* value, int motorola_intel) location: 1657 cross_layer: 4 file: exif.c
if ( length < 0 )  location: 1665 cross_layer: 4 file: exif.c
list = safe_erealloc ( image_info -> info_list [ section_index ] . list , ( image_info -> info_list [ section_index ] . count + 1 ) , sizeof ( image_info_data ) , 0 ); location: 1669 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . list = list; location: 1670 cross_layer: 4 file: exif.c
info_data = & image_info -> info_list [ section_index ] . list [ image_info -> info_list [ section_index ] . count ]; location: 1672 cross_layer: 4 file: exif.c
memset ( info_data , 0 , sizeof ( image_info_data ) ); location: 1673 cross_layer: 4 file: exif.c
info_data -> tag = tag; location: 1674 cross_layer: 4 file: exif.c
info_data -> format = format; location: 1675 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1676 cross_layer: 4 file: exif.c
info_data -> name = estrdup ( name ); location: 1677 cross_layer: 4 file: exif.c
info_value = & info_data -> value; location: 1678 cross_layer: 4 file: exif.c
switch ( format )  location: 1680 cross_layer: 4 file: exif.c
if ( value )  location: 1682 cross_layer: 4 file: exif.c
length = php_strnlen ( value , length ); location: 1683 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1684 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1685 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1687 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1688 cross_layer: 4 file: exif.c
info_data -> tag = TAG_FMT_UNDEFINED; location: 1698 cross_layer: 4 file: exif.c
if ( ! length )  location: 1702 cross_layer: 4 file: exif.c
if ( value )  location: 1705 cross_layer: 4 file: exif.c
if ( tag == TAG_MAKER_NOTE )  location: 1706 cross_layer: 4 file: exif.c
length = ( int ) php_strnlen ( value , length ); location: 1707 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1711 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1712 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1714 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1715 cross_layer: 4 file: exif.c
if ( length == 0 )  location: 1727 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1730 cross_layer: 4 file: exif.c
for (idex=0,vptr=value; idex<(size_t)length; idex++,vptr=(char *) vptr + php_tiff_bytes_per_format[format]) location: 1735 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1736 cross_layer: 4 file: exif.c
info_value = & info_data -> value . list [ idex ]; location: 1737 cross_layer: 4 file: exif.c
switch ( format )  location: 1739 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get16u ( vptr , motorola_intel ); location: 1741 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get32u ( vptr , motorola_intel ); location: 1745 cross_layer: 4 file: exif.c
info_value -> ur . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1749 cross_layer: 4 file: exif.c
info_value -> ur . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1750 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get16s ( vptr , motorola_intel ); location: 1754 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get32s ( vptr , motorola_intel ); location: 1758 cross_layer: 4 file: exif.c
info_value -> sr . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1762 cross_layer: 4 file: exif.c
info_value -> sr . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1763 cross_layer: 4 file: exif.c
info_value -> f = * ( float * ) value; location: 1770 cross_layer: 4 file: exif.c
info_value -> d = * ( double * ) value; location: 1776 cross_layer: 4 file: exif.c
image_info -> sections_found |= 1 << section_index; location: 1781 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . count ++; location: 1782 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 3 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 3 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 3 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 3 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 4 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 4 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 4 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 4 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 4 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 4 file: exif.c
static void exif_thumbnail_extract(image_info_type *ImageInfo, char *offset, size_t length) location: 2522 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . data )  location: 2523 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_mult_thumb" EXIFERR_CC , ImageInfo , E_WARNING , "Multiple possible thumbnails" ) location: 2524 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> read_thumbnail )  location: 2527 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size >= 65536 || ImageInfo -> Thumbnail . size <= 0 || ImageInfo -> Thumbnail . offset <= 0 )  location: 2531 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Illegal thumbnail size/offset" ) location: 2535 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size > length || ( ImageInfo -> Thumbnail . offset + ImageInfo -> Thumbnail . size ) > length || ImageInfo -> Thumbnail . offset > length - ImageInfo -> Thumbnail . size )  location: 2539 cross_layer: 4 file: exif.c
EXIF_ERRLOG_THUMBEOF ( ImageInfo ) location: 2543 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . data = estrndup ( offset + ImageInfo -> Thumbnail . offset , ImageInfo -> Thumbnail . size ); location: 2546 cross_layer: 4 file: exif.c
exif_thumbnail_build ( ImageInfo ); location: 2547 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 3 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 2 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 2 file: exif.c
ImageInfo -> motorola_intel = old_motorola_intel; location: 2812 cross_layer: 1 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( SECTION_MAKERNOTE ) ) location: 2815 cross_layer: 1 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 2 file: exif.c
switch ( section )  location: 1403 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 4 file: exif.c
------------------------------
13 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2805 @@ ['dir_start', 'value_ptr'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 2806 cross_layer: 1 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , data_len , displacement , section_index , 0 , maker_note -> tag_table ) )  location: 2807 cross_layer: 1 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 2 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 2 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 2 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
for (i = 0; (t = tag_table[i].Tag) != TAG_END_OF_LIST; i++) location: 999 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 2 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 2 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 2 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 2 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 2 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 2 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 2 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 2 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 2 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 2 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 2 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 2 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 2 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 2 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 2 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 2 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 2 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 2 file: exif.c
char * exif_dump_data(int *dump_free, int format, int components, int length, int motorola_intel, char *value_ptr) /* location: 1151 cross_layer: 3 file: exif.c
* dump_free = 0; location: 1156 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_STRING )  location: 1157 cross_layer: 3 file: exif.c
return value_ptr ? value_ptr : "<no data>" ; location: 1158 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_UNDEFINED )  location: 1160 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_IFD )  location: 1163 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_SINGLE || format == TAG_FMT_DOUBLE )  location: 1166 cross_layer: 3 file: exif.c
* dump_free = 1; location: 1169 cross_layer: 3 file: exif.c
if ( components > 1 )  location: 1170 cross_layer: 3 file: exif.c
len = spprintf ( & dump , 0 , "(%d,%d) {" , components , length ); location: 1171 cross_layer: 3 file: exif.c
while ( components > 0 )  location: 1175 cross_layer: 3 file: exif.c
switch ( format )  location: 1176 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 4 + 1 ); location: 1181 cross_layer: 3 file: exif.c
snprintf ( dump + len , 4 + 1 , "0x%02X" , * value_ptr ); location: 1182 cross_layer: 3 file: exif.c
len += 4; location: 1183 cross_layer: 3 file: exif.c
value_ptr ++; location: 1184 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1188 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get16s ( value_ptr , motorola_intel ) ); location: 1189 cross_layer: 3 file: exif.c
static signed short php_ifd_get16s(void *value, int motorola_intel) location: 1086 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1088 cross_layer: 4 file: exif.c
len += 6; location: 1190 cross_layer: 3 file: exif.c
value_ptr += 2; location: 1191 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1195 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) ); location: 1196 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 6; location: 1197 cross_layer: 3 file: exif.c
value_ptr += 4; location: 1198 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 13 + 1 ); location: 1202 cross_layer: 3 file: exif.c
snprintf ( dump + len , 13 + 1 , "0x%04X/0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) , php_ifd_get32s ( value_ptr + 4 , motorola_intel ) ); location: 1203 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 13; location: 1204 cross_layer: 3 file: exif.c
value_ptr += 8; location: 1205 cross_layer: 3 file: exif.c
if ( components > 0 )  location: 1208 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 2 + 1 ); location: 1209 cross_layer: 3 file: exif.c
snprintf ( dump + len , 2 + 1 , ", " ); location: 1210 cross_layer: 3 file: exif.c
len += 2; location: 1211 cross_layer: 3 file: exif.c
components --; location: 1212 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 1 + 1 ); location: 1217 cross_layer: 3 file: exif.c
snprintf ( dump + len , 1 + 1 , "}" ); location: 1218 cross_layer: 3 file: exif.c
return dump ; location: 1219 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 2 file: exif.c
static char *exif_get_tagformat(int format) location: 323 cross_layer: 3 file: exif.c
switch ( format )  location: 325 cross_layer: 3 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 2 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 2 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 2 file: exif.c
switch ( tag )  location: 2940 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 2 file: exif.c
switch ( tag )  location: 2977 cross_layer: 2 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 2 file: exif.c
static size_t php_strnlen(char* str, size_t maxlen) location: 277 cross_layer: 3 file: exif.c
if ( str && maxlen && * str )  location: 280 cross_layer: 3 file: exif.c
while ( -- maxlen && * ( ++ str ) )  location: 283 cross_layer: 3 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 2 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 2 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 2 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 2 file: exif.c
static int exif_process_user_comment(image_info_type *ImageInfo, char **pszInfoPtr, char **pszEncoding, char *szValuePtr, int ByteCount) location: 2605 cross_layer: 3 file: exif.c
* pszEncoding = NULL; location: 2611 cross_layer: 3 file: exif.c
if ( ByteCount >= 8 )  location: 2613 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "UNICODE\0" , 8 ) )  location: 2615 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2616 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2617 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2618 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFE\xFF" , 2 ) )  location: 2622 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2624 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2625 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFF\xFE" , 2 ) )  location: 2626 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2628 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2629 cross_layer: 3 file: exif.c
if ( ImageInfo -> motorola_intel )  location: 2630 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_be; location: 2631 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_le; location: 2633 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ); location: 2635 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( decode ); location: 2636 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2638 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2645 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2647 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "ASCII\0\0\0" , 8 ) )  location: 2648 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2649 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2650 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2651 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "JIS\0\0\0\0\0" , 8 ) )  location: 2652 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2654 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2655 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2656 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_jis ); location: 2658 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_jis_be : ImageInfo -> decode_jis_le ); location: 2659 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2660 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2667 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2669 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\0\0\0\0\0\0\0\0" , 8 ) )  location: 2670 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( "UNDEFINED" ); location: 2672 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2673 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2674 cross_layer: 3 file: exif.c
if ( ByteCount > 0 )  location: 2679 cross_layer: 3 file: exif.c
for (a=ByteCount-1;a && szValuePtr[a]==' ';a--) location: 2680 cross_layer: 3 file: exif.c
( szValuePtr ) [ a ] = '\0'; location: 2681 cross_layer: 3 file: exif.c
exif_process_string ( pszInfoPtr , szValuePtr , ByteCount ); location: 2686 cross_layer: 3 file: exif.c
static int exif_process_string(char **result, char *value, size_t byte_count) location: 2587 cross_layer: 4 file: exif.c
if ( ( byte_count = php_strnlen ( value , byte_count ) ) > 0 )  location: 2595 cross_layer: 4 file: exif.c
return exif_process_undefined ( result , value , byte_count ) ; location: 2596 cross_layer: 4 file: exif.c
( * result ) = estrndup ( "" , 1 ); location: 2598 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2599 cross_layer: 4 file: exif.c
return strlen ( * pszInfoPtr ) ; location: 2687 cross_layer: 3 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 2 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 2 file: exif.c
static int exif_process_unicode(image_info_type *ImageInfo, xp_field_type *xp_field, int tag, char *szValuePtr, int ByteCount) location: 2693 cross_layer: 3 file: exif.c
xp_field -> tag = tag; location: 2695 cross_layer: 3 file: exif.c
xp_field -> value = NULL; location: 2696 cross_layer: 3 file: exif.c
if ( zend_multibyte_encoding_converter ( ( unsigned char * * ) & xp_field -> value , & xp_field -> size , ( unsigned char * ) szValuePtr , ByteCount , zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ) , zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_unicode_be : ImageInfo -> decode_unicode_le ) ) == ( size_t ) - 1 )  location: 2698 cross_layer: 3 file: exif.c
xp_field -> size = exif_process_string_raw ( & xp_field -> value , szValuePtr , ByteCount ); location: 2706 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return xp_field -> size ; location: 2708 cross_layer: 3 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 2 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 2 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 2 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 2 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 2 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 2 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 2 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 2 file: exif.c
switch ( tag )  location: 3100 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 2 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 2 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 3 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 4 file: exif.c
switch ( section )  location: 1403 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 3 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 3 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 3169 cross_layer: 3 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 4 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 4 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 4 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 4 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 4 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 4 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 4 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 4 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 4 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 4 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 4 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 4 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 4 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 4 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 4 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 4 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 4 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 4 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 4 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 4 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 4 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 4 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 4 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 4 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 4 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 4 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 4 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 4 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 4 file: exif.c
switch ( tag )  location: 2940 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 4 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 4 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 4 file: exif.c
switch ( tag )  location: 2977 cross_layer: 4 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 4 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 4 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 4 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 4 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 4 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 4 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 4 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 4 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 4 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 4 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 4 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 4 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 4 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 4 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 4 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 4 file: exif.c
switch ( tag )  location: 3100 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 4 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 4 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 4 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 3 file: exif.c
switch ( section )  location: 1403 cross_layer: 3 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 4 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
static void exif_iif_add_tag(image_info_type *image_info, int section_index, char *name, int tag, int format, size_t length, void* value) location: 1789 cross_layer: 3 file: exif.c
exif_iif_add_value ( image_info , section_index , name , tag , format , ( int ) length , value , image_info -> motorola_intel ); location: 1791 cross_layer: 3 file: exif.c
static void exif_iif_add_value(image_info_type *image_info, int section_index, char *name, int tag, int format, int length, void* value, int motorola_intel) location: 1657 cross_layer: 4 file: exif.c
if ( length < 0 )  location: 1665 cross_layer: 4 file: exif.c
list = safe_erealloc ( image_info -> info_list [ section_index ] . list , ( image_info -> info_list [ section_index ] . count + 1 ) , sizeof ( image_info_data ) , 0 ); location: 1669 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . list = list; location: 1670 cross_layer: 4 file: exif.c
info_data = & image_info -> info_list [ section_index ] . list [ image_info -> info_list [ section_index ] . count ]; location: 1672 cross_layer: 4 file: exif.c
memset ( info_data , 0 , sizeof ( image_info_data ) ); location: 1673 cross_layer: 4 file: exif.c
info_data -> tag = tag; location: 1674 cross_layer: 4 file: exif.c
info_data -> format = format; location: 1675 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1676 cross_layer: 4 file: exif.c
info_data -> name = estrdup ( name ); location: 1677 cross_layer: 4 file: exif.c
info_value = & info_data -> value; location: 1678 cross_layer: 4 file: exif.c
switch ( format )  location: 1680 cross_layer: 4 file: exif.c
if ( value )  location: 1682 cross_layer: 4 file: exif.c
length = php_strnlen ( value , length ); location: 1683 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1684 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1685 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1687 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1688 cross_layer: 4 file: exif.c
info_data -> tag = TAG_FMT_UNDEFINED; location: 1698 cross_layer: 4 file: exif.c
if ( ! length )  location: 1702 cross_layer: 4 file: exif.c
if ( value )  location: 1705 cross_layer: 4 file: exif.c
if ( tag == TAG_MAKER_NOTE )  location: 1706 cross_layer: 4 file: exif.c
length = ( int ) php_strnlen ( value , length ); location: 1707 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1711 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1712 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1714 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1715 cross_layer: 4 file: exif.c
if ( length == 0 )  location: 1727 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1730 cross_layer: 4 file: exif.c
for (idex=0,vptr=value; idex<(size_t)length; idex++,vptr=(char *) vptr + php_tiff_bytes_per_format[format]) location: 1735 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1736 cross_layer: 4 file: exif.c
info_value = & info_data -> value . list [ idex ]; location: 1737 cross_layer: 4 file: exif.c
switch ( format )  location: 1739 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get16u ( vptr , motorola_intel ); location: 1741 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get32u ( vptr , motorola_intel ); location: 1745 cross_layer: 4 file: exif.c
info_value -> ur . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1749 cross_layer: 4 file: exif.c
info_value -> ur . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1750 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get16s ( vptr , motorola_intel ); location: 1754 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get32s ( vptr , motorola_intel ); location: 1758 cross_layer: 4 file: exif.c
info_value -> sr . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1762 cross_layer: 4 file: exif.c
info_value -> sr . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1763 cross_layer: 4 file: exif.c
info_value -> f = * ( float * ) value; location: 1770 cross_layer: 4 file: exif.c
info_value -> d = * ( double * ) value; location: 1776 cross_layer: 4 file: exif.c
image_info -> sections_found |= 1 << section_index; location: 1781 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . count ++; location: 1782 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 3 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 3 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 3 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 3 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 4 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 4 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 4 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 4 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 4 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 4 file: exif.c
static void exif_thumbnail_extract(image_info_type *ImageInfo, char *offset, size_t length) location: 2522 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . data )  location: 2523 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_mult_thumb" EXIFERR_CC , ImageInfo , E_WARNING , "Multiple possible thumbnails" ) location: 2524 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> read_thumbnail )  location: 2527 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size >= 65536 || ImageInfo -> Thumbnail . size <= 0 || ImageInfo -> Thumbnail . offset <= 0 )  location: 2531 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Illegal thumbnail size/offset" ) location: 2535 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size > length || ( ImageInfo -> Thumbnail . offset + ImageInfo -> Thumbnail . size ) > length || ImageInfo -> Thumbnail . offset > length - ImageInfo -> Thumbnail . size )  location: 2539 cross_layer: 4 file: exif.c
EXIF_ERRLOG_THUMBEOF ( ImageInfo ) location: 2543 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . data = estrndup ( offset + ImageInfo -> Thumbnail . offset , ImageInfo -> Thumbnail . size ); location: 2546 cross_layer: 4 file: exif.c
exif_thumbnail_build ( ImageInfo ); location: 2547 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 3 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 2 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 2 file: exif.c
ImageInfo -> motorola_intel = old_motorola_intel; location: 2812 cross_layer: 1 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( SECTION_MAKERNOTE ) ) location: 2815 cross_layer: 1 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 2 file: exif.c
switch ( section )  location: 1403 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , ( char * ) dir_entry , ( char * ) ( ImageInfo -> file . list [ sn ] . data - dir_offset ) , ifd_size , 0 , section_index , 0 , tag_table ) )  location: 3750 cross_layer: 3 file: exif.c
exif_process_IFD_in_TIFF ( ImageInfo , entry_offset , sub_section_index ); location: 3722 cross_layer: 4 file: exif.c
------------------------------
14 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2805 @@ ['dir_start', 'value_ptr'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 2806 cross_layer: 1 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , data_len , displacement , section_index , 0 , maker_note -> tag_table ) )  location: 2807 cross_layer: 1 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 2 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 2 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 2 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
for (i = 0; (t = tag_table[i].Tag) != TAG_END_OF_LIST; i++) location: 999 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 2 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 2 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 2 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 2 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 2 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 2 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 2 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 2 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 2 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 2 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 2 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 2 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 2 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 2 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 2 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 2 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 2 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 2 file: exif.c
char * exif_dump_data(int *dump_free, int format, int components, int length, int motorola_intel, char *value_ptr) /* location: 1151 cross_layer: 3 file: exif.c
* dump_free = 0; location: 1156 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_STRING )  location: 1157 cross_layer: 3 file: exif.c
return value_ptr ? value_ptr : "<no data>" ; location: 1158 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_UNDEFINED )  location: 1160 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_IFD )  location: 1163 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_SINGLE || format == TAG_FMT_DOUBLE )  location: 1166 cross_layer: 3 file: exif.c
* dump_free = 1; location: 1169 cross_layer: 3 file: exif.c
if ( components > 1 )  location: 1170 cross_layer: 3 file: exif.c
len = spprintf ( & dump , 0 , "(%d,%d) {" , components , length ); location: 1171 cross_layer: 3 file: exif.c
while ( components > 0 )  location: 1175 cross_layer: 3 file: exif.c
switch ( format )  location: 1176 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 4 + 1 ); location: 1181 cross_layer: 3 file: exif.c
snprintf ( dump + len , 4 + 1 , "0x%02X" , * value_ptr ); location: 1182 cross_layer: 3 file: exif.c
len += 4; location: 1183 cross_layer: 3 file: exif.c
value_ptr ++; location: 1184 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1188 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get16s ( value_ptr , motorola_intel ) ); location: 1189 cross_layer: 3 file: exif.c
static signed short php_ifd_get16s(void *value, int motorola_intel) location: 1086 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1088 cross_layer: 4 file: exif.c
len += 6; location: 1190 cross_layer: 3 file: exif.c
value_ptr += 2; location: 1191 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1195 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) ); location: 1196 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 6; location: 1197 cross_layer: 3 file: exif.c
value_ptr += 4; location: 1198 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 13 + 1 ); location: 1202 cross_layer: 3 file: exif.c
snprintf ( dump + len , 13 + 1 , "0x%04X/0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) , php_ifd_get32s ( value_ptr + 4 , motorola_intel ) ); location: 1203 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 13; location: 1204 cross_layer: 3 file: exif.c
value_ptr += 8; location: 1205 cross_layer: 3 file: exif.c
if ( components > 0 )  location: 1208 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 2 + 1 ); location: 1209 cross_layer: 3 file: exif.c
snprintf ( dump + len , 2 + 1 , ", " ); location: 1210 cross_layer: 3 file: exif.c
len += 2; location: 1211 cross_layer: 3 file: exif.c
components --; location: 1212 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 1 + 1 ); location: 1217 cross_layer: 3 file: exif.c
snprintf ( dump + len , 1 + 1 , "}" ); location: 1218 cross_layer: 3 file: exif.c
return dump ; location: 1219 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 2 file: exif.c
static char *exif_get_tagformat(int format) location: 323 cross_layer: 3 file: exif.c
switch ( format )  location: 325 cross_layer: 3 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 2 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 2 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 2 file: exif.c
switch ( tag )  location: 2940 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 2 file: exif.c
switch ( tag )  location: 2977 cross_layer: 2 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 2 file: exif.c
static size_t php_strnlen(char* str, size_t maxlen) location: 277 cross_layer: 3 file: exif.c
if ( str && maxlen && * str )  location: 280 cross_layer: 3 file: exif.c
while ( -- maxlen && * ( ++ str ) )  location: 283 cross_layer: 3 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 2 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 2 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 2 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 2 file: exif.c
static int exif_process_user_comment(image_info_type *ImageInfo, char **pszInfoPtr, char **pszEncoding, char *szValuePtr, int ByteCount) location: 2605 cross_layer: 3 file: exif.c
* pszEncoding = NULL; location: 2611 cross_layer: 3 file: exif.c
if ( ByteCount >= 8 )  location: 2613 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "UNICODE\0" , 8 ) )  location: 2615 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2616 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2617 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2618 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFE\xFF" , 2 ) )  location: 2622 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2624 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2625 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFF\xFE" , 2 ) )  location: 2626 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2628 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2629 cross_layer: 3 file: exif.c
if ( ImageInfo -> motorola_intel )  location: 2630 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_be; location: 2631 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_le; location: 2633 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ); location: 2635 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( decode ); location: 2636 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2638 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2645 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2647 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "ASCII\0\0\0" , 8 ) )  location: 2648 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2649 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2650 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2651 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "JIS\0\0\0\0\0" , 8 ) )  location: 2652 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2654 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2655 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2656 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_jis ); location: 2658 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_jis_be : ImageInfo -> decode_jis_le ); location: 2659 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2660 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2667 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2669 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\0\0\0\0\0\0\0\0" , 8 ) )  location: 2670 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( "UNDEFINED" ); location: 2672 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2673 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2674 cross_layer: 3 file: exif.c
if ( ByteCount > 0 )  location: 2679 cross_layer: 3 file: exif.c
for (a=ByteCount-1;a && szValuePtr[a]==' ';a--) location: 2680 cross_layer: 3 file: exif.c
( szValuePtr ) [ a ] = '\0'; location: 2681 cross_layer: 3 file: exif.c
exif_process_string ( pszInfoPtr , szValuePtr , ByteCount ); location: 2686 cross_layer: 3 file: exif.c
static int exif_process_string(char **result, char *value, size_t byte_count) location: 2587 cross_layer: 4 file: exif.c
if ( ( byte_count = php_strnlen ( value , byte_count ) ) > 0 )  location: 2595 cross_layer: 4 file: exif.c
return exif_process_undefined ( result , value , byte_count ) ; location: 2596 cross_layer: 4 file: exif.c
( * result ) = estrndup ( "" , 1 ); location: 2598 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2599 cross_layer: 4 file: exif.c
return strlen ( * pszInfoPtr ) ; location: 2687 cross_layer: 3 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 2 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 2 file: exif.c
static int exif_process_unicode(image_info_type *ImageInfo, xp_field_type *xp_field, int tag, char *szValuePtr, int ByteCount) location: 2693 cross_layer: 3 file: exif.c
xp_field -> tag = tag; location: 2695 cross_layer: 3 file: exif.c
xp_field -> value = NULL; location: 2696 cross_layer: 3 file: exif.c
if ( zend_multibyte_encoding_converter ( ( unsigned char * * ) & xp_field -> value , & xp_field -> size , ( unsigned char * ) szValuePtr , ByteCount , zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ) , zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_unicode_be : ImageInfo -> decode_unicode_le ) ) == ( size_t ) - 1 )  location: 2698 cross_layer: 3 file: exif.c
xp_field -> size = exif_process_string_raw ( & xp_field -> value , szValuePtr , ByteCount ); location: 2706 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return xp_field -> size ; location: 2708 cross_layer: 3 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 2 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 2 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 2 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 2 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 2 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 2 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 2 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 2 file: exif.c
switch ( tag )  location: 3100 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 2 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 2 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 3 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 4 file: exif.c
switch ( section )  location: 1403 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 3 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 3 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 3169 cross_layer: 3 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 4 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 4 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 4 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 4 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 4 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 4 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 4 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 4 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 4 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 4 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 4 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 4 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 4 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 4 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 4 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 4 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 4 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 4 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 4 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 4 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 4 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 4 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 4 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 4 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 4 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 4 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 4 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 4 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 4 file: exif.c
switch ( tag )  location: 2940 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 4 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 4 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 4 file: exif.c
switch ( tag )  location: 2977 cross_layer: 4 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 4 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 4 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 4 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 4 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 4 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 4 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 4 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 4 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 4 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 4 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 4 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 4 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 4 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 4 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 4 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 4 file: exif.c
switch ( tag )  location: 3100 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 4 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 4 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 4 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 3 file: exif.c
switch ( section )  location: 1403 cross_layer: 3 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 4 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
static void exif_iif_add_tag(image_info_type *image_info, int section_index, char *name, int tag, int format, size_t length, void* value) location: 1789 cross_layer: 3 file: exif.c
exif_iif_add_value ( image_info , section_index , name , tag , format , ( int ) length , value , image_info -> motorola_intel ); location: 1791 cross_layer: 3 file: exif.c
static void exif_iif_add_value(image_info_type *image_info, int section_index, char *name, int tag, int format, int length, void* value, int motorola_intel) location: 1657 cross_layer: 4 file: exif.c
if ( length < 0 )  location: 1665 cross_layer: 4 file: exif.c
list = safe_erealloc ( image_info -> info_list [ section_index ] . list , ( image_info -> info_list [ section_index ] . count + 1 ) , sizeof ( image_info_data ) , 0 ); location: 1669 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . list = list; location: 1670 cross_layer: 4 file: exif.c
info_data = & image_info -> info_list [ section_index ] . list [ image_info -> info_list [ section_index ] . count ]; location: 1672 cross_layer: 4 file: exif.c
memset ( info_data , 0 , sizeof ( image_info_data ) ); location: 1673 cross_layer: 4 file: exif.c
info_data -> tag = tag; location: 1674 cross_layer: 4 file: exif.c
info_data -> format = format; location: 1675 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1676 cross_layer: 4 file: exif.c
info_data -> name = estrdup ( name ); location: 1677 cross_layer: 4 file: exif.c
info_value = & info_data -> value; location: 1678 cross_layer: 4 file: exif.c
switch ( format )  location: 1680 cross_layer: 4 file: exif.c
if ( value )  location: 1682 cross_layer: 4 file: exif.c
length = php_strnlen ( value , length ); location: 1683 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1684 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1685 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1687 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1688 cross_layer: 4 file: exif.c
info_data -> tag = TAG_FMT_UNDEFINED; location: 1698 cross_layer: 4 file: exif.c
if ( ! length )  location: 1702 cross_layer: 4 file: exif.c
if ( value )  location: 1705 cross_layer: 4 file: exif.c
if ( tag == TAG_MAKER_NOTE )  location: 1706 cross_layer: 4 file: exif.c
length = ( int ) php_strnlen ( value , length ); location: 1707 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1711 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1712 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1714 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1715 cross_layer: 4 file: exif.c
if ( length == 0 )  location: 1727 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1730 cross_layer: 4 file: exif.c
for (idex=0,vptr=value; idex<(size_t)length; idex++,vptr=(char *) vptr + php_tiff_bytes_per_format[format]) location: 1735 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1736 cross_layer: 4 file: exif.c
info_value = & info_data -> value . list [ idex ]; location: 1737 cross_layer: 4 file: exif.c
switch ( format )  location: 1739 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get16u ( vptr , motorola_intel ); location: 1741 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get32u ( vptr , motorola_intel ); location: 1745 cross_layer: 4 file: exif.c
info_value -> ur . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1749 cross_layer: 4 file: exif.c
info_value -> ur . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1750 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get16s ( vptr , motorola_intel ); location: 1754 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get32s ( vptr , motorola_intel ); location: 1758 cross_layer: 4 file: exif.c
info_value -> sr . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1762 cross_layer: 4 file: exif.c
info_value -> sr . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1763 cross_layer: 4 file: exif.c
info_value -> f = * ( float * ) value; location: 1770 cross_layer: 4 file: exif.c
info_value -> d = * ( double * ) value; location: 1776 cross_layer: 4 file: exif.c
image_info -> sections_found |= 1 << section_index; location: 1781 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . count ++; location: 1782 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 3 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 3 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 3 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 3 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 4 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 4 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 4 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 4 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 4 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 4 file: exif.c
static void exif_thumbnail_extract(image_info_type *ImageInfo, char *offset, size_t length) location: 2522 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . data )  location: 2523 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_mult_thumb" EXIFERR_CC , ImageInfo , E_WARNING , "Multiple possible thumbnails" ) location: 2524 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> read_thumbnail )  location: 2527 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size >= 65536 || ImageInfo -> Thumbnail . size <= 0 || ImageInfo -> Thumbnail . offset <= 0 )  location: 2531 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Illegal thumbnail size/offset" ) location: 2535 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size > length || ( ImageInfo -> Thumbnail . offset + ImageInfo -> Thumbnail . size ) > length || ImageInfo -> Thumbnail . offset > length - ImageInfo -> Thumbnail . size )  location: 2539 cross_layer: 4 file: exif.c
EXIF_ERRLOG_THUMBEOF ( ImageInfo ) location: 2543 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . data = estrndup ( offset + ImageInfo -> Thumbnail . offset , ImageInfo -> Thumbnail . size ); location: 2546 cross_layer: 4 file: exif.c
exif_thumbnail_build ( ImageInfo ); location: 2547 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 3 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 2 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 2 file: exif.c
ImageInfo -> motorola_intel = old_motorola_intel; location: 2812 cross_layer: 1 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( SECTION_MAKERNOTE ) ) location: 2815 cross_layer: 1 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 2 file: exif.c
switch ( section )  location: 1403 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , ( char * ) dir_entry , ( char * ) ( ImageInfo -> file . list [ sn ] . data - dir_offset ) , ifd_size , 0 , section_index , 0 , tag_table ) )  location: 3750 cross_layer: 3 file: exif.c
exif_process_IFD_in_TIFF ( ImageInfo , next_offset , SECTION_THUMBNAIL ); location: 3765 cross_layer: 4 file: exif.c
------------------------------
15 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2805 @@ ['dir_start', 'value_ptr'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 2806 cross_layer: 1 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , data_len , displacement , section_index , 0 , maker_note -> tag_table ) )  location: 2807 cross_layer: 1 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 2 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 2 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 2 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
for (i = 0; (t = tag_table[i].Tag) != TAG_END_OF_LIST; i++) location: 999 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 2 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 2 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 2 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 2 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 2 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 2 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 2 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 2 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 2 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 2 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 2 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 2 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 2 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 2 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 2 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 2 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 2 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 2 file: exif.c
char * exif_dump_data(int *dump_free, int format, int components, int length, int motorola_intel, char *value_ptr) /* location: 1151 cross_layer: 3 file: exif.c
* dump_free = 0; location: 1156 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_STRING )  location: 1157 cross_layer: 3 file: exif.c
return value_ptr ? value_ptr : "<no data>" ; location: 1158 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_UNDEFINED )  location: 1160 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_IFD )  location: 1163 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_SINGLE || format == TAG_FMT_DOUBLE )  location: 1166 cross_layer: 3 file: exif.c
* dump_free = 1; location: 1169 cross_layer: 3 file: exif.c
if ( components > 1 )  location: 1170 cross_layer: 3 file: exif.c
len = spprintf ( & dump , 0 , "(%d,%d) {" , components , length ); location: 1171 cross_layer: 3 file: exif.c
while ( components > 0 )  location: 1175 cross_layer: 3 file: exif.c
switch ( format )  location: 1176 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 4 + 1 ); location: 1181 cross_layer: 3 file: exif.c
snprintf ( dump + len , 4 + 1 , "0x%02X" , * value_ptr ); location: 1182 cross_layer: 3 file: exif.c
len += 4; location: 1183 cross_layer: 3 file: exif.c
value_ptr ++; location: 1184 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1188 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get16s ( value_ptr , motorola_intel ) ); location: 1189 cross_layer: 3 file: exif.c
static signed short php_ifd_get16s(void *value, int motorola_intel) location: 1086 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1088 cross_layer: 4 file: exif.c
len += 6; location: 1190 cross_layer: 3 file: exif.c
value_ptr += 2; location: 1191 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1195 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) ); location: 1196 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 6; location: 1197 cross_layer: 3 file: exif.c
value_ptr += 4; location: 1198 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 13 + 1 ); location: 1202 cross_layer: 3 file: exif.c
snprintf ( dump + len , 13 + 1 , "0x%04X/0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) , php_ifd_get32s ( value_ptr + 4 , motorola_intel ) ); location: 1203 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 13; location: 1204 cross_layer: 3 file: exif.c
value_ptr += 8; location: 1205 cross_layer: 3 file: exif.c
if ( components > 0 )  location: 1208 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 2 + 1 ); location: 1209 cross_layer: 3 file: exif.c
snprintf ( dump + len , 2 + 1 , ", " ); location: 1210 cross_layer: 3 file: exif.c
len += 2; location: 1211 cross_layer: 3 file: exif.c
components --; location: 1212 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 1 + 1 ); location: 1217 cross_layer: 3 file: exif.c
snprintf ( dump + len , 1 + 1 , "}" ); location: 1218 cross_layer: 3 file: exif.c
return dump ; location: 1219 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 2 file: exif.c
static char *exif_get_tagformat(int format) location: 323 cross_layer: 3 file: exif.c
switch ( format )  location: 325 cross_layer: 3 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 2 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 2 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 2 file: exif.c
switch ( tag )  location: 2940 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 2 file: exif.c
switch ( tag )  location: 2977 cross_layer: 2 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 2 file: exif.c
static size_t php_strnlen(char* str, size_t maxlen) location: 277 cross_layer: 3 file: exif.c
if ( str && maxlen && * str )  location: 280 cross_layer: 3 file: exif.c
while ( -- maxlen && * ( ++ str ) )  location: 283 cross_layer: 3 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 2 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 2 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 2 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 2 file: exif.c
static int exif_process_user_comment(image_info_type *ImageInfo, char **pszInfoPtr, char **pszEncoding, char *szValuePtr, int ByteCount) location: 2605 cross_layer: 3 file: exif.c
* pszEncoding = NULL; location: 2611 cross_layer: 3 file: exif.c
if ( ByteCount >= 8 )  location: 2613 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "UNICODE\0" , 8 ) )  location: 2615 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2616 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2617 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2618 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFE\xFF" , 2 ) )  location: 2622 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2624 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2625 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFF\xFE" , 2 ) )  location: 2626 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2628 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2629 cross_layer: 3 file: exif.c
if ( ImageInfo -> motorola_intel )  location: 2630 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_be; location: 2631 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_le; location: 2633 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ); location: 2635 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( decode ); location: 2636 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2638 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2645 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2647 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "ASCII\0\0\0" , 8 ) )  location: 2648 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2649 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2650 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2651 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "JIS\0\0\0\0\0" , 8 ) )  location: 2652 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2654 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2655 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2656 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_jis ); location: 2658 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_jis_be : ImageInfo -> decode_jis_le ); location: 2659 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2660 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2667 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2669 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\0\0\0\0\0\0\0\0" , 8 ) )  location: 2670 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( "UNDEFINED" ); location: 2672 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2673 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2674 cross_layer: 3 file: exif.c
if ( ByteCount > 0 )  location: 2679 cross_layer: 3 file: exif.c
for (a=ByteCount-1;a && szValuePtr[a]==' ';a--) location: 2680 cross_layer: 3 file: exif.c
( szValuePtr ) [ a ] = '\0'; location: 2681 cross_layer: 3 file: exif.c
exif_process_string ( pszInfoPtr , szValuePtr , ByteCount ); location: 2686 cross_layer: 3 file: exif.c
static int exif_process_string(char **result, char *value, size_t byte_count) location: 2587 cross_layer: 4 file: exif.c
if ( ( byte_count = php_strnlen ( value , byte_count ) ) > 0 )  location: 2595 cross_layer: 4 file: exif.c
return exif_process_undefined ( result , value , byte_count ) ; location: 2596 cross_layer: 4 file: exif.c
( * result ) = estrndup ( "" , 1 ); location: 2598 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2599 cross_layer: 4 file: exif.c
return strlen ( * pszInfoPtr ) ; location: 2687 cross_layer: 3 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 2 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 2 file: exif.c
static int exif_process_unicode(image_info_type *ImageInfo, xp_field_type *xp_field, int tag, char *szValuePtr, int ByteCount) location: 2693 cross_layer: 3 file: exif.c
xp_field -> tag = tag; location: 2695 cross_layer: 3 file: exif.c
xp_field -> value = NULL; location: 2696 cross_layer: 3 file: exif.c
if ( zend_multibyte_encoding_converter ( ( unsigned char * * ) & xp_field -> value , & xp_field -> size , ( unsigned char * ) szValuePtr , ByteCount , zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ) , zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_unicode_be : ImageInfo -> decode_unicode_le ) ) == ( size_t ) - 1 )  location: 2698 cross_layer: 3 file: exif.c
xp_field -> size = exif_process_string_raw ( & xp_field -> value , szValuePtr , ByteCount ); location: 2706 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return xp_field -> size ; location: 2708 cross_layer: 3 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 2 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 2 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 2 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 2 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 2 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 2 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 2 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 2 file: exif.c
switch ( tag )  location: 3100 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 2 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 2 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 3 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 4 file: exif.c
switch ( section )  location: 1403 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 3 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 3 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 3169 cross_layer: 3 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 4 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 4 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 4 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 4 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 4 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 4 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 4 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 4 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 4 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 4 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 4 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 4 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 4 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 4 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 4 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 4 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 4 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 4 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 4 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 4 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 4 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 4 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 4 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 4 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 4 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 4 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 4 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 4 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 4 file: exif.c
switch ( tag )  location: 2940 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 4 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 4 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 4 file: exif.c
switch ( tag )  location: 2977 cross_layer: 4 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 4 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 4 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 4 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 4 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 4 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 4 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 4 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 4 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 4 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 4 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 4 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 4 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 4 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 4 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 4 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 4 file: exif.c
switch ( tag )  location: 3100 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 4 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 4 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 4 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 3 file: exif.c
switch ( section )  location: 1403 cross_layer: 3 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 4 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
static void exif_iif_add_tag(image_info_type *image_info, int section_index, char *name, int tag, int format, size_t length, void* value) location: 1789 cross_layer: 3 file: exif.c
exif_iif_add_value ( image_info , section_index , name , tag , format , ( int ) length , value , image_info -> motorola_intel ); location: 1791 cross_layer: 3 file: exif.c
static void exif_iif_add_value(image_info_type *image_info, int section_index, char *name, int tag, int format, int length, void* value, int motorola_intel) location: 1657 cross_layer: 4 file: exif.c
if ( length < 0 )  location: 1665 cross_layer: 4 file: exif.c
list = safe_erealloc ( image_info -> info_list [ section_index ] . list , ( image_info -> info_list [ section_index ] . count + 1 ) , sizeof ( image_info_data ) , 0 ); location: 1669 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . list = list; location: 1670 cross_layer: 4 file: exif.c
info_data = & image_info -> info_list [ section_index ] . list [ image_info -> info_list [ section_index ] . count ]; location: 1672 cross_layer: 4 file: exif.c
memset ( info_data , 0 , sizeof ( image_info_data ) ); location: 1673 cross_layer: 4 file: exif.c
info_data -> tag = tag; location: 1674 cross_layer: 4 file: exif.c
info_data -> format = format; location: 1675 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1676 cross_layer: 4 file: exif.c
info_data -> name = estrdup ( name ); location: 1677 cross_layer: 4 file: exif.c
info_value = & info_data -> value; location: 1678 cross_layer: 4 file: exif.c
switch ( format )  location: 1680 cross_layer: 4 file: exif.c
if ( value )  location: 1682 cross_layer: 4 file: exif.c
length = php_strnlen ( value , length ); location: 1683 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1684 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1685 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1687 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1688 cross_layer: 4 file: exif.c
info_data -> tag = TAG_FMT_UNDEFINED; location: 1698 cross_layer: 4 file: exif.c
if ( ! length )  location: 1702 cross_layer: 4 file: exif.c
if ( value )  location: 1705 cross_layer: 4 file: exif.c
if ( tag == TAG_MAKER_NOTE )  location: 1706 cross_layer: 4 file: exif.c
length = ( int ) php_strnlen ( value , length ); location: 1707 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1711 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1712 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1714 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1715 cross_layer: 4 file: exif.c
if ( length == 0 )  location: 1727 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1730 cross_layer: 4 file: exif.c
for (idex=0,vptr=value; idex<(size_t)length; idex++,vptr=(char *) vptr + php_tiff_bytes_per_format[format]) location: 1735 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1736 cross_layer: 4 file: exif.c
info_value = & info_data -> value . list [ idex ]; location: 1737 cross_layer: 4 file: exif.c
switch ( format )  location: 1739 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get16u ( vptr , motorola_intel ); location: 1741 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get32u ( vptr , motorola_intel ); location: 1745 cross_layer: 4 file: exif.c
info_value -> ur . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1749 cross_layer: 4 file: exif.c
info_value -> ur . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1750 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get16s ( vptr , motorola_intel ); location: 1754 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get32s ( vptr , motorola_intel ); location: 1758 cross_layer: 4 file: exif.c
info_value -> sr . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1762 cross_layer: 4 file: exif.c
info_value -> sr . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1763 cross_layer: 4 file: exif.c
info_value -> f = * ( float * ) value; location: 1770 cross_layer: 4 file: exif.c
info_value -> d = * ( double * ) value; location: 1776 cross_layer: 4 file: exif.c
image_info -> sections_found |= 1 << section_index; location: 1781 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . count ++; location: 1782 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 3 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 3 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 3 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 3 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 4 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 4 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 4 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 4 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 4 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 4 file: exif.c
static void exif_thumbnail_extract(image_info_type *ImageInfo, char *offset, size_t length) location: 2522 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . data )  location: 2523 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_mult_thumb" EXIFERR_CC , ImageInfo , E_WARNING , "Multiple possible thumbnails" ) location: 2524 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> read_thumbnail )  location: 2527 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size >= 65536 || ImageInfo -> Thumbnail . size <= 0 || ImageInfo -> Thumbnail . offset <= 0 )  location: 2531 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Illegal thumbnail size/offset" ) location: 2535 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size > length || ( ImageInfo -> Thumbnail . offset + ImageInfo -> Thumbnail . size ) > length || ImageInfo -> Thumbnail . offset > length - ImageInfo -> Thumbnail . size )  location: 2539 cross_layer: 4 file: exif.c
EXIF_ERRLOG_THUMBEOF ( ImageInfo ) location: 2543 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . data = estrndup ( offset + ImageInfo -> Thumbnail . offset , ImageInfo -> Thumbnail . size ); location: 2546 cross_layer: 4 file: exif.c
exif_thumbnail_build ( ImageInfo ); location: 2547 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 3 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 2 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 2 file: exif.c
ImageInfo -> motorola_intel = old_motorola_intel; location: 2812 cross_layer: 1 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( SECTION_MAKERNOTE ) ) location: 2815 cross_layer: 1 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 2 file: exif.c
switch ( section )  location: 1403 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , ( char * ) dir_entry , ( char * ) ( ImageInfo -> file . list [ sn ] . data - dir_offset ) , ifd_size , 0 , section_index , 0 , tag_table ) )  location: 3750 cross_layer: 3 file: exif.c
if ( exif_process_IFD_in_TIFF ( ImageInfo , php_ifd_get32u ( file_header + 4 , ImageInfo -> motorola_intel ) , SECTION_IFD0 ) )  location: 3847 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 5 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 5 file: exif.c
------------------------------
16 @@ testCode/CVE-2019-11034_CWE-125_f3aefc6d071b807ddacae0a0bc49f09c38e18490_exif.c_OLD.c @@ exif_process_IFD_in_MAKERNOTE @@ 2805 @@ ['dir_start', 'value_ptr'] @@ {ImageInfo, value_ptr, maker_note, dir_start}
static int exif_process_IFD_in_MAKERNOTE(image_info_type *ImageInfo, char * value_ptr, int value_len, char *offset_base, size_t IFDlength, size_t displacement) location: 2714 cross_layer: 1 file: exif.c
size_t i ; location: 2716 cross_layer: 1 file: exif.c
int NumDirEntries , old_motorola_intel , offset_diff ; location: 2718 cross_layer: 1 file: exif.c
const maker_note_type * maker_note ; location: 2719 cross_layer: 1 file: exif.c
char * dir_start ; location: 2720 cross_layer: 1 file: exif.c
for (i=0; i<=sizeof(maker_note_array)/sizeof(maker_note_type); i++) location: 2723 cross_layer: 1 file: exif.c
if ( i == sizeof ( maker_note_array ) / sizeof ( maker_note_type ) )  location: 2724 cross_layer: 1 file: exif.c
maker_note = maker_note_array + i; location: 2732 cross_layer: 1 file: exif.c
if ( maker_note -> make && ( ! ImageInfo -> make || strcmp ( maker_note -> make , ImageInfo -> make ) ) )  location: 2735 cross_layer: 1 file: exif.c
if ( maker_note -> model && ( ! ImageInfo -> model || strcmp ( maker_note -> model , ImageInfo -> model ) ) )  location: 2737 cross_layer: 1 file: exif.c
if ( maker_note -> id_string && strncmp ( maker_note -> id_string , value_ptr , maker_note -> id_string_len ) )  location: 2739 cross_layer: 1 file: exif.c
if ( value_len < 2 || maker_note -> offset >= value_len - 1 )  location: 2744 cross_layer: 1 file: exif.c
dir_start = value_ptr + maker_note -> offset; location: 2750 cross_layer: 1 file: exif.c
ImageInfo -> sections_found |= FOUND_MAKERNOTE; location: 2756 cross_layer: 1 file: exif.c
switch ( maker_note -> byte_order )  location: 2759 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 0; location: 2761 cross_layer: 1 file: exif.c
ImageInfo -> motorola_intel = 1; location: 2764 cross_layer: 1 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 2771 cross_layer: 1 file: exif.c
switch ( maker_note -> offset_mode )  location: 2773 cross_layer: 1 file: exif.c
if ( maker_note -> offset + 10 + 4 >= value_len )  location: 2779 cross_layer: 1 file: exif.c
offset_diff = 2 + NumDirEntries * 12 + 4 - php_ifd_get32u ( dir_start + 10 , ImageInfo -> motorola_intel ); location: 2784 cross_layer: 1 file: exif.c
if ( offset_diff < 0 || offset_diff >= value_len )  location: 2788 cross_layer: 1 file: exif.c
if ( ( 2 + NumDirEntries * 12 ) > value_len )  location: 2801 cross_layer: 1 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 2806 cross_layer: 1 file: exif.c    (key_var lines)
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , data_len , displacement , section_index , 0 , maker_note -> tag_table ) )  location: 2807 cross_layer: 1 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 2 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 2 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 2 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 2 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 3 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 3 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
for (i = 0; (t = tag_table[i].Tag) != TAG_END_OF_LIST; i++) location: 999 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 2 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 2 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 2 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 2 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 2 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 2 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 2 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 2 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 2 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 2 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 2 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 2 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 2 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 2 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 2 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 2 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 2 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 2 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 2 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 2 file: exif.c
char * exif_dump_data(int *dump_free, int format, int components, int length, int motorola_intel, char *value_ptr) /* location: 1151 cross_layer: 3 file: exif.c
* dump_free = 0; location: 1156 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_STRING )  location: 1157 cross_layer: 3 file: exif.c
return value_ptr ? value_ptr : "<no data>" ; location: 1158 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_UNDEFINED )  location: 1160 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_IFD )  location: 1163 cross_layer: 3 file: exif.c
if ( format == TAG_FMT_SINGLE || format == TAG_FMT_DOUBLE )  location: 1166 cross_layer: 3 file: exif.c
* dump_free = 1; location: 1169 cross_layer: 3 file: exif.c
if ( components > 1 )  location: 1170 cross_layer: 3 file: exif.c
len = spprintf ( & dump , 0 , "(%d,%d) {" , components , length ); location: 1171 cross_layer: 3 file: exif.c
while ( components > 0 )  location: 1175 cross_layer: 3 file: exif.c
switch ( format )  location: 1176 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 4 + 1 ); location: 1181 cross_layer: 3 file: exif.c
snprintf ( dump + len , 4 + 1 , "0x%02X" , * value_ptr ); location: 1182 cross_layer: 3 file: exif.c
len += 4; location: 1183 cross_layer: 3 file: exif.c
value_ptr ++; location: 1184 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1188 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get16s ( value_ptr , motorola_intel ) ); location: 1189 cross_layer: 3 file: exif.c
static signed short php_ifd_get16s(void *value, int motorola_intel) location: 1086 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1088 cross_layer: 4 file: exif.c
len += 6; location: 1190 cross_layer: 3 file: exif.c
value_ptr += 2; location: 1191 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 6 + 1 ); location: 1195 cross_layer: 3 file: exif.c
snprintf ( dump + len , 6 + 1 , "0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) ); location: 1196 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 6; location: 1197 cross_layer: 3 file: exif.c
value_ptr += 4; location: 1198 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 13 + 1 ); location: 1202 cross_layer: 3 file: exif.c
snprintf ( dump + len , 13 + 1 , "0x%04X/0x%04X" , php_ifd_get32s ( value_ptr , motorola_intel ) , php_ifd_get32s ( value_ptr + 4 , motorola_intel ) ); location: 1203 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
len += 13; location: 1204 cross_layer: 3 file: exif.c
value_ptr += 8; location: 1205 cross_layer: 3 file: exif.c
if ( components > 0 )  location: 1208 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 2 + 1 ); location: 1209 cross_layer: 3 file: exif.c
snprintf ( dump + len , 2 + 1 , ", " ); location: 1210 cross_layer: 3 file: exif.c
len += 2; location: 1211 cross_layer: 3 file: exif.c
components --; location: 1212 cross_layer: 3 file: exif.c
dump = erealloc ( dump , len + 1 + 1 ); location: 1217 cross_layer: 3 file: exif.c
snprintf ( dump + len , 1 + 1 , "}" ); location: 1218 cross_layer: 3 file: exif.c
return dump ; location: 1219 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 2 file: exif.c
static char *exif_get_tagformat(int format) location: 323 cross_layer: 3 file: exif.c
switch ( format )  location: 325 cross_layer: 3 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 2 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 2 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 2 file: exif.c
switch ( tag )  location: 2940 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 2 file: exif.c
switch ( tag )  location: 2977 cross_layer: 2 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 2 file: exif.c
static size_t php_strnlen(char* str, size_t maxlen) location: 277 cross_layer: 3 file: exif.c
if ( str && maxlen && * str )  location: 280 cross_layer: 3 file: exif.c
while ( -- maxlen && * ( ++ str ) )  location: 283 cross_layer: 3 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 2 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 2 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 2 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 2 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 2 file: exif.c
static int exif_process_user_comment(image_info_type *ImageInfo, char **pszInfoPtr, char **pszEncoding, char *szValuePtr, int ByteCount) location: 2605 cross_layer: 3 file: exif.c
* pszEncoding = NULL; location: 2611 cross_layer: 3 file: exif.c
if ( ByteCount >= 8 )  location: 2613 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "UNICODE\0" , 8 ) )  location: 2615 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2616 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2617 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2618 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFE\xFF" , 2 ) )  location: 2622 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2624 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2625 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\xFF\xFE" , 2 ) )  location: 2626 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 2; location: 2628 cross_layer: 3 file: exif.c
ByteCount -= 2; location: 2629 cross_layer: 3 file: exif.c
if ( ImageInfo -> motorola_intel )  location: 2630 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_be; location: 2631 cross_layer: 3 file: exif.c
decode = ImageInfo -> decode_unicode_le; location: 2633 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ); location: 2635 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( decode ); location: 2636 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2638 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2645 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2647 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "ASCII\0\0\0" , 8 ) )  location: 2648 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2649 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2650 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2651 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "JIS\0\0\0\0\0" , 8 ) )  location: 2652 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( ( const char * ) szValuePtr ); location: 2654 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2655 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2656 cross_layer: 3 file: exif.c
to = zend_multibyte_fetch_encoding ( ImageInfo -> encode_jis ); location: 2658 cross_layer: 3 file: exif.c
from = zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_jis_be : ImageInfo -> decode_jis_le ); location: 2659 cross_layer: 3 file: exif.c
if ( ! to || ! from || zend_multibyte_encoding_converter ( ( unsigned char * * ) pszInfoPtr , & len , ( unsigned char * ) szValuePtr , ByteCount , to , from ) == ( size_t ) - 1 )  location: 2660 cross_layer: 3 file: exif.c
len = exif_process_string_raw ( pszInfoPtr , szValuePtr , ByteCount ); location: 2667 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return len ; location: 2669 cross_layer: 3 file: exif.c
if ( ! memcmp ( szValuePtr , "\0\0\0\0\0\0\0\0" , 8 ) )  location: 2670 cross_layer: 3 file: exif.c
* pszEncoding = estrdup ( "UNDEFINED" ); location: 2672 cross_layer: 3 file: exif.c
szValuePtr = szValuePtr + 8; location: 2673 cross_layer: 3 file: exif.c
ByteCount -= 8; location: 2674 cross_layer: 3 file: exif.c
if ( ByteCount > 0 )  location: 2679 cross_layer: 3 file: exif.c
for (a=ByteCount-1;a && szValuePtr[a]==' ';a--) location: 2680 cross_layer: 3 file: exif.c
( szValuePtr ) [ a ] = '\0'; location: 2681 cross_layer: 3 file: exif.c
exif_process_string ( pszInfoPtr , szValuePtr , ByteCount ); location: 2686 cross_layer: 3 file: exif.c
static int exif_process_string(char **result, char *value, size_t byte_count) location: 2587 cross_layer: 4 file: exif.c
if ( ( byte_count = php_strnlen ( value , byte_count ) ) > 0 )  location: 2595 cross_layer: 4 file: exif.c
return exif_process_undefined ( result , value , byte_count ) ; location: 2596 cross_layer: 4 file: exif.c
( * result ) = estrndup ( "" , 1 ); location: 2598 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2599 cross_layer: 4 file: exif.c
return strlen ( * pszInfoPtr ) ; location: 2687 cross_layer: 3 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 2 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 2 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 2 file: exif.c
static int exif_process_unicode(image_info_type *ImageInfo, xp_field_type *xp_field, int tag, char *szValuePtr, int ByteCount) location: 2693 cross_layer: 3 file: exif.c
xp_field -> tag = tag; location: 2695 cross_layer: 3 file: exif.c
xp_field -> value = NULL; location: 2696 cross_layer: 3 file: exif.c
if ( zend_multibyte_encoding_converter ( ( unsigned char * * ) & xp_field -> value , & xp_field -> size , ( unsigned char * ) szValuePtr , ByteCount , zend_multibyte_fetch_encoding ( ImageInfo -> encode_unicode ) , zend_multibyte_fetch_encoding ( ImageInfo -> motorola_intel ? ImageInfo -> decode_unicode_be : ImageInfo -> decode_unicode_le ) ) == ( size_t ) - 1 )  location: 2698 cross_layer: 3 file: exif.c
xp_field -> size = exif_process_string_raw ( & xp_field -> value , szValuePtr , ByteCount ); location: 2706 cross_layer: 3 file: exif.c
static int exif_process_string_raw(char **result, char *value, size_t byte_count) location: 2569 cross_layer: 4 file: exif.c
if ( byte_count )  location: 2574 cross_layer: 4 file: exif.c
( * result ) = safe_emalloc ( byte_count , 1 , 1 ); location: 2575 cross_layer: 4 file: exif.c
memcpy ( * result , value , byte_count ); location: 2576 cross_layer: 4 file: exif.c
( * result ) [ byte_count ] = '\0'; location: 2577 cross_layer: 4 file: exif.c
return byte_count + 1 ; location: 2578 cross_layer: 4 file: exif.c
return xp_field -> size ; location: 2708 cross_layer: 3 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
static int php_ifd_get32s(void *value, int motorola_intel) location: 1094 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1096 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 0 ] << 24 ) | ( ( ( uchar * ) value ) [ 1 ] << 16 ) | ( ( ( uchar * ) value ) [ 2 ] << 8 ) | ( ( ( uchar * ) value ) [ 3 ] ) ; location: 1097 cross_layer: 4 file: exif.c
return ( ( ( char * ) value ) [ 3 ] << 24 ) | ( ( ( uchar * ) value ) [ 2 ] << 16 ) | ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( ( uchar * ) value ) [ 0 ] ) ; location: 1102 cross_layer: 4 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 2 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 2 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 2 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 2 file: exif.c
static size_t exif_convert_any_to_int(void *value, int format, int motorola_intel) location: 1275 cross_layer: 3 file: exif.c
switch ( format )  location: 1280 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1281 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1282 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1284 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1285 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1288 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1289 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1292 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1296 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1297 cross_layer: 3 file: exif.c
return ( size_t ) ( ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ) ; location: 1300 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1303 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1304 cross_layer: 3 file: exif.c
return ( size_t ) * ( float * ) value ; location: 1311 cross_layer: 3 file: exif.c
return ( size_t ) * ( double * ) value ; location: 1316 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 2 file: exif.c
static double exif_convert_any_format(void *value, int format, int motorola_intel) location: 1226 cross_layer: 3 file: exif.c
switch ( format )  location: 1231 cross_layer: 3 file: exif.c
return * ( signed char * ) value ; location: 1232 cross_layer: 3 file: exif.c
return * ( uchar * ) value ; location: 1233 cross_layer: 3 file: exif.c
return php_ifd_get16u ( value , motorola_intel ) ; location: 1235 cross_layer: 3 file: exif.c
return php_ifd_get32u ( value , motorola_intel ) ; location: 1236 cross_layer: 3 file: exif.c
u_den = php_ifd_get32u ( 4 + ( char * ) value , motorola_intel ); location: 1239 cross_layer: 3 file: exif.c
if ( u_den == 0 )  location: 1240 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32u ( value , motorola_intel ) / u_den ; location: 1243 cross_layer: 3 file: exif.c
s_den = php_ifd_get32s ( 4 + ( char * ) value , motorola_intel ); location: 1247 cross_layer: 3 file: exif.c
if ( s_den == 0 )  location: 1248 cross_layer: 3 file: exif.c
return ( double ) php_ifd_get32s ( value , motorola_intel ) / s_den ; location: 1251 cross_layer: 3 file: exif.c
return ( signed short ) php_ifd_get16u ( value , motorola_intel ) ; location: 1254 cross_layer: 3 file: exif.c
return php_ifd_get32s ( value , motorola_intel ) ; location: 1255 cross_layer: 3 file: exif.c
return ( double ) * ( float * ) value ; location: 1262 cross_layer: 3 file: exif.c
return * ( double * ) value ; location: 1267 cross_layer: 3 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 2 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 2 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 2 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 2 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 2 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 2 file: exif.c
switch ( tag )  location: 3100 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 2 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 2 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 2 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 2 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 3 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 3 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 2 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 2 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 3 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 4 file: exif.c
switch ( section )  location: 1403 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 3 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 3 file: exif.c
static int php_ifd_get16u(void *value, int motorola_intel) location: 1074 cross_layer: 4 file: exif.c
if ( motorola_intel )  location: 1076 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1077 cross_layer: 4 file: exif.c
return ( ( ( uchar * ) value ) [ 1 ] << 8 ) | ( ( uchar * ) value ) [ 0 ] ; location: 1079 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 3 file: exif.c
for (de=0;de<NumDirEntries;de++) location: 3169 cross_layer: 3 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 3 file: exif.c
static tag_table_type exif_get_tag_table(int section) location: 1422 cross_layer: 4 file: exif.c
switch ( section )  location: 1424 cross_layer: 4 file: exif.c
static int exif_process_IFD_TAG(image_info_type *ImageInfo, char *dir_entry, char *offset_base, size_t IFDlength, size_t displacement, int section_index, int ReadNextIFD, tag_table_type tag_table) location: 2823 cross_layer: 4 file: exif.c
if ( ImageInfo -> ifd_nesting_level > MAX_IFD_NESTING_LEVEL )  location: 2837 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "corrupt EXIF header: maximum directory nesting level reached" ) location: 2838 cross_layer: 4 file: exif.c
ImageInfo -> ifd_nesting_level ++; location: 2841 cross_layer: 4 file: exif.c
tag = php_ifd_get16u ( dir_entry , ImageInfo -> motorola_intel ); location: 2843 cross_layer: 4 file: exif.c
format = php_ifd_get16u ( dir_entry + 2 , ImageInfo -> motorola_intel ); location: 2844 cross_layer: 4 file: exif.c
components = php_ifd_get32u ( dir_entry + 4 , ImageInfo -> motorola_intel ); location: 2845 cross_layer: 4 file: exif.c
if ( ! format || format > NUM_FORMATS )  location: 2847 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal format code 0x%04X, suppose BYTE" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , format ) location: 2849 cross_layer: 4 file: exif.c
if ( components < 0 )  location: 2854 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal components(%d)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , components ) location: 2855 cross_layer: 4 file: exif.c
byte_count_signed = ( int64_t ) components * php_tiff_bytes_per_format [ format ]; location: 2859 cross_layer: 4 file: exif.c
if ( byte_count_signed < 0 || ( byte_count_signed > INT32_MAX ) )  location: 2861 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal byte_count" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) ) location: 2862 cross_layer: 4 file: exif.c
byte_count = ( size_t ) byte_count_signed; location: 2866 cross_layer: 4 file: exif.c
if ( byte_count > 4 )  location: 2868 cross_layer: 4 file: exif.c
offset_val = php_ifd_get32u ( dir_entry + 8 , ImageInfo -> motorola_intel ); location: 2869 cross_layer: 4 file: exif.c
value_ptr = offset_base + offset_val; location: 2871 cross_layer: 4 file: exif.c
if ( byte_count > IFDlength || offset_val > IFDlength - byte_count || value_ptr < dir_entry || offset_val < ( size_t ) ( dir_entry - offset_base ) )  location: 2877 cross_layer: 4 file: exif.c
if ( byte_count > ImageInfo -> FileSize || offset_val > ImageInfo -> FileSize - byte_count || ( ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_II && ImageInfo -> FileType != IMAGE_FILETYPE_TIFF_MM && ImageInfo -> FileType != IMAGE_FILETYPE_JPEG ) )  location: 2881 cross_layer: 4 file: exif.c
if ( value_ptr < dir_entry )  location: 2882 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X < x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , dir_entry ) location: 2885 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Process tag(x%04X=%s): Illegal pointer offset(x%04X + x%04X = x%04X > x%04X)" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val , byte_count , offset_val + byte_count , IFDlength ) location: 2889 cross_layer: 4 file: exif.c
if ( byte_count > sizeof ( cbuf ) )  location: 2893 cross_layer: 4 file: exif.c
value_ptr = safe_emalloc ( byte_count , 1 , 0 ); location: 2895 cross_layer: 4 file: exif.c
outside = value_ptr; location: 2896 cross_layer: 4 file: exif.c
fpos = php_stream_tell ( ImageInfo -> infile ); location: 2907 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , displacement + offset_val , SEEK_SET ); location: 2908 cross_layer: 4 file: exif.c
fgot = php_stream_tell ( ImageInfo -> infile ); location: 2909 cross_layer: 4 file: exif.c
if ( fgot != displacement + offset_val )  location: 2910 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2911 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Wrong file pointer: 0x%08X != 0x%08X" , fgot , displacement + offset_val ) location: 2912 cross_layer: 4 file: exif.c
fgot = php_stream_read ( ImageInfo -> infile , value_ptr , byte_count ); location: 2915 cross_layer: 4 file: exif.c
php_stream_seek ( ImageInfo -> infile , fpos , SEEK_SET ); location: 2916 cross_layer: 4 file: exif.c
if ( fgot < byte_count )  location: 2917 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 2918 cross_layer: 4 file: exif.c
EXIF_ERRLOG_FILEEOF ( ImageInfo ) location: 2919 cross_layer: 4 file: exif.c
value_ptr = dir_entry + 8; location: 2925 cross_layer: 4 file: exif.c
offset_val = value_ptr - offset_base; location: 2926 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_ANY_TAG; location: 2929 cross_layer: 4 file: exif.c
dump_data = exif_dump_data ( & dump_free , format , components , length , ImageInfo -> motorola_intel , value_ptr ); location: 2931 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process tag(x%04X=%s,@x%04X + x%04X(=%d)): %s%s %s" , tag , exif_get_tagname ( tag , tagname , - 12 , tag_table ) , offset_val + displacement , byte_count , byte_count , ( components > 1 ) && format != TAG_FMT_UNDEFINED && format != TAG_FMT_STRING ? "ARRAY OF " : "" , exif_get_tagformat ( format ) , dump_data ) location: 2932 cross_layer: 4 file: exif.c
efree ( dump_data ); location: 2934 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 2938 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> Thumbnail . data )  location: 2939 cross_layer: 4 file: exif.c
switch ( tag )  location: 2940 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . width = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2943 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . height = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2948 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . offset = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2954 cross_layer: 4 file: exif.c
if ( ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_II || ImageInfo -> FileType == IMAGE_FILETYPE_TIFF_MM )  location: 2958 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = ImageInfo -> FileType; location: 2959 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_TIFF_MM; location: 2962 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2964 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype == IMAGE_FILETYPE_UNKNOWN )  location: 2968 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . filetype = IMAGE_FILETYPE_JPEG; location: 2969 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . size = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 2970 cross_layer: 4 file: exif.c
if ( section_index == SECTION_IFD0 || section_index == SECTION_EXIF )  location: 2976 cross_layer: 4 file: exif.c
switch ( tag )  location: 2977 cross_layer: 4 file: exif.c
if ( byte_count > 1 && ( length = php_strnlen ( value_ptr , byte_count ) ) > 0 )  location: 2980 cross_layer: 4 file: exif.c
if ( length < byte_count - 1 )  location: 2981 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightPhotographer = estrdup ( value_ptr ); location: 2983 cross_layer: 4 file: exif.c
ImageInfo -> CopyrightEditor = estrndup ( value_ptr + length + 1 , byte_count - length - 1 ); location: 2984 cross_layer: 4 file: exif.c
spprintf ( & ImageInfo -> Copyright , 0 , "%s, %s" , ImageInfo -> CopyrightPhotographer , ImageInfo -> CopyrightEditor ); location: 2985 cross_layer: 4 file: exif.c
ImageInfo -> Copyright = estrndup ( value_ptr , byte_count ); location: 2990 cross_layer: 4 file: exif.c
ImageInfo -> UserCommentLength = exif_process_user_comment ( ImageInfo , & ( ImageInfo -> UserComment ) , & ( ImageInfo -> UserCommentEncoding ) , value_ptr , byte_count ); location: 2996 cross_layer: 4 file: exif.c
tmp_xp = ( xp_field_type * ) safe_erealloc ( ImageInfo -> xp_fields . list , ( ImageInfo -> xp_fields . count + 1 ) , sizeof ( xp_field_type ) , 0 ); location: 3004 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_WINXP; location: 3005 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . list = tmp_xp; location: 3006 cross_layer: 4 file: exif.c
ImageInfo -> xp_fields . count ++; location: 3007 cross_layer: 4 file: exif.c
exif_process_unicode ( ImageInfo , & ( ImageInfo -> xp_fields . list [ ImageInfo -> xp_fields . count - 1 ] ) , tag , value_ptr , byte_count ); location: 3008 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3014 cross_layer: 4 file: exif.c
if ( ImageInfo -> ApertureFNumber == 0 )  location: 3021 cross_layer: 4 file: exif.c
ImageInfo -> ApertureFNumber = ( float ) exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) * 0.5 ); location: 3022 cross_layer: 4 file: exif.c
if ( ImageInfo -> ExposureTime == 0 )  location: 3032 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = ( float ) ( 1 / exp ( exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) * log ( 2 ) ) ); location: 3033 cross_layer: 4 file: exif.c
ImageInfo -> ExposureTime = - 1; location: 3038 cross_layer: 4 file: exif.c
ImageInfo -> ExifImageWidth = exif_convert_any_to_int ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3042 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneXRes = exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3046 cross_layer: 4 file: exif.c
ImageInfo -> Distance = ( float ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ); location: 3052 cross_layer: 4 file: exif.c
switch ( ( int ) exif_convert_any_format ( value_ptr , format , ImageInfo -> motorola_intel ) )  location: 3056 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3057 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 25.4; location: 3062 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 10; location: 3065 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = 1; location: 3066 cross_layer: 4 file: exif.c
ImageInfo -> FocalplaneUnits = .001; location: 3067 cross_layer: 4 file: exif.c
if ( format == TAG_FMT_IFD )  location: 3072 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Skip SUB IFD" ) location: 3076 cross_layer: 4 file: exif.c
ImageInfo -> make = estrndup ( value_ptr , byte_count ); location: 3081 cross_layer: 4 file: exif.c
ImageInfo -> model = estrndup ( value_ptr , byte_count ); location: 3084 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3089 cross_layer: 4 file: exif.c
if ( ReadNextIFD )  location: 3097 cross_layer: 4 file: exif.c
switch ( tag )  location: 3100 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found EXIF" ) location: 3103 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_EXIF; location: 3105 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found GPS" ) location: 3110 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_GPS; location: 3112 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Found INTEROPERABILITY" ) location: 3117 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_INTEROP; location: 3119 cross_layer: 4 file: exif.c
Subdir_start = offset_base + php_ifd_get32u ( value_ptr , ImageInfo -> motorola_intel ); location: 3123 cross_layer: 4 file: exif.c
if ( Subdir_start < offset_base || Subdir_start > offset_base + IFDlength )  location: 3124 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD Pointer" ) location: 3125 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_in_JPEG ( ImageInfo , Subdir_start , offset_base , IFDlength , displacement , sub_section_index ) )  location: 3128 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 4 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 3 file: exif.c
switch ( section )  location: 1403 cross_layer: 3 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 4 file: exif.c
static char * exif_get_tagname(int tag_num, char *ret, int len, tag_table_type tag_table) location: 994 cross_layer: 3 file: exif.c
if ( t == tag_num )  location: 1000 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1001 cross_layer: 3 file: exif.c
strlcpy ( ret , tag_table [ i ] . Desc , abs ( len ) ); location: 1002 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1003 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1004 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1005 cross_layer: 3 file: exif.c
return ret ; location: 1007 cross_layer: 3 file: exif.c
return tag_table [ i ] . Desc ; location: 1009 cross_layer: 3 file: exif.c
if ( ret && len )  location: 1013 cross_layer: 3 file: exif.c
snprintf ( tmp , sizeof ( tmp ) , "UndefinedTag:0x%04X" , tag_num ); location: 1014 cross_layer: 3 file: exif.c
strlcpy ( ret , tmp , abs ( len ) ); location: 1015 cross_layer: 3 file: exif.c
if ( len < 0 )  location: 1016 cross_layer: 3 file: exif.c
memset ( ret + strlen ( ret ) , ' ' , - len - strlen ( ret ) - 1 ); location: 1017 cross_layer: 3 file: exif.c
ret [ - len - 1 ] = '\0'; location: 1018 cross_layer: 3 file: exif.c
return ret ; location: 1020 cross_layer: 3 file: exif.c
static void exif_iif_add_tag(image_info_type *image_info, int section_index, char *name, int tag, int format, size_t length, void* value) location: 1789 cross_layer: 3 file: exif.c
exif_iif_add_value ( image_info , section_index , name , tag , format , ( int ) length , value , image_info -> motorola_intel ); location: 1791 cross_layer: 3 file: exif.c
static void exif_iif_add_value(image_info_type *image_info, int section_index, char *name, int tag, int format, int length, void* value, int motorola_intel) location: 1657 cross_layer: 4 file: exif.c
if ( length < 0 )  location: 1665 cross_layer: 4 file: exif.c
list = safe_erealloc ( image_info -> info_list [ section_index ] . list , ( image_info -> info_list [ section_index ] . count + 1 ) , sizeof ( image_info_data ) , 0 ); location: 1669 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . list = list; location: 1670 cross_layer: 4 file: exif.c
info_data = & image_info -> info_list [ section_index ] . list [ image_info -> info_list [ section_index ] . count ]; location: 1672 cross_layer: 4 file: exif.c
memset ( info_data , 0 , sizeof ( image_info_data ) ); location: 1673 cross_layer: 4 file: exif.c
info_data -> tag = tag; location: 1674 cross_layer: 4 file: exif.c
info_data -> format = format; location: 1675 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1676 cross_layer: 4 file: exif.c
info_data -> name = estrdup ( name ); location: 1677 cross_layer: 4 file: exif.c
info_value = & info_data -> value; location: 1678 cross_layer: 4 file: exif.c
switch ( format )  location: 1680 cross_layer: 4 file: exif.c
if ( value )  location: 1682 cross_layer: 4 file: exif.c
length = php_strnlen ( value , length ); location: 1683 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1684 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1685 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1687 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1688 cross_layer: 4 file: exif.c
info_data -> tag = TAG_FMT_UNDEFINED; location: 1698 cross_layer: 4 file: exif.c
if ( ! length )  location: 1702 cross_layer: 4 file: exif.c
if ( value )  location: 1705 cross_layer: 4 file: exif.c
if ( tag == TAG_MAKER_NOTE )  location: 1706 cross_layer: 4 file: exif.c
length = ( int ) php_strnlen ( value , length ); location: 1707 cross_layer: 4 file: exif.c
info_value -> s = estrndup ( value , length ); location: 1711 cross_layer: 4 file: exif.c
info_data -> length = length; location: 1712 cross_layer: 4 file: exif.c
info_data -> length = 0; location: 1714 cross_layer: 4 file: exif.c
info_value -> s = estrdup ( "" ); location: 1715 cross_layer: 4 file: exif.c
if ( length == 0 )  location: 1727 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1730 cross_layer: 4 file: exif.c
for (idex=0,vptr=value; idex<(size_t)length; idex++,vptr=(char *) vptr + php_tiff_bytes_per_format[format]) location: 1735 cross_layer: 4 file: exif.c
if ( length > 1 )  location: 1736 cross_layer: 4 file: exif.c
info_value = & info_data -> value . list [ idex ]; location: 1737 cross_layer: 4 file: exif.c
switch ( format )  location: 1739 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get16u ( vptr , motorola_intel ); location: 1741 cross_layer: 4 file: exif.c
info_value -> u = php_ifd_get32u ( vptr , motorola_intel ); location: 1745 cross_layer: 4 file: exif.c
info_value -> ur . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1749 cross_layer: 4 file: exif.c
info_value -> ur . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1750 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get16s ( vptr , motorola_intel ); location: 1754 cross_layer: 4 file: exif.c
info_value -> i = php_ifd_get32s ( vptr , motorola_intel ); location: 1758 cross_layer: 4 file: exif.c
info_value -> sr . num = php_ifd_get32u ( vptr , motorola_intel ); location: 1762 cross_layer: 4 file: exif.c
info_value -> sr . den = php_ifd_get32u ( 4 + ( char * ) vptr , motorola_intel ); location: 1763 cross_layer: 4 file: exif.c
info_value -> f = * ( float * ) value; location: 1770 cross_layer: 4 file: exif.c
info_value -> d = * ( double * ) value; location: 1776 cross_layer: 4 file: exif.c
image_info -> sections_found |= 1 << section_index; location: 1781 cross_layer: 4 file: exif.c
image_info -> info_list [ section_index ] . count ++; location: 1782 cross_layer: 4 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 3 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 3 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 3 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 4 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 3 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 3 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 3 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 3 file: exif.c
static int exif_process_IFD_in_JPEG(image_info_type *ImageInfo, char *dir_start, char *offset_base, size_t IFDlength, size_t displacement, int section_index) location: 3145 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Process %s (x%04X(=%d))" , exif_get_sectionname ( section_index ) , IFDlength , IFDlength ) location: 3152 cross_layer: 4 file: exif.c
ImageInfo -> sections_found |= FOUND_IFD0; location: 3155 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 ) >= ( offset_base + IFDlength ) )  location: 3157 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3158 cross_layer: 4 file: exif.c
NumDirEntries = php_ifd_get16u ( dir_start , ImageInfo -> motorola_intel ); location: 3162 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + NumDirEntries * 12 ) > ( offset_base + IFDlength ) )  location: 3164 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size: x%04X + 2 + x%04X*12 = x%04X > x%04X" , ( int ) ( ( size_t ) dir_start + 2 - ( size_t ) offset_base ) , NumDirEntries , ( int ) ( ( size_t ) dir_start + 2 + NumDirEntries * 12 - ( size_t ) offset_base ) , IFDlength ) location: 3165 cross_layer: 4 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , dir_start + 2 + 12 * de , offset_base , IFDlength , displacement , section_index , 1 , exif_get_tag_table ( section_index ) ) )  location: 3170 cross_layer: 4 file: exif.c
if ( section_index == SECTION_THUMBNAIL )  location: 3178 cross_layer: 4 file: exif.c
if ( ( dir_start + 2 + 12 * de + 4 ) >= ( offset_base + IFDlength ) )  location: 3185 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD size" ) location: 3186 cross_layer: 4 file: exif.c
NextDirOffset = php_ifd_get32u ( dir_start + 2 + 12 * de , ImageInfo -> motorola_intel ); location: 3189 cross_layer: 4 file: exif.c
if ( NextDirOffset )  location: 3190 cross_layer: 4 file: exif.c
if ( offset_base + NextDirOffset < offset_base || offset_base + NextDirOffset > offset_base + IFDlength )  location: 3192 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_ifd" EXIFERR_CC , ImageInfo , E_WARNING , "Illegal IFD offset" ) location: 3193 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Expect next IFD to be thumbnail" ) location: 3198 cross_layer: 4 file: exif.c
if ( exif_process_IFD_in_JPEG ( ImageInfo , offset_base + NextDirOffset , offset_base , IFDlength , displacement , SECTION_THUMBNAIL ) )  location: 3200 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 4 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 4 file: exif.c
static void exif_thumbnail_extract(image_info_type *ImageInfo, char *offset, size_t length) location: 2522 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . data )  location: 2523 cross_layer: 4 file: exif.c
exif_error_docref ( "exif_read_data#error_mult_thumb" EXIFERR_CC , ImageInfo , E_WARNING , "Multiple possible thumbnails" ) location: 2524 cross_layer: 4 file: exif.c
if ( ! ImageInfo -> read_thumbnail )  location: 2527 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size >= 65536 || ImageInfo -> Thumbnail . size <= 0 || ImageInfo -> Thumbnail . offset <= 0 )  location: 2531 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Illegal thumbnail size/offset" ) location: 2535 cross_layer: 4 file: exif.c
if ( ImageInfo -> Thumbnail . size > length || ( ImageInfo -> Thumbnail . offset + ImageInfo -> Thumbnail . size ) > length || ImageInfo -> Thumbnail . offset > length - ImageInfo -> Thumbnail . size )  location: 2539 cross_layer: 4 file: exif.c
EXIF_ERRLOG_THUMBEOF ( ImageInfo ) location: 2543 cross_layer: 4 file: exif.c
ImageInfo -> Thumbnail . data = estrndup ( offset + ImageInfo -> Thumbnail . offset , ImageInfo -> Thumbnail . size ); location: 2546 cross_layer: 4 file: exif.c
exif_thumbnail_build ( ImageInfo ); location: 2547 cross_layer: 4 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail size: 0x%04X" , ImageInfo -> Thumbnail . size ) location: 3202 cross_layer: 3 file: exif.c
if ( ImageInfo -> Thumbnail . filetype != IMAGE_FILETYPE_UNKNOWN && ImageInfo -> Thumbnail . size && ImageInfo -> Thumbnail . offset && ImageInfo -> read_thumbnail )  location: 3204 cross_layer: 3 file: exif.c
exif_thumbnail_extract ( ImageInfo , offset_base , IFDlength ); location: 3209 cross_layer: 3 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( sub_section_index ) ) location: 3132 cross_layer: 2 file: exif.c
exif_iif_add_tag ( ImageInfo , section_index , exif_get_tagname ( tag , tagname , sizeof ( tagname ) , tag_table ) , tag , format , components , value_ptr ); location: 3137 cross_layer: 2 file: exif.c
EFREE_IF ( outside ); location: 3138 cross_layer: 2 file: exif.c
ImageInfo -> motorola_intel = old_motorola_intel; location: 2812 cross_layer: 1 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Subsection %s done" , exif_get_sectionname ( SECTION_MAKERNOTE ) ) location: 2815 cross_layer: 1 file: exif.c
static char *exif_get_sectionname(int section) location: 1401 cross_layer: 2 file: exif.c
switch ( section )  location: 1403 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_in_MAKERNOTE ( ImageInfo , value_ptr , byte_count , offset_base , IFDlength , displacement ) )  location: 3088 cross_layer: 2 file: exif.c
if ( ! exif_process_IFD_TAG ( ImageInfo , ( char * ) dir_entry , ( char * ) ( ImageInfo -> file . list [ sn ] . data - dir_offset ) , ifd_size , 0 , section_index , 0 , tag_table ) )  location: 3750 cross_layer: 3 file: exif.c
if ( exif_process_IFD_in_TIFF ( ImageInfo , php_ifd_get32u ( file_header + 4 , ImageInfo -> motorola_intel ) , SECTION_IFD0 ) )  location: 3833 cross_layer: 4 file: exif.c
static unsigned php_ifd_get32u(void *value, int motorola_intel) location: 1112 cross_layer: 5 file: exif.c
return ( unsigned ) php_ifd_get32s ( value , motorola_intel ) & 0xffffffff ; location: 1114 cross_layer: 5 file: exif.c
------------------------------
