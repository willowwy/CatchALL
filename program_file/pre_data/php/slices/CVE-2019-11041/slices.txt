1 @@ testCode/CVE-2019-11041_CWE-125_f22101c8308669bb63c03a73a2cac2408d844f38_exif.c_OLD.c @@ exif_scan_thumbnail @@ 3895 @@ ['ImageInfo->Thumbnail.size'] @@ {ImageInfo, data}
static int exif_scan_thumbnail(image_info_type *ImageInfo) location: 3888 cross_layer: 1 file: exif.c
uchar c , * data = ( uchar * ) ImageInfo -> Thumbnail . data ; location: 3890 cross_layer: 1 file: exif.c
if ( ! data || ImageInfo -> Thumbnail . size < 4 )  location: 3895 cross_layer: 1 file: exif.c    (key_var lines)
if ( memcmp ( data , "\xFF\xD8\xFF" , 3 ) )  location: 3898 cross_layer: 1 file: exif.c
if ( ! ImageInfo -> Thumbnail . width && ! ImageInfo -> Thumbnail . height )  location: 3899 cross_layer: 1 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Thumbnail is not a JPEG image" ) location: 3900 cross_layer: 1 file: exif.c
if ( pos >= ImageInfo -> Thumbnail . size )  location: 3906 cross_layer: 1 file: exif.c
c = data [ pos ++ ]; location: 3908 cross_layer: 1 file: exif.c
if ( pos >= ImageInfo -> Thumbnail . size )  location: 3909 cross_layer: 1 file: exif.c
if ( c != 0xFF )  location: 3911 cross_layer: 1 file: exif.c
while ( ( c = data [ pos ++ ] ) == 0xFF && n -- )  location: 3915 cross_layer: 1 file: exif.c
if ( pos + 3 >= ImageInfo -> Thumbnail . size )  location: 3916 cross_layer: 1 file: exif.c
if ( c == 0xFF )  location: 3920 cross_layer: 1 file: exif.c
marker = c; location: 3922 cross_layer: 1 file: exif.c
if ( pos >= ImageInfo -> Thumbnail . size )  location: 3923 cross_layer: 1 file: exif.c
length = php_jpg_get16 ( data + pos ); location: 3925 cross_layer: 1 file: exif.c
static int php_jpg_get16(void *value) location: 1435 cross_layer: 2 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1437 cross_layer: 2 file: exif.c
if ( length > ImageInfo -> Thumbnail . size || pos >= ImageInfo -> Thumbnail . size - length )  location: 3926 cross_layer: 1 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail: process section(x%02X=%s) @ x%04X + x%04X" , marker , exif_get_markername ( marker ) , pos , length ) location: 3930 cross_layer: 1 file: exif.c
static char * exif_get_markername(int marker) location: 2676 cross_layer: 2 file: exif.c
switch ( marker )  location: 2678 cross_layer: 2 file: exif.c
switch ( marker )  location: 3932 cross_layer: 1 file: exif.c
if ( length < 8 || ImageInfo -> Thumbnail . size - 8 < pos )  location: 3947 cross_layer: 1 file: exif.c
exif_process_SOFn ( data + pos , marker , & sof_info ); location: 3951 cross_layer: 1 file: exif.c
static void exif_process_SOFn (uchar *Data, int marker, jpeg_sof_info *result) location: 2642 cross_layer: 2 file: exif.c
result -> bits_per_sample = Data [ 2 ]; location: 2645 cross_layer: 2 file: exif.c
result -> height = php_jpg_get16 ( Data + 3 ); location: 2646 cross_layer: 2 file: exif.c
static int php_jpg_get16(void *value) location: 1435 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1437 cross_layer: 3 file: exif.c
result -> width = php_jpg_get16 ( Data + 5 ); location: 2647 cross_layer: 2 file: exif.c
static int php_jpg_get16(void *value) location: 1435 cross_layer: 3 file: exif.c
return ( ( ( uchar * ) value ) [ 0 ] << 8 ) | ( ( uchar * ) value ) [ 1 ] ; location: 1437 cross_layer: 3 file: exif.c
result -> num_components = Data [ 7 ]; location: 2648 cross_layer: 2 file: exif.c
ImageInfo -> Thumbnail . height = sof_info . height; location: 3952 cross_layer: 1 file: exif.c
ImageInfo -> Thumbnail . width = sof_info . width; location: 3953 cross_layer: 1 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_NOTICE , "Thumbnail: size: %d * %d" , sof_info . width , sof_info . height ) location: 3955 cross_layer: 1 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Could not compute size of thumbnail" ) location: 3961 cross_layer: 1 file: exif.c
exif_error_docref ( NULL EXIFERR_CC , ImageInfo , E_WARNING , "Could not compute size of thumbnail" ) location: 3971 cross_layer: 1 file: exif.c
------------------------------
