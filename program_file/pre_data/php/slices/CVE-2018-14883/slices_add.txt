1 @@ testCode/CVE-2018-14883_CWE-125_1baeae42703f9b2ec21fff787146eeca08d45535_exif.c_NEW.c @@ exif_thumbnail_extract @@ 2548 @@ ['ImageInfo->Thumbnail.size', 'ImageInfo->Thumbnail.offset'] @@ {ImageInfo}
static void exif_thumbnail_extract(image_info_type *ImageInfo, char *offset, size_t length TSRMLS_DC) location: 2531 cross_layer: 1 file: exif.c
if ( ImageInfo -> Thumbnail . data )  location: 2532 cross_layer: 1 file: exif.c
if ( ! ImageInfo -> read_thumbnail )  location: 2536 cross_layer: 1 file: exif.c
if ( ImageInfo -> Thumbnail . size >= 65536 || ImageInfo -> Thumbnail . size <= 0 || ImageInfo -> Thumbnail . offset <= 0 )  location: 2540 cross_layer: 1 file: exif.c
if ( ImageInfo -> Thumbnail . size > length || ( ImageInfo -> Thumbnail . offset + ImageInfo -> Thumbnail . size ) > length || ImageInfo -> Thumbnail . offset > length - ImageInfo -> Thumbnail . size )  location: 2548 cross_layer: 1 file: exif.c
EXIF_ERRLOG_THUMBEOF ( ImageInfo ) location: 2552 cross_layer: 1 file: exif.c
ImageInfo -> Thumbnail . data = estrndup ( offset + ImageInfo -> Thumbnail . offset , ImageInfo -> Thumbnail . size ); location: 2555 cross_layer: 1 file: exif.c
exif_thumbnail_build ( ImageInfo TSRMLS_CC ) location: 2556 cross_layer: 1 file: exif.c
------------------------------
